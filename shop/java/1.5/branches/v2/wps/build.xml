<?xml version="1.0" ?>
<project default="createwar" basedir=".">
	
	
  <property name="projet.src.dir" value="src"/>
  <property name="projet.work.dir" value="work"/>
  <property name="projet.out.dir" value="out"/>
  <property name="projet.lib.dir" value="WebContent\\WEB-INF\\lib"/>
  <property name="projet.web.dir" value="WebContent\\WEB-INF"/>
  <property name="projet.tomcat.lib.dir" value="C:\tomcat6\lib"/>
  
   <path id="projet.classpath">
	    <fileset dir="${projet.lib.dir}">
	      <include name="*.jar"/>
	    </fileset>
    	<fileset dir="${projet.tomcat.lib.dir}">
	      <include name="*.jar"/>
	    </fileset>
   </path>

  <target name="createwar" depends="create-structure,copy-resources,compilation,compression,deleteResources,war" description="Main target">
    
  </target>

  <target name="create-structure">    
  	<echo>Creating the working directory structure</echo>
  	<mkdir dir="${projet.out.dir}" />
  	<mkdir dir="${projet.work.dir}" />
  	<mkdir dir="${projet.work.dir}/WEB-INF" />
  	<mkdir dir="${projet.work.dir}/WEB-INF/classes" />
  	<mkdir dir="${projet.work.dir}/WEB-INF/lib" />
  </target>  
	
	<target name="compression" description="Compression" >
	    <jar jarfile="${projet.work.dir}/WEB-INF/lib/wps.jar" basedir="${projet.work.dir}/WEB-INF/classes"  />			
	</target>

	
  <target name="copy-resources">    
		<echo>Copy the resources into the working directory</echo>
  		
  		<copy todir="${projet.work.dir}/WEB-INF" >
  	      <fileset dir="${projet.web.dir}" >
  	        <include name="**"/>
  	      </fileset>
  	    </copy>
  		
  		<copy todir="${projet.work.dir}/WEB-INF/classes" >
  	  	  	      <fileset dir="${projet.src.dir}" >
  	  	  	        <include name="**/*.xml"/>  	  	        
  	  	  	      </fileset>
  	  	</copy>
  	
  </target>
	
  <target name="compilation" description="Compilation" >  	
    <javac debug="on" srcdir="${projet.src.dir}" destdir="${projet.work.dir}/WEB-INF/classes" >
    	<classpath refid="projet.classpath"/>
    </javac>
  	
  </target>
  
	<target name="deleteResources" description="generate the war" >
		
	<delete includeEmptyDirs="true">			
					      <fileset dir="${projet.work.dir}/WEB-INF/classes" />
					</delete>
	</target>
	<target name="war" description="generate the war" >
		<tstamp/>
		<echo>Building the war file</echo>
			
	    <war warfile="${projet.out.dir}/wps.${DSTAMP}.${TSTAMP}.war" basedir="${projet.work.dir}" />
	</target>
	
	
		
	
	
</project>