<?xml version="1.0" ?>

<project default="com_easysdi_monitor" basedir=".">
	<property name="projet.out.dir" value="out" />
	<property name="projet.src.dir" value="views/main/js" />
	<property name="projet.lib.dir" value="lib" />
	<taskdef name="jscomp" classname="com.google.javascript.jscomp.ant.CompileTask"
           classpath="js_minifier/compiler.jar"/>
	<target name="com_easysdi_monitor" depends="create-structure,minify,compression"
		description="Main target" />
	<target name="create-structure">
		<echo>Creating the working directory structure</echo>
		<delete>
			<fileset dir="${projet.out.dir}" includes="*" />
		</delete>
		<mkdir dir="${projet.out.dir}" />
	</target>
	<target name="minify" description="Compression">
		
		<concat destfile="script/Monitor.js">
		<filelist dir="views/main/js">
			<file name="exportType.js"/>
			<file name="language.js"/>
			<file name="vtypes.js"/>
			<file name="app/App.js"/>
			<file name="definitions.js"/>
			<file name="jobManager.js"/>
			<file name="jobRequest.js"/>
			<file name="jobAlert.js"/>
			<file name="sla.js" />
			<file name="reports.js"/>
			<file name="alerts.js"/>
			<file name="responseoverview.js" />
			<file name="state.js"/>
			<file name="maintenance.js"/>
			<file name="monitor.js"/>
			<file name="graphs/healthGraphRaw.js"/>
			<file name="graphs/healthGraphAgg.js"/>
			<file name="graphs/healthLineGraph.js"/>
			<file name="graphs/responseTimeGraph.js"/>			
		</filelist>
		</concat>


		<echo>Checking code syntax and minifying.</echo>
		<!--<jscomp compilationLevel="whitespace" warning="verbose" 
            debug="true" output="script/Monitor.js">
      <sources dir="views/main/js">
        <file name="language.js"/>
        <file name="vtypes.js"/>
        <file name="app/App.js"/>
        <file name="definitions.js"/>
        <file name="jobManager.js"/>
        <file name="jobRequest.js"/>
        <file name="jobAlert.js"/>
        <file name="reports.js"/>
        <file name="alerts.js"/>
		<file name="responseoverview.js" />
		<file name="sla.js" />
        <file name="state.js"/>
        <file name="maintenance.js"/>
        <file name="monitor.js"/>
        <file name="graphs/healthGraphRaw.js"/>
        <file name="graphs/healthGraphAgg.js"/>
        <file name="graphs/healthLineGraph.js"/>
        <file name="graphs/responseTimeGraph.js"/>
      </sources>
    </jscomp>-->
	</target>
	<target name="compression" description="Compression">
		<jar compress="true" jarfile="${projet.out.dir}/com_easysdi_monitor.zip"
			basedir="."
			excludes="out/** ; .cache/** ; .svn/** ; .settings/** ; *.project; .prefs" />
	</target>
</project>