<?xml version="1.0" ?>

<project default="easysdi" basedir="../../">
    
    <!-- Global export path -->
    <property name="root.dir" value="ant" />
    <property name="root.out.dir" value="ant/easysdi" />
    <property name="parent.component.name" value="easysdi"/>
    <property name="parent.src.out.dir" value="${root.dir}/${parent.component.name}/src"/>
    <property name="parent.package.out.dir" value="${root.dir}/${parent.component.name}/target"/>
    <property name="version" value="3.1.3-stable"/>
    
    <!-- Joomla component path -->
    <property name="joomla.administrator.components.dir" value="administrator/components" />
    <property name="joomla.administrator.language.dir" value="administrator/language" />
    <property name="joomla.site.components.dir" value="components" />
    <property name="joomla.site.language.dir" value="language" />
    
    <property name="joomla.plugin.path" value="plugins"/>
    
    <!-- Import common ant script -->
    <import file="common/build-common-target.xml" as="common"/>
    <import file="common/build-plg-common-target.xml" as="plg-common"/>
    
    <!-- Import sub ant scripts -->
    <import file="com_easysdi_core/build.xml" as="core"/>
    <import file="com_easysdi_map/build.xml" as="map"/>
    <import file="com_easysdi_monitor/build.xml" as="monitor"/>
    <import file="com_easysdi_service/build.xml" as="service"/>
    <import file="com_easysdi_contact/build.xml" as="user"/>
    <import file="plg_easysdi_monitor/build.xml" as="plg-monitor"/>
    <import file="plg_easysdi_contact/build.xml" as="plg-user"/>
    
    <target name="package-all" depends="core.package-core,map.package-map,monitor.package-monitor,plg-monitor.package-plg-monitor,service.package-service,user.package-user,plg-user.package-plg-user,copy-sub-package,package" description="Main target"/>
    
    
    <!-- Copy sub package in main package --> 
    <target name="copy-sub-package">
        <echo>Copy sub package</echo>
        <mkdir dir="${parent.src.out.dir}/easysdi" />
        <delete>
            <fileset dir="${parent.src.out.dir}/easysdi" includes="*"/>
        </delete>
        <copy todir="${parent.src.out.dir}/easysdi">
            <fileset dir="${root.out.dir}/com_easysdi_core/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/com_easysdi_map/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/com_easysdi_monitor/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/com_easysdi_service/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/com_easysdi_user/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/plg_easysdi_monitor/target" includes="*" erroronmissingdir="false"/>
            <fileset dir="${root.out.dir}/plg_easysdi_user/target" includes="*" erroronmissingdir="false"/>
        </copy>
    </target>
    
    <!-- Compress the complete package. --> 
    <target name="package">
        <echo>Zip full package</echo>
        <mkdir dir="${parent.package.out.dir}"/>
        <delete>
            <fileset dir="${parent.package.out.dir}" includes="*"/>
        </delete>
        <jar destfile="${parent.package.out.dir}/easysdi-${version}-full.zip">
            <fileset dir="${parent.src.out.dir}"/>
        </jar>
    </target>
    
</project>