!function(e){function t(e,t){if(!t||"function"==typeof t)return e;for(var n in t)e[n]=t[n];return e}function n(e,t){for(var r in t)r in e?n(e[r],t[r]):e[r]=t[r];return e}function r(e,t,n){var r,a=0,o=e.length,i=void 0===o||"[object Array]"!==Object.prototype.toString.apply(e)||"function"==typeof e;if(n)if(i){for(r in e)if(t.apply(e[r],n)===!1)break}else for(;o>a&&t.apply(e[a++],n)!==!1;);else if(i){for(r in e)if(t.call(e[r],r,e[r])===!1)break}else for(;o>a&&t.call(e[a],a,e[a++])!==!1;);return e}function a(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,function(e){return V[e]}):e}function o(e){var t=function(e){if(window.XMLHttpRequest)return e(null,new XMLHttpRequest);if(window.ActiveXObject)try{return e(null,new ActiveXObject("Msxml2.XMLHTTP"))}catch(t){return e(null,new ActiveXObject("Microsoft.XMLHTTP"))}return e(new Error)},n=function(e){if("string"==typeof e)return e;var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},r=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},a=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e=r(e);var n,a,o,i,s,l,u,c="",d=0;do n=e.charCodeAt(d++),a=e.charCodeAt(d++),o=e.charCodeAt(d++),i=n>>2,s=(3&n)<<4|a>>4,l=(15&a)<<2|o>>6,u=63&o,isNaN(a)?l=u=64:isNaN(o)&&(u=64),c+=t.charAt(i)+t.charAt(s)+t.charAt(l)+t.charAt(u),n=a=o="",i=s=l=u="";while(d<e.length);return c},o=function(){for(var e=arguments[0],t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}return e},i=function(e,r,a,s){"function"==typeof a&&(s=a,a={}),a.cache=a.cache||!1,a.data=a.data||{},a.headers=a.headers||{},a.jsonp=a.jsonp||!1,a.async=void 0===a.async?!0:a.async;var l,u=o({accept:"*/*","content-type":"application/x-www-form-urlencoded;charset=UTF-8"},i.headers,a.headers);if(l="application/json"===u["content-type"]?JSON.stringify(a.data):n(a.data),"GET"===e){var c=[];if(l&&(c.push(l),l=null),a.cache||c.push("_="+(new Date).getTime()),a.jsonp&&(c.push("callback="+a.jsonp),c.push("jsonp="+a.jsonp)),c=c.join("&"),c.length>1&&(r+=r.indexOf("?")>-1?"&"+c:"?"+c),a.jsonp){var d=document.getElementsByTagName("head")[0],f=document.createElement("script");return f.type="text/javascript",f.src=r,void d.appendChild(f)}}t(function(t,n){if(t)return s(t);n.open(e,r,a.async);for(var o in u)u.hasOwnProperty(o)&&n.setRequestHeader(o,u[o]);n.onreadystatechange=function(){if(4===n.readyState){var e=n.responseText||"";if(!s)return;s(n.status,{text:function(){return e},json:function(){try{return JSON.parse(e)}catch(t){return $.error("Can not parse JSON. URL: "+r),{}}}})}},n.send(l)})},s={authBasic:function(e,t){i.headers.Authorization="Basic "+a(e+":"+t)},connect:function(e,t,n){return i("CONNECT",e,t,n)},del:function(e,t,n){return i("DELETE",e,t,n)},get:function(e,t,n){return i("GET",e,t,n)},head:function(e,t,n){return i("HEAD",e,t,n)},headers:function(e){i.headers=e||{}},isAllowed:function(e,t,n){this.options(e,function(e,r){n(-1!==r.text().indexOf(t))})},options:function(e,t,n){return i("OPTIONS",e,t,n)},patch:function(e,t,n){return i("PATCH",e,t,n)},post:function(e,t,n){return i("POST",e,t,n)},put:function(e,t,n){return i("PUT",e,t,n)},trace:function(e,t,n){return i("TRACE",e,t,n)}},l=e.type?e.type.toLowerCase():"get";s[l](e.url,e,function(t,n){200===t||0===t&&n.text()?e.success(n.json(),t,null):e.error(n.text(),t,null)})}function i(e,t){"function"==typeof e&&(t=e,e={}),e=e||{},$.extend(q,e),delete q.fixLng,q.functions&&(delete q.functions,$.extend($,e.functions)),"string"==typeof q.ns&&(q.ns={namespaces:[q.ns],defaultNs:q.ns}),"string"==typeof q.fallbackNS&&(q.fallbackNS=[q.fallbackNS]),("string"==typeof q.fallbackLng||"boolean"==typeof q.fallbackLng)&&(q.fallbackLng=[q.fallbackLng]),q.interpolationPrefixEscaped=$.regexEscape(q.interpolationPrefix),q.interpolationSuffixEscaped=$.regexEscape(q.interpolationSuffix),q.lng||(q.lng=$.detectLanguage()),F=$.toLanguages(q.lng),N=F[0],$.log("currentLng set to: "+N),q.useCookie&&$.cookie.read(q.cookieName)!==N&&$.cookie.create(q.cookieName,N,q.cookieExpirationTime,q.cookieDomain),q.detectLngFromLocalStorage&&"undefined"!=typeof document&&window.localStorage&&$.localStorage.setItem("i18next_lng",N);var n=T;e.fixLng&&(n=function(e,t){return t=t||{},t.lng=t.lng||n.lng,T(e,t)},n.lng=N),K.setCurrentLng(N),P&&q.setJqueryExt&&L();var r;if(P&&P.Deferred&&(r=P.Deferred()),!q.resStore){var a=$.toLanguages(q.lng);"string"==typeof q.preload&&(q.preload=[q.preload]);for(var o=0,i=q.preload.length;i>o;o++)for(var s=$.toLanguages(q.preload[o]),l=0,u=s.length;u>l;l++)a.indexOf(s[l])<0&&a.push(s[l]);return R.sync.load(a,q,function(e,a){G=a,U=!0,t&&t(n),r&&r.resolve(n)}),r?r.promise():void 0}return G=q.resStore,U=!0,t&&t(n),r&&r.resolve(n),r?r.promise():void 0}function s(){return U}function l(e,t){"string"==typeof e&&(e=[e]);for(var n=0,r=e.length;r>n;n++)q.preload.indexOf(e[n])<0&&q.preload.push(e[n]);return i(t)}function u(e,t,n,r){"string"!=typeof t?(n=t,t=q.ns.defaultNs):q.ns.namespaces.indexOf(t)<0&&q.ns.namespaces.push(t),G[e]=G[e]||{},G[e][t]=G[e][t]||{},r?$.deepExtend(G[e][t],n):$.extend(G[e][t],n),q.useLocalStorage&&Q._storeLocal(G)}function c(e,t){"string"!=typeof t&&(t=q.ns.defaultNs),G[e]=G[e]||{};var n=G[e][t]||{},r=!1;for(var a in n)n.hasOwnProperty(a)&&(r=!0);return r}function d(e,t){return"string"!=typeof t&&(t=q.ns.defaultNs),G[e]=G[e]||{},$.extend({},G[e][t])}function f(e,t){"string"!=typeof t&&(t=q.ns.defaultNs),G[e]=G[e]||{},G[e][t]={},q.useLocalStorage&&Q._storeLocal(G)}function p(e,t,n,r){"string"!=typeof t?(resource=t,t=q.ns.defaultNs):q.ns.namespaces.indexOf(t)<0&&q.ns.namespaces.push(t),G[e]=G[e]||{},G[e][t]=G[e][t]||{};for(var a=n.split(q.keyseparator),o=0,i=G[e][t];a[o];)o==a.length-1?i[a[o]]=r:(null==i[a[o]]&&(i[a[o]]={}),i=i[a[o]]),o++;q.useLocalStorage&&Q._storeLocal(G)}function h(e,t,n){"string"!=typeof t?(resource=t,t=q.ns.defaultNs):q.ns.namespaces.indexOf(t)<0&&q.ns.namespaces.push(t);for(var r in n)"string"==typeof n[r]&&p(e,t,r,n[r])}function m(e){q.ns.defaultNs=e}function g(e,t){v([e],t)}function v(e,t){var n={dynamicLoad:q.dynamicLoad,resGetPath:q.resGetPath,getAsync:q.getAsync,customLoad:q.customLoad,ns:{namespaces:e,defaultNs:""}},r=$.toLanguages(q.lng);"string"==typeof q.preload&&(q.preload=[q.preload]);for(var a=0,o=q.preload.length;o>a;a++)for(var i=$.toLanguages(q.preload[a]),s=0,l=i.length;l>s;s++)r.indexOf(i[s])<0&&r.push(i[s]);for(var u=[],c=0,d=r.length;d>c;c++){var f=!1,p=G[r[c]];if(p)for(var h=0,m=e.length;m>h;h++)p[e[h]]||(f=!0);else f=!0;f&&u.push(r[c])}u.length?R.sync._fetch(u,n,function(n,r){var a=e.length*u.length;$.each(e,function(e,n){q.ns.namespaces.indexOf(n)<0&&q.ns.namespaces.push(n),$.each(u,function(e,o){G[o]=G[o]||{},G[o][n]=r[o][n],a--,0===a&&t&&(q.useLocalStorage&&R.sync._storeLocal(G),t())})})}):t&&t()}function y(e,t,n){return"function"==typeof t?(n=t,t={}):t||(t={}),t.lng=e,i(t,n)}function b(){return N}function _(e){G={},y(N,e)}function x(){window.i18next=window.i18n,z?window.i18n=z:delete window.i18n}function L(){function e(e,t,n){if(0!==t.length){var r="text";if(0===t.indexOf("[")){var a=t.split("]");t=a[1],r=a[0].substr(1,a[0].length-1)}t.indexOf(";")===t.length-1&&(t=t.substr(0,t.length-2));var o;if("html"===r)o=q.defaultValueFromContent?P.extend({defaultValue:e.html()},n):n,e.html(P.t(t,o));else if("text"===r)o=q.defaultValueFromContent?P.extend({defaultValue:e.text()},n):n,e.text(P.t(t,o));else if("prepend"===r)o=q.defaultValueFromContent?P.extend({defaultValue:e.html()},n):n,e.prepend(P.t(t,o));else if("append"===r)o=q.defaultValueFromContent?P.extend({defaultValue:e.html()},n):n,e.append(P.t(t,o));else if(0===r.indexOf("data-")){var i=r.substr("data-".length);o=q.defaultValueFromContent?P.extend({defaultValue:e.data(i)},n):n;var s=P.t(t,o);e.data(i,s),e.attr(r,s)}else o=q.defaultValueFromContent?P.extend({defaultValue:e.attr(r)},n):n,e.attr(r,P.t(t,o))}}function t(t,n){var r=t.attr(q.selectorAttr);if(r||"undefined"==typeof r||r===!1||(r=t.text()||t.val()),r){var a=t,o=t.data("i18n-target");if(o&&(a=t.find(o)||t),n||q.useDataAttrOptions!==!0||(n=t.data("i18n-options")),n=n||{},r.indexOf(";")>=0){var i=r.split(";");P.each(i,function(t,r){""!==r&&e(a,r,n)})}else e(a,r,n);q.useDataAttrOptions===!0&&t.data("i18n-options",n)}}P.t=P.t||T,P.fn.i18n=function(e){return this.each(function(){t(P(this),e);var n=P(this).find("["+q.selectorAttr+"]");n.each(function(){t(P(this),e)})})}}function w(e,t,n,r){if(!e)return e;if(r=r||t,e.indexOf(r.interpolationPrefix||q.interpolationPrefix)<0)return e;var a=r.interpolationPrefix?$.regexEscape(r.interpolationPrefix):q.interpolationPrefixEscaped,o=r.interpolationSuffix?$.regexEscape(r.interpolationSuffix):q.interpolationSuffixEscaped,i="HTML"+o,s=t.replace&&"object"==typeof t.replace?t.replace:t;return $.each(s,function(t,s){var l=n?n+q.keyseparator+t:t;"object"==typeof s&&null!==s?e=w(e,s,l,r):r.escapeInterpolation||q.escapeInterpolation?(e=e.replace(new RegExp([a,l,i].join(""),"g"),$.regexReplacementEscape(s)),e=e.replace(new RegExp([a,l,o].join(""),"g"),$.regexReplacementEscape($.escape(s)))):e=e.replace(new RegExp([a,l,o].join(""),"g"),$.regexReplacementEscape(s))}),e}function S(e,t){var n=",",r="{",a="}",o=$.extend({},t);for(delete o.postProcess;-1!=e.indexOf(q.reusePrefix)&&(B++,!(B>q.maxRecursion));){var i=e.lastIndexOf(q.reusePrefix),s=e.indexOf(q.reuseSuffix,i)+q.reuseSuffix.length,l=e.substring(i,s),u=l.replace(q.reusePrefix,"").replace(q.reuseSuffix,"");if(i>=s)return $.error("there is an missing closing in following translation value",e),"";if(-1!=u.indexOf(n)){var c=u.indexOf(n);if(-1!=u.indexOf(r,c)&&-1!=u.indexOf(a,c)){var d=u.indexOf(r,c),f=u.indexOf(a,d)+a.length;try{o=$.extend(o,JSON.parse(u.substring(d,f))),u=u.substring(0,c)}catch(p){}}}var h=E(u,o);e=e.replace(l,$.regexReplacementEscape(h))}return e}function k(e){return e.context&&("string"==typeof e.context||"number"==typeof e.context)}function C(e,t){return void 0!==e.count&&"string"!=typeof e.count}function j(e){return void 0!==e.indefinite_article&&"string"!=typeof e.indefinite_article&&e.indefinite_article}function M(e,t){t=t||{};var n=A(e,t),r=I(e,t);return void 0!==r||r===n}function T(e,t){return t=t||{},U?(B=0,E.apply(null,arguments)):($.log("i18next not finished initialization. you might have called t function before loading resources finished."),t.defaultValue||"")}function A(e,t){return void 0!==t.defaultValue?t.defaultValue:e}function D(){for(var e=[],t=1;t<arguments.length;t++)e.push(arguments[t]);return{postProcess:"sprintf",sprintf:e}}function E(e,t){if(t&&"object"!=typeof t?"sprintf"===q.shortcutFunction?t=D.apply(null,arguments):"defaultValue"===q.shortcutFunction&&(t={defaultValue:t}):t=t||{},"object"==typeof q.defaultVariables&&(t=$.extend({},q.defaultVariables,t)),void 0===e||null===e||""===e)return"";"number"==typeof e&&(e=String(e)),"string"==typeof e&&(e=[e]);var n=e[0];if(e.length>1)for(var r=0;r<e.length&&(n=e[r],!M(n,t));r++);var a,o=A(n,t),i=I(n,t),s=t.lng?$.toLanguages(t.lng,t.fallbackLng):F,l=t.ns||q.ns.defaultNs;n.indexOf(q.nsseparator)>-1&&(a=n.split(q.nsseparator),l=a[0],n=a[1]),void 0===i&&q.sendMissing&&"function"==typeof q.missingKeyHandler&&(t.lng?q.missingKeyHandler(s[0],l,n,o,s):q.missingKeyHandler(q.lng,l,n,o,s));var u;u="string"==typeof q.postProcess&&""!==q.postProcess?[q.postProcess]:"array"==typeof q.postProcess||"object"==typeof q.postProcess?q.postProcess:[],"string"==typeof t.postProcess&&""!==t.postProcess?u=u.concat([t.postProcess]):("array"==typeof t.postProcess||"object"==typeof t.postProcess)&&(u=u.concat(t.postProcess)),void 0!==i&&u.length&&u.forEach(function(e){Y[e]&&(i=Y[e](i,n,t))});var c=o;if(o.indexOf(q.nsseparator)>-1&&(a=o.split(q.nsseparator),c=a[1]),c===n&&q.parseMissingKey&&(o=q.parseMissingKey(o)),void 0===i&&(o=w(o,t),o=S(o,t),u.length)){var d=A(n,t);u.forEach(function(e){Y[e]&&(i=Y[e](d,n,t))})}return void 0!==i?i:o}function I(e,t){t=t||{};var n,r,a=A(e,t),o=F;if(!G)return a;if("cimode"===o[0].toLowerCase())return a;if(t.lngs&&(o=t.lngs),t.lng&&(o=$.toLanguages(t.lng,t.fallbackLng),!G[o[0]])){var i=q.getAsync;q.getAsync=!1,R.sync.load(o,q,function(e,t){$.extend(G,t),q.getAsync=i})}var s=t.ns||q.ns.defaultNs;if(e.indexOf(q.nsseparator)>-1){var l=e.split(q.nsseparator);s=l[0],e=l[1]}if(k(t)){n=$.extend({},t),delete n.context,n.defaultValue=q.contextNotFound;var u=s+q.nsseparator+e+"_"+t.context;if(r=T(u,n),r!=q.contextNotFound)return w(r,{context:t.context})}if(C(t,o[0])){n=$.extend({lngs:[o[0]]},t),delete n.count,n._origLng=n._origLng||n.lng||o[0],delete n.lng,n.defaultValue=q.pluralNotFound;var c;if(K.needsPlural(o[0],t.count)){c=s+q.nsseparator+e+q.pluralSuffix;var d=K.get(o[0],t.count);d>=0?c=c+"_"+d:1===d&&(c=s+q.nsseparator+e)}else c=s+q.nsseparator+e;if(r=T(c,n),r!=q.pluralNotFound)return w(r,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix});if(!(o.length>1))return n.lng=n._origLng,delete n._origLng,r=T(s+q.nsseparator+e,n),w(r,{count:t.count,interpolationPrefix:t.interpolationPrefix,interpolationSuffix:t.interpolationSuffix});var f=o.slice();if(f.shift(),t=$.extend(t,{lngs:f}),t._origLng=n._origLng,delete t.lng,r=T(s+q.nsseparator+e,t),r!=q.pluralNotFound)return r}if(j(t)){var p=$.extend({},t);delete p.indefinite_article,p.defaultValue=q.indefiniteNotFound;var h=s+q.nsseparator+e+(t.count&&!C(t,o[0])||!t.count?q.indefiniteSuffix:"");if(r=T(h,p),r!=q.indefiniteNotFound)return r}for(var m,g=e.split(q.keyseparator),v=0,y=o.length;y>v&&void 0===m;v++){for(var b=o[v],_=0,x=G[b]&&G[b][s];g[_];)x=x&&x[g[_]],_++;if(void 0!==x&&(!q.showKeyIfEmpty||""!==x)){var L=Object.prototype.toString.apply(x);if("string"==typeof x)x=w(x,t),x=S(x,t);else if("[object Array]"!==L||q.returnObjectTrees||t.returnObjectTrees){if(null===x&&q.fallbackOnNull===!0)x=void 0;else if(null!==x)if(q.returnObjectTrees||t.returnObjectTrees){if("[object Number]"!==L&&"[object Function]"!==L&&"[object RegExp]"!==L){var M="[object Array]"===L?[]:{};$.each(x,function(n){M[n]=E(s+q.nsseparator+e+q.keyseparator+n,t)}),x=M}}else q.objectTreeKeyHandler&&"function"==typeof q.objectTreeKeyHandler?x=q.objectTreeKeyHandler(e,x,b,s,t):(x="key '"+s+":"+e+" ("+b+")' returned an object instead of string.",$.log(x))}else x=x.join("\n"),x=w(x,t),x=S(x,t);"string"==typeof x&&""===x.trim()&&q.fallbackOnEmpty===!0&&(x=void 0),m=x}}if(void 0===m&&!t.isFallbackLookup&&(q.fallbackToDefaultNS===!0||q.fallbackNS&&q.fallbackNS.length>0)){if(t.isFallbackLookup=!0,q.fallbackNS.length){for(var D=0,O=q.fallbackNS.length;O>D;D++)if(m=I(q.fallbackNS[D]+q.nsseparator+e,t),m||""===m&&q.fallbackOnEmpty===!1){var N=m.indexOf(q.nsseparator)>-1?m.split(q.nsseparator)[1]:m,P=a.indexOf(q.nsseparator)>-1?a.split(q.nsseparator)[1]:a;if(N!==P)break}}else t.ns=q.ns.defaultNs,m=I(e,t);t.isFallbackLookup=!1}return m}function O(){var e,t=q.lngWhitelist||[],n=[];if("undefined"!=typeof window&&!function(){for(var e=window.location.search.substring(1),t=e.split("&"),r=0;r<t.length;r++){var a=t[r].indexOf("=");if(a>0){var o=t[r].substring(0,a);o==q.detectLngQS&&n.push(t[r].substring(a+1))}}}(),q.useCookie&&"undefined"!=typeof document){var r=$.cookie.read(q.cookieName);r&&n.push(r)}if(q.detectLngFromLocalStorage&&"undefined"!=typeof window&&window.localStorage){var a=$.localStorage.getItem("i18next_lng");a&&n.push(a)}if("undefined"!=typeof navigator){if(navigator.languages)for(var o=0;o<navigator.languages.length;o++)n.push(navigator.languages[o]);navigator.userLanguage&&n.push(navigator.userLanguage),navigator.language&&n.push(navigator.language)}return function(){for(var r=0;r<n.length;r++){var a=n[r];if(a.indexOf("-")>-1){var o=a.split("-");a=q.lowerCaseLng?o[0].toLowerCase()+"-"+o[1].toLowerCase():o[0].toLowerCase()+"-"+o[1].toUpperCase()}if(0===t.length||t.indexOf(a)>-1){e=a;break}}}(),e||(e=q.fallbackLng[0]),e}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>0&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&r!=1/0&&r!=-(1/0)&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var a=r>=0?r:Math.max(n-Math.abs(r),0);n>a;a++)if(a in t&&t[a]===e)return a;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=n;arguments.length>1&&(r=Number(arguments[1]),r!=r?r=0:0!=r&&r!=1/0&&r!=-(1/0)&&(r=(r>0||-1)*Math.floor(Math.abs(r))));for(var a=r>=0?Math.min(r,n-1):n-Math.abs(r);a>=0;a--)if(a in t&&t[a]===e)return a;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var N,P=e.jQuery||e.Zepto,R={},G={},B=0,F=[],U=!1,Q={},z=null;"undefined"!=typeof module&&module.exports?module.exports=R:(P&&(P.i18n=P.i18n||R),e.i18n&&(z=e.i18n),e.i18n=R),Q={load:function(e,t,n){t.useLocalStorage?Q._loadLocal(e,t,function(r,a){for(var o=[],i=0,s=e.length;s>i;i++)a[e[i]]||o.push(e[i]);o.length>0?Q._fetch(o,t,function(e,t){$.extend(a,t),Q._storeLocal(t),n(null,a)}):n(null,a)}):Q._fetch(e,t,function(e,t){n(null,t)})},_loadLocal:function(e,t,n){var r={},a=(new Date).getTime();if(window.localStorage){var o=e.length;$.each(e,function(e,i){var s=$.localStorage.getItem("res_"+i);s&&(s=JSON.parse(s),s.i18nStamp&&s.i18nStamp+t.localStorageExpirationTime>a&&(r[i]=s)),o--,0===o&&n(null,r)})}},_storeLocal:function(e){if(window.localStorage)for(var t in e)e[t].i18nStamp=(new Date).getTime(),$.localStorage.setItem("res_"+t,JSON.stringify(e[t]))},_fetch:function(e,t,n){var r=t.ns,a={};if(t.dynamicLoad){var o=function(e,t){n(null,t)};if("function"==typeof t.customLoad)t.customLoad(e,r.namespaces,t,o);else{var i=w(t.resGetPath,{lng:e.join("+"),ns:r.namespaces.join("+")});$.ajax({url:i,cache:t.cache,success:function(e,t,n){$.log("loaded: "+i),o(null,e)},error:function(e,t,n){$.log("failed loading: "+i),o("failed loading resource.json error: "+n)},dataType:"json",async:t.getAsync,timeout:t.ajaxTimeout})}}else{var s,l=r.namespaces.length*e.length;$.each(r.namespaces,function(r,o){$.each(e,function(e,r){var i=function(e,t){e&&(s=s||[],s.push(e)),a[r]=a[r]||{},a[r][o]=t,l--,0===l&&n(s,a)};"function"==typeof t.customLoad?t.customLoad(r,o,t,i):Q._fetchOne(r,o,t,i)})})}},_fetchOne:function(e,t,n,r){var a=w(n.resGetPath,{lng:e,ns:t});$.ajax({url:a,cache:n.cache,success:function(e,t,n){$.log("loaded: "+a),r(null,e)},error:function(e,t,n){if(t&&200==t||e&&e.status&&200==e.status)$.error("There is a typo in: "+a);else if(t&&404==t||e&&e.status&&404==e.status)$.log("Does not exist: "+a);else{var o=t?t:e&&e.status?e.status:null;$.log(o+" when loading "+a)}r(n,{})},dataType:"json",async:n.getAsync,timeout:n.ajaxTimeout})},postMissing:function(e,t,n,r,a){var o={};o[n]=r;var i=[];if("fallback"===q.sendMissingTo&&q.fallbackLng[0]!==!1)for(var s=0;s<q.fallbackLng.length;s++)i.push({lng:q.fallbackLng[s],url:w(q.resPostPath,{lng:q.fallbackLng[s],ns:t})});else if("current"===q.sendMissingTo||"fallback"===q.sendMissingTo&&q.fallbackLng[0]===!1)i.push({lng:e,url:w(q.resPostPath,{lng:e,ns:t})});else if("all"===q.sendMissingTo)for(var s=0,l=a.length;l>s;s++)i.push({lng:a[s],url:w(q.resPostPath,{lng:a[s],ns:t})});for(var u=0,c=i.length;c>u;u++){var d=i[u];$.ajax({url:d.url,type:q.sendType,data:o,success:function(e,a,o){$.log("posted missing key '"+n+"' to: "+d.url);for(var i=n.split("."),s=0,l=G[d.lng][t];i[s];)l=l[i[s]]=s===i.length-1?r:l[i[s]]||{},s++},error:function(e,t,r){$.log("failed posting missing key '"+n+"' to: "+d.url)},dataType:"json",async:q.postAsync,timeout:q.ajaxTimeout})}},reload:_};var q={lng:void 0,load:"all",preload:[],lowerCaseLng:!1,returnObjectTrees:!1,fallbackLng:["dev"],fallbackNS:[],detectLngQS:"setLng",detectLngFromLocalStorage:!1,ns:{namespaces:["translation"],defaultNs:"translation"},fallbackOnNull:!0,fallbackOnEmpty:!1,fallbackToDefaultNS:!1,showKeyIfEmpty:!1,nsseparator:":",keyseparator:".",selectorAttr:"data-i18n",debug:!1,resGetPath:"locales/__lng__/__ns__.json",resPostPath:"locales/add/__lng__/__ns__",getAsync:!0,postAsync:!0,resStore:void 0,useLocalStorage:!1,localStorageExpirationTime:6048e5,dynamicLoad:!1,sendMissing:!1,sendMissingTo:"fallback",sendType:"POST",interpolationPrefix:"__",interpolationSuffix:"__",defaultVariables:!1,reusePrefix:"$t(",reuseSuffix:")",pluralSuffix:"_plural",pluralNotFound:["plural_not_found",Math.random()].join(""),contextNotFound:["context_not_found",Math.random()].join(""),escapeInterpolation:!1,indefiniteSuffix:"_indefinite",indefiniteNotFound:["indefinite_not_found",Math.random()].join(""),setJqueryExt:!0,defaultValueFromContent:!0,useDataAttrOptions:!1,cookieExpirationTime:void 0,useCookie:!0,cookieName:"i18next",cookieDomain:void 0,objectTreeKeyHandler:void 0,postProcess:void 0,parseMissingKey:void 0,missingKeyHandler:Q.postMissing,ajaxTimeout:0,shortcutFunction:"sprintf"},V={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},Z={create:function(e,t,n,r){var a;if(n){var o=new Date;o.setTime(o.getTime()+60*n*1e3),a="; expires="+o.toGMTString()}else a="";r=r?"domain="+r+";":"",document.cookie=e+"="+t+a+";"+r+"path=/"},read:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var a=n[r];" "==a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null},remove:function(e){this.create(e,"",-1)}},H={create:function(e,t,n,r){},read:function(e){return null},remove:function(e){}},$={extend:P?P.extend:t,deepExtend:n,each:P?P.each:r,ajax:P?P.ajax:"undefined"!=typeof document?o:function(){},cookie:"undefined"!=typeof document?Z:H,detectLanguage:O,escape:a,log:function(e){q.debug&&"undefined"!=typeof console&&console.log(e)},error:function(e){"undefined"!=typeof console&&console.error(e)},getCountyIndexOfLng:function(e){var t=0;return("nb-NO"===e||"nn-NO"===e||"nb-no"===e||"nn-no"===e)&&(t=1),t},toLanguages:function(e){function t(e){var t=e;if("string"==typeof e&&e.indexOf("-")>-1){var n=e.split("-");t=q.lowerCaseLng?n[0].toLowerCase()+"-"+n[1].toLowerCase():n[0].toLowerCase()+"-"+n[1].toUpperCase()}else t=q.lowerCaseLng?e.toLowerCase():e;return t}var n=this.log,r=[],a=q.lngWhitelist||!1,o=function(e){!a||a.indexOf(e)>-1?r.push(e):n("rejecting non-whitelisted language: "+e)};if("string"==typeof e&&e.indexOf("-")>-1){var i=e.split("-");"unspecific"!==q.load&&o(t(e)),"current"!==q.load&&o(t(i[this.getCountyIndexOfLng(e)]))}else o(t(e));for(var s=0;s<q.fallbackLng.length;s++)-1===r.indexOf(q.fallbackLng[s])&&q.fallbackLng[s]&&r.push(t(q.fallbackLng[s]));return r},regexEscape:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},regexReplacementEscape:function(e){return"string"==typeof e?e.replace(/\$/g,"$$$$"):e},localStorage:{setItem:function(e,t){if(window.localStorage)try{window.localStorage.setItem(e,t)}catch(n){$.log('failed to set value for key "'+e+'" to localStorage.')}},getItem:function(e,t){if(window.localStorage)try{return window.localStorage.getItem(e,t)}catch(n){return void $.log('failed to get value for key "'+e+'" from localStorage.')}}}};$.applyReplacement=w;var W=[["ach","Acholi",[1,2],1],["af","Afrikaans",[1,2],2],["ak","Akan",[1,2],1],["am","Amharic",[1,2],1],["an","Aragonese",[1,2],2],["ar","Arabic",[0,1,2,3,11,100],5],["arn","Mapudungun",[1,2],1],["ast","Asturian",[1,2],2],["ay","Aymará",[1],3],["az","Azerbaijani",[1,2],2],["be","Belarusian",[1,2,5],4],["bg","Bulgarian",[1,2],2],["bn","Bengali",[1,2],2],["bo","Tibetan",[1],3],["br","Breton",[1,2],1],["bs","Bosnian",[1,2,5],4],["ca","Catalan",[1,2],2],["cgg","Chiga",[1],3],["cs","Czech",[1,2,5],6],["csb","Kashubian",[1,2,5],7],["cy","Welsh",[1,2,3,8],8],["da","Danish",[1,2],2],["de","German",[1,2],2],["dev","Development Fallback",[1,2],2],["dz","Dzongkha",[1],3],["el","Greek",[1,2],2],["en","English",[1,2],2],["eo","Esperanto",[1,2],2],["es","Spanish",[1,2],2],["es_ar","Argentinean Spanish",[1,2],2],["et","Estonian",[1,2],2],["eu","Basque",[1,2],2],["fa","Persian",[1],3],["fi","Finnish",[1,2],2],["fil","Filipino",[1,2],1],["fo","Faroese",[1,2],2],["fr","French",[1,2],9],["fur","Friulian",[1,2],2],["fy","Frisian",[1,2],2],["ga","Irish",[1,2,3,7,11],10],["gd","Scottish Gaelic",[1,2,3,20],11],["gl","Galician",[1,2],2],["gu","Gujarati",[1,2],2],["gun","Gun",[1,2],1],["ha","Hausa",[1,2],2],["he","Hebrew",[1,2],2],["hi","Hindi",[1,2],2],["hr","Croatian",[1,2,5],4],["hu","Hungarian",[1,2],2],["hy","Armenian",[1,2],2],["ia","Interlingua",[1,2],2],["id","Indonesian",[1],3],["is","Icelandic",[1,2],12],["it","Italian",[1,2],2],["ja","Japanese",[1],3],["jbo","Lojban",[1],3],["jv","Javanese",[0,1],13],["ka","Georgian",[1],3],["kk","Kazakh",[1],3],["km","Khmer",[1],3],["kn","Kannada",[1,2],2],["ko","Korean",[1],3],["ku","Kurdish",[1,2],2],["kw","Cornish",[1,2,3,4],14],["ky","Kyrgyz",[1],3],["lb","Letzeburgesch",[1,2],2],["ln","Lingala",[1,2],1],["lo","Lao",[1],3],["lt","Lithuanian",[1,2,10],15],["lv","Latvian",[1,2,0],16],["mai","Maithili",[1,2],2],["mfe","Mauritian Creole",[1,2],1],["mg","Malagasy",[1,2],1],["mi","Maori",[1,2],1],["mk","Macedonian",[1,2],17],["ml","Malayalam",[1,2],2],["mn","Mongolian",[1,2],2],["mnk","Mandinka",[0,1,2],18],["mr","Marathi",[1,2],2],["ms","Malay",[1],3],["mt","Maltese",[1,2,11,20],19],["nah","Nahuatl",[1,2],2],["nap","Neapolitan",[1,2],2],["nb","Norwegian Bokmal",[1,2],2],["ne","Nepali",[1,2],2],["nl","Dutch",[1,2],2],["nn","Norwegian Nynorsk",[1,2],2],["no","Norwegian",[1,2],2],["nso","Northern Sotho",[1,2],2],["oc","Occitan",[1,2],1],["or","Oriya",[2,1],2],["pa","Punjabi",[1,2],2],["pap","Papiamento",[1,2],2],["pl","Polish",[1,2,5],7],["pms","Piemontese",[1,2],2],["ps","Pashto",[1,2],2],["pt","Portuguese",[1,2],2],["pt_br","Brazilian Portuguese",[1,2],2],["rm","Romansh",[1,2],2],["ro","Romanian",[1,2,20],20],["ru","Russian",[1,2,5],4],["sah","Yakut",[1],3],["sco","Scots",[1,2],2],["se","Northern Sami",[1,2],2],["si","Sinhala",[1,2],2],["sk","Slovak",[1,2,5],6],["sl","Slovenian",[5,1,2,3],21],["so","Somali",[1,2],2],["son","Songhay",[1,2],2],["sq","Albanian",[1,2],2],["sr","Serbian",[1,2,5],4],["su","Sundanese",[1],3],["sv","Swedish",[1,2],2],["sw","Swahili",[1,2],2],["ta","Tamil",[1,2],2],["te","Telugu",[1,2],2],["tg","Tajik",[1,2],1],["th","Thai",[1],3],["ti","Tigrinya",[1,2],1],["tk","Turkmen",[1,2],2],["tr","Turkish",[1,2],1],["tt","Tatar",[1],3],["ug","Uyghur",[1],3],["uk","Ukrainian",[1,2,5],4],["ur","Urdu",[1,2],2],["uz","Uzbek",[1,2],1],["vi","Vietnamese",[1],3],["wa","Walloon",[1,2],1],["wo","Wolof",[1],3],["yo","Yoruba",[1,2],2],["zh","Chinese",[1],3]],J={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)},5:function(e){return Number(0===e?0:1==e?1:2==e?2:e%100>=3&&10>=e%100?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&4>=e?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&4>=e%10&&(10>e%100||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:7>e?2:11>e?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&20>e?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(10>e%100||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1?0:1)},18:function(e){return Number(1==e?1:2)},19:function(e){return Number(1==e?0:0===e||e%100>1&&11>e%100?1:e%100>10&&20>e%100?2:3)},20:function(e){return Number(1==e?0:0===e||e%100>0&&20>e%100?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)}},K={rules:function(){var e,t={};for(e=W.length;e--;)t[W[e][0]]={name:W[e][1],numbers:W[e][2],plurals:J[W[e][3]]};return t}(),addRule:function(e,t){K.rules[e]=t},setCurrentLng:function(e){if(!K.currentRule||K.currentRule.lng!==e){var t=e.split("-");K.currentRule={lng:e,rule:K.rules[t[0]]}}},needsPlural:function(e,t){var n,r=e.split("-");return n=K.currentRule&&K.currentRule.lng===e?K.currentRule.rule:K.rules[r[$.getCountyIndexOfLng(e)]],n&&n.numbers.length<=1?!1:1!==this.get(e,t)},get:function(e,t){function n(t,n){var r;if(r=K.currentRule&&K.currentRule.lng===e?K.currentRule.rule:K.rules[t]){var a;a=r.plurals(r.noAbs?n:Math.abs(n));var o=r.numbers[a];return 2===r.numbers.length&&1===r.numbers[0]&&(2===o?o=-1:1===o&&(o=1)),o}return 1===n?"1":"-1"}var r=e.split("-");return n(r[$.getCountyIndexOfLng(e)],t)}},Y={},X=function(e,t){Y[e]=t},ee=function(){function e(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}function t(e,t){for(var n=[];t>0;n[--t]=e);return n.join("")}var n=function(){return n.cache.hasOwnProperty(arguments[0])||(n.cache[arguments[0]]=n.parse(arguments[0])),n.format.call(null,n.cache[arguments[0]],arguments)};return n.format=function(n,r){var a,o,i,s,l,u,c,d=1,f=n.length,p="",h=[];for(o=0;f>o;o++)if(p=e(n[o]),"string"===p)h.push(n[o]);else if("array"===p){if(s=n[o],s[2])for(a=r[d],i=0;i<s[2].length;i++){if(!a.hasOwnProperty(s[2][i]))throw ee('[sprintf] property "%s" does not exist',s[2][i]);a=a[s[2][i]]}else a=s[1]?r[s[1]]:r[d++];if(/[^s]/.test(s[8])&&"number"!=e(a))throw ee("[sprintf] expecting number but found %s",e(a));switch(s[8]){case"b":a=a.toString(2);break;case"c":a=String.fromCharCode(a);break;case"d":a=parseInt(a,10);break;case"e":a=s[7]?a.toExponential(s[7]):a.toExponential();break;case"f":a=s[7]?parseFloat(a).toFixed(s[7]):parseFloat(a);break;case"o":a=a.toString(8);break;case"s":a=(a=String(a))&&s[7]?a.substring(0,s[7]):a;break;case"u":a=Math.abs(a);break;case"x":a=a.toString(16);break;case"X":a=a.toString(16).toUpperCase()}a=/[def]/.test(s[8])&&s[3]&&a>=0?"+"+a:a,u=s[4]?"0"==s[4]?"0":s[4].charAt(1):" ",c=s[6]-String(a).length,l=s[6]?t(u,c):"",h.push(s[5]?a+l:l+a)}return h.join("")},n.cache={},n.parse=function(e){for(var t=e,n=[],r=[],a=0;t;){if(null!==(n=/^[^\x25]+/.exec(t)))r.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(t)))r.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t)))throw"[sprintf] huh?";if(n[2]){a|=1;var o=[],i=n[2],s=[];if(null===(s=/^([a-z_][a-z_\d]*)/i.exec(i)))throw"[sprintf] huh?";for(o.push(s[1]);""!==(i=i.substring(s[0].length));)if(null!==(s=/^\.([a-z_][a-z_\d]*)/i.exec(i)))o.push(s[1]);else{if(null===(s=/^\[(\d+)\]/.exec(i)))throw"[sprintf] huh?";o.push(s[1])}n[2]=o}else a|=2;if(3===a)throw"[sprintf] mixing positional and named placeholders is not (yet) supported";r.push(n)}t=t.substring(n[0].length)}return r},n}(),te=function(e,t){return t.unshift(e),ee.apply(null,t)};X("sprintf",function(e,t,n){return n.sprintf?"[object Array]"===Object.prototype.toString.apply(n.sprintf)?te(e,n.sprintf):"object"==typeof n.sprintf?ee(e,n.sprintf):e:e}),R.init=i,R.isInitialized=s,R.setLng=y,R.preload=l,R.addResourceBundle=u,R.hasResourceBundle=c,R.getResourceBundle=d,R.addResource=p,R.addResources=h,R.removeResourceBundle=f,R.loadNamespace=g,R.loadNamespaces=v,R.setDefaultNamespace=m,R.t=T,R.translate=T,R.exists=M,R.detectLanguage=$.detectLanguage,R.pluralExtensions=K,R.sync=Q,R.functions=$,R.lng=b,R.addPostProcessor=X,R.applyReplacement=$.applyReplacement,R.options=q,R.noConflict=x}("undefined"==typeof exports?window:exports),L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,mapOptions:{backgroundColor:"#dddddd"
}},initialize:function(e,t){return L.Util.setOptions(this,t),"undefined"==typeof google?!1:(this._ready=void 0!==google.maps.Map,this._ready||L.Google.asyncWait.push(this),void(this._type=e||"SATELLITE"))},onAdd:function(e,t){this._map=e,this._insertAtTheBottom=t,this._initContainer(),this._initMapObject(),e.on("viewreset",this._resetCallback,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),e.on("move",this._update,this),e.on("zoomanim",this._handleZoomAnim,this),e._controlCorners.bottomright.style.marginBottom="20px",this._reset(),this._update()},onRemove:function(e){e._container.removeChild(this._container),e.off("viewreset",this._resetCallback,this),e.off("move",this._update,this),e.off("zoomanim",this._handleZoomAnim,this),e._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(e){this.options.opacity=e,1>e&&L.DomUtil.setOpacity(this._container,e)},setElementSize:function(e,t){e.style.width=t.x+"px",e.style.height=t.y+"px"},_initContainer:function(){var e=this._map._container,t=e.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),e.insertBefore(this._container,t),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var e=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor}),t=this;this._reposition=google.maps.event.addListenerOnce(e,"center_changed",function(){t.onReposition()}),this._google=e,google.maps.event.addListenerOnce(e,"idle",function(){t._checkZoomLevels()}),this.fire("MapObjectInitialized",{mapObject:e})}},_checkZoomLevels:function(){this._google.getZoom()!==this._map.getZoom()&&this._map.setZoom(this._google.getZoom())},_resetCallback:function(e){this._reset(e.hard)},_reset:function(e){this._initContainer()},_update:function(e){if(this._google){this._resize();var t=this._map.getCenter(),n=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(n),this._google.setZoom(Math.round(this._map.getZoom())),this._checkZoomLevels()}},_resize:function(){var e=this._map.getSize();(this._container.style.width!==e.x||this._container.style.height!==e.y)&&(this.setElementSize(this._container,e),this.onReposition())},_handleZoomAnim:function(e){var t=e.center,n=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(n),this._google.setZoom(Math.round(e.zoom))},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[],L.Google.asyncInitialize=function(){var e;for(e=0;e<L.Google.asyncWait.length;e++){var t=L.Google.asyncWait[e];t._ready=!0,t._container&&(t._initMapObject(),t._update())}L.Google.asyncWait=[]},L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(e,t){L.Util.setOptions(this,t),this._key=e,this._url=null,this.meta={},this.loadMetadata()},tile2quad:function(e,t,n){for(var r="",a=n;a>0;a--){var o=0,i=1<<a-1;0!==(e&i)&&(o+=1),0!==(t&i)&&(o+=2),r+=o}return r},getTileUrl:function(e,t){var n=this._getZoomForUrl(),r=this.options.subdomains,a=this.options.subdomains[Math.abs((e.x+e.y)%r.length)];return this._url.replace("{subdomain}",a).replace("{quadkey}",this.tile2quad(e.x,e.y,n)).replace("{culture}",this.options.culture)},loadMetadata:function(){var e=this,t="_bing_metadata_"+L.Util.stamp(this);window[t]=function(n){e.meta=n,window[t]=void 0;var r=document.getElementById(t);return r.parentNode.removeChild(r),n.errorDetails?void(window.console&&console.log("Leaflet Bing Plugin Error - Got metadata: "+n.errorDetails)):void e.initMetadata()};var n=document.location.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+t+"&key="+this._key+"&UriScheme="+document.location.protocol.slice(0,-1),r=document.createElement("script");r.type="text/javascript",r.src=n,r.id=t,document.getElementsByTagName("head")[0].appendChild(r)},initMetadata:function(){var e=this.meta.resourceSets[0].resources[0];if(this.options.subdomains=e.imageUrlSubdomains,this._url=e.imageUrl,this._providers=[],e.imageryProviders)for(var t=0;t<e.imageryProviders.length;t++)for(var n=e.imageryProviders[t],r=0;r<n.coverageAreas.length;r++){var a=n.coverageAreas[r],o={zoomMin:a.zoomMin,zoomMax:a.zoomMax,active:!1},i=new L.LatLngBounds(new L.LatLng(a.bbox[0]+.01,a.bbox[1]+.01),new L.LatLng(a.bbox[2]-.01,a.bbox[3]-.01));o.bounds=i,o.attrib=n.attribution,this._providers.push(o)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var e=this._map.getBounds(),t=this._map.getZoom(),n=0;n<this._providers.length;n++){var r=this._providers[n];t<=r.zoomMax&&t>=r.zoomMin&&e.intersects(r.bounds)?(!r.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(r.attrib),r.active=!0):(r.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(r.attrib),r.active=!1)}},onRemove:function(e){for(var t=0;t<this._providers.length;t++){var n=this._providers[t];n.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(n.attrib),n.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[e])}}),L.bingLayer=function(e,t){return new L.BingLayer(e,t)},L.TileLayer.WMTS=L.TileLayer.extend({defaultWmtsParams:{service:"WMTS",request:"GetTile",version:"1.0.0",layer:"",style:"",tilematrixSet:"",format:"image/jpeg"},initialize:function(e,t){this._url=e;var n=L.extend({},this.defaultWmtsParams),r=t.tileSize||this.options.tileSize;n.width=n.height=t.detectRetina&&L.Browser.retina?2*r:r;for(var a in t)this.options.hasOwnProperty(a)||"matrixIds"==a||(n[a]=t[a]);this.wmtsParams=n,this.matrixIds=t.matrixIds||this.getDefaultMatrix(),L.setOptions(this,t)},onAdd:function(e){L.TileLayer.prototype.onAdd.call(this,e)},getTileUrl:function(e,t){var n=this._map;return crs=n.options.crs,tileSize=this.options.tileSize,nwPoint=e.multiplyBy(tileSize),nwPoint.x+=1,nwPoint.y-=1,sePoint=nwPoint.add(new L.Point(tileSize,tileSize)),nw=crs.project(n.unproject(nwPoint,t)),se=crs.project(n.unproject(sePoint,t)),tilewidth=se.x-nw.x,t=n.getZoom(),ident=this.matrixIds[t].identifier,X0=this.matrixIds[t].topLeftCorner.lng,Y0=this.matrixIds[t].topLeftCorner.lat,tilecol=Math.round((nw.x-X0)/tilewidth),tilerow=-Math.round((nw.y-Y0)/tilewidth),url=L.Util.template(this._url,{s:this._getSubdomain(e)}),url+L.Util.getParamString(this.wmtsParams,url)+"&tilematrix="+ident+"&tilerow="+tilerow+"&tilecol="+tilecol},setParams:function(e,t){return L.extend(this.wmtsParams,e),t||this.redraw(),this},getDefaultMatrix:function(){for(var e=new Array(22),t=0;22>t;t++)e[t]={identifier:""+t,topLeftCorner:new L.LatLng(20037508,-20037508)};return e}}),L.tileLayer.wmts=function(e,t){return new L.TileLayer.WMTS(e,t)},L.Control.ZoomBox=L.Control.extend({_active:!1,_map:null,includes:L.Mixin.Events,options:{position:"topleft",className:"fa fa-search-plus",title:"Zoom to specific area",modal:!1},onAdd:function(e){this._map=e,this._container=L.DomUtil.create("div","leaflet-zoom-box-control leaflet-bar"),this._container.title=this.options.title;var t=L.DomUtil.create("a",this.options.className,this._container);t.href="#";var n=e.boxZoom._onMouseDown;return e.boxZoom._onMouseDown=function(t){n.call(e.boxZoom,{clientX:t.clientX,clientY:t.clientY,which:1,shiftKey:!0})},e.on("zoomend",function(){e.getZoom()==e.getMaxZoom()?L.DomUtil.addClass(t,"leaflet-disabled"):L.DomUtil.removeClass(t,"leaflet-disabled")},this),this.options.modal||e.on("boxzoomend",this.deactivate,this),L.DomEvent.on(this._container,"dblclick",L.DomEvent.stop).on(this._container,"click",L.DomEvent.stop).on(this._container,"click",function(){this._active=!this._active,this._active&&e.getZoom()!=e.getMaxZoom()?this.activate():this.deactivate()},this),this._container},activate:function(){L.DomUtil.addClass(this._container,"active"),this._map.dragging.disable(),this._map.boxZoom.addHooks(),L.DomUtil.addClass(this._map.getContainer(),"leaflet-zoom-box-crosshair")},deactivate:function(){L.DomUtil.removeClass(this._container,"active"),this._map.dragging.enable(),this._map.boxZoom.removeHooks();var e=this._map.getContainer();setTimeout(function(){L.DomUtil.removeClass(e,"leaflet-zoom-box-crosshair")},100),this._active=!1,this._map.boxZoom._moved=!1}}),L.control.zoomBox=function(e){return new L.Control.ZoomBox(e)},function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);var u=new Error("Cannot find module '"+i+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return a(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t,n){var r=e("color-convert"),a=e("color-string"),o=function(e){if(e instanceof o)return e;if(!(this instanceof o))return new o(e);if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},"string"==typeof e){var t=a.getRgba(e);if(t)this.setValues("rgb",t);else if(t=a.getHsla(e))this.setValues("hsl",t);else{if(!(t=a.getHwb(e)))throw new Error('Unable to parse color from string "'+e+'"');this.setValues("hwb",t)}}else if("object"==typeof e){var t=e;if(void 0!==t.r||void 0!==t.red)this.setValues("rgb",t);else if(void 0!==t.l||void 0!==t.lightness)this.setValues("hsl",t);else if(void 0!==t.v||void 0!==t.value)this.setValues("hsv",t);else if(void 0!==t.w||void 0!==t.whiteness)this.setValues("hwb",t);else{if(void 0===t.c&&void 0===t.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(e));this.setValues("cmyk",t)}}};o.prototype={rgb:function(e){return this.setSpace("rgb",arguments)},hsl:function(e){return this.setSpace("hsl",arguments)},hsv:function(e){return this.setSpace("hsv",arguments)},hwb:function(e){return this.setSpace("hwb",arguments)},cmyk:function(e){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){return 1!==this.values.alpha?this.values.hwb.concat([this.values.alpha]):this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var e=this.values.rgb;return e.concat([this.values.alpha])},hslaArray:function(){var e=this.values.hsl;return e.concat([this.values.alpha])},alpha:function(e){return void 0===e?this.values.alpha:(this.setValues("alpha",e),this)},red:function(e){return this.setChannel("rgb",0,e)},green:function(e){return this.setChannel("rgb",1,e)},blue:function(e){return this.setChannel("rgb",2,e)},hue:function(e){return this.setChannel("hsl",0,e)},saturation:function(e){return this.setChannel("hsl",1,e)},lightness:function(e){return this.setChannel("hsl",2,e)},saturationv:function(e){return this.setChannel("hsv",1,e)},whiteness:function(e){return this.setChannel("hwb",1,e)},blackness:function(e){return this.setChannel("hwb",2,e)},value:function(e){return this.setChannel("hsv",2,e)},cyan:function(e){return this.setChannel("cmyk",0,e)},magenta:function(e){return this.setChannel("cmyk",1,e)},yellow:function(e){return this.setChannel("cmyk",2,e)},black:function(e){return this.setChannel("cmyk",3,e)},hexString:function(){return a.hexString(this.values.rgb)},rgbString:function(){return a.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return a.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return a.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return a.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return a.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return a.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return a.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){return this.values.rgb[0]<<16|this.values.rgb[1]<<8|this.values.rgb[2]},luminosity:function(){for(var e=this.values.rgb,t=[],n=0;n<e.length;n++){var r=e[n]/255;t[n]=.03928>=r?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),n=e.luminosity();return t>n?(t+.05)/(n+.05):(n+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.values.rgb,t=(299*e[0]+587*e[1]+114*e[2])/1e3;return 128>t},light:function(){return!this.dark()},negate:function(){for(var e=[],t=0;3>t;t++)e[t]=255-this.values.rgb[t];return this.setValues("rgb",e),this},lighten:function(e){return this.values.hsl[2]+=this.values.hsl[2]*e,this.setValues("hsl",this.values.hsl),this},darken:function(e){return this.values.hsl[2]-=this.values.hsl[2]*e,this.setValues("hsl",this.values.hsl),this},saturate:function(e){return this.values.hsl[1]+=this.values.hsl[1]*e,this.setValues("hsl",this.values.hsl),this},desaturate:function(e){return this.values.hsl[1]-=this.values.hsl[1]*e,this.setValues("hsl",this.values.hsl),this},whiten:function(e){return this.values.hwb[1]+=this.values.hwb[1]*e,this.setValues("hwb",this.values.hwb),this},blacken:function(e){return this.values.hwb[2]+=this.values.hwb[2]*e,this.setValues("hwb",this.values.hwb),this},greyscale:function(){var e=this.values.rgb,t=.3*e[0]+.59*e[1]+.11*e[2];return this.setValues("rgb",[t,t,t]),this},clearer:function(e){return this.setValues("alpha",this.values.alpha-this.values.alpha*e),this},opaquer:function(e){return this.setValues("alpha",this.values.alpha+this.values.alpha*e),this},rotate:function(e){var t=this.values.hsl[0];return t=(t+e)%360,t=0>t?360+t:t,this.values.hsl[0]=t,this.setValues("hsl",this.values.hsl),this},mix:function(e,t){t=1-(null==t?.5:t);for(var n=2*t-1,r=this.alpha()-e.alpha(),a=((n*r==-1?n:(n+r)/(1+n*r))+1)/2,o=1-a,i=this.rgbArray(),s=e.rgbArray(),l=0;l<i.length;l++)i[l]=i[l]*a+s[l]*o;this.setValues("rgb",i);var u=this.alpha()*t+e.alpha()*(1-t);return this.setValues("alpha",u),this},toJSON:function(){return this.rgb()},clone:function(){return new o(this.rgb())}},o.prototype.getValues=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=this.values[e][n];return 1!=this.values.alpha&&(t.a=this.values.alpha),t},o.prototype.setValues=function(e,t){var n={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},a={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},o=1;if("alpha"==e)o=t;else if(t.length)this.values[e]=t.slice(0,e.length),o=t[e.length];else if(void 0!==t[e.charAt(0)]){for(var i=0;i<e.length;i++)this.values[e][i]=t[e.charAt(i)];o=t.a}else if(void 0!==t[n[e][0]]){for(var s=n[e],i=0;i<e.length;i++)this.values[e][i]=t[s[i]];o=t.alpha}if(this.values.alpha=Math.max(0,Math.min(1,void 0!==o?o:this.values.alpha)),"alpha"!=e){for(var i=0;i<e.length;i++){var l=Math.max(0,Math.min(a[e][i],this.values[e][i]));this.values[e][i]=Math.round(l)}for(var u in n){u!=e&&(this.values[u]=r[e][u](this.values[e]));for(var i=0;i<u.length;i++){var l=Math.max(0,Math.min(a[u][i],this.values[u][i]));this.values[u][i]=Math.round(l)}}return!0}},o.prototype.setSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n),this)},o.prototype.setChannel=function(e,t,n){return void 0===n?this.values[e][t]:(this.values[e][t]=n,this.setValues(e,this.values[e]),this)},t.exports=o},{"color-convert":3,"color-string":4}],2:[function(e,t,n){function a(e){var t,n,r,a=e[0]/255,o=e[1]/255,i=e[2]/255,s=Math.min(a,o,i),l=Math.max(a,o,i),u=l-s;return l==s?t=0:a==l?t=(o-i)/u:o==l?t=2+(i-a)/u:i==l&&(t=4+(a-o)/u),t=Math.min(60*t,360),0>t&&(t+=360),r=(s+l)/2,n=l==s?0:.5>=r?u/(l+s):u/(2-l-s),[t,100*n,100*r]}function o(e){var t,n,r,a=e[0],o=e[1],i=e[2],s=Math.min(a,o,i),l=Math.max(a,o,i),u=l-s;return n=0==l?0:u/l*1e3/10,l==s?t=0:a==l?t=(o-i)/u:o==l?t=2+(i-a)/u:i==l&&(t=4+(a-o)/u),t=Math.min(60*t,360),0>t&&(t+=360),r=l/255*1e3/10,[t,n,r]}function i(e){var t=e[0],n=e[1],r=e[2],o=a(e)[0],i=1/255*Math.min(t,Math.min(n,r)),r=1-1/255*Math.max(t,Math.max(n,r));return[o,100*i,100*r]}function s(e){var t,n,r,a,o=e[0]/255,i=e[1]/255,s=e[2]/255;return a=Math.min(1-o,1-i,1-s),t=(1-o-a)/(1-a)||0,n=(1-i-a)/(1-a)||0,r=(1-s-a)/(1-a)||0,[100*t,100*n,100*r,100*a]}function l(e){return K[JSON.stringify(e)]}function u(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255;t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92;var a=.4124*t+.3576*n+.1805*r,o=.2126*t+.7152*n+.0722*r,i=.0193*t+.1192*n+.9505*r;return[100*a,100*o,100*i]}function c(e){var t,n,r,a=u(e),o=a[0],i=a[1],s=a[2];return o/=95.047,i/=100,s/=108.883,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,s=s>.008856?Math.pow(s,1/3):7.787*s+16/116,t=116*i-16,n=500*(o-i),r=200*(i-s),[t,n,r]}function d(e){return G(c(e))}function f(e){var t,n,r,a,o,i=e[0]/360,s=e[1]/100,l=e[2]/100;if(0==s)return o=255*l,[o,o,o];n=.5>l?l*(1+s):l+s-l*s,t=2*l-n,a=[0,0,0];for(var u=0;3>u;u++)r=i+1/3*-(u-1),0>r&&r++,r>1&&r--,o=1>6*r?t+6*(n-t)*r:1>2*r?n:2>3*r?t+(n-t)*(2/3-r)*6:t,a[u]=255*o;return a}function p(e){var t,n,r=e[0],a=e[1]/100,o=e[2]/100;return o*=2,a*=1>=o?o:2-o,n=(o+a)/2,t=2*a/(o+a),[r,100*t,100*n]}function h(e){return i(f(e))}function m(e){return s(f(e))}function v(e){return l(f(e))}function y(e){var t=e[0]/60,n=e[1]/100,r=e[2]/100,a=Math.floor(t)%6,o=t-Math.floor(t),i=255*r*(1-n),s=255*r*(1-n*o),l=255*r*(1-n*(1-o)),r=255*r;switch(a){case 0:return[r,l,i];case 1:return[s,r,i];case 2:return[i,r,l];case 3:return[i,s,r];case 4:return[l,i,r];case 5:return[r,i,s]}}function _(e){var t,n,r=e[0],a=e[1]/100,o=e[2]/100;return n=(2-a)*o,t=a*o,t/=1>=n?n:2-n,t=t||0,n/=2,[r,100*t,100*n]}function x(e){return i(y(e))}function L(e){return s(y(e))}function w(e){return l(y(e))}function S(e){var t,n,a,o,i=e[0]/360,s=e[1]/100,l=e[2]/100,u=s+l;switch(u>1&&(s/=u,l/=u),t=Math.floor(6*i),n=1-l,a=6*i-t,0!=(1&t)&&(a=1-a),o=s+a*(n-s),t){default:case 6:case 0:r=n,g=o,b=s;break;case 1:r=o,g=n,b=s;break;case 2:r=s,g=n,b=o;break;case 3:r=s,g=o,b=n;break;case 4:r=o,g=s,b=n;break;case 5:r=n,g=s,b=o}return[255*r,255*g,255*b]}function k(e){return a(S(e))}function C(e){return o(S(e))}function j(e){return s(S(e))}function M(e){return l(S(e))}function T(e){var t,n,r,a=e[0]/100,o=e[1]/100,i=e[2]/100,s=e[3]/100;return t=1-Math.min(1,a*(1-s)+s),n=1-Math.min(1,o*(1-s)+s),r=1-Math.min(1,i*(1-s)+s),[255*t,255*n,255*r]}function A(e){return a(T(e))}function D(e){return o(T(e))}function E(e){return i(T(e))}function I(e){return l(T(e))}function O(e){var t,n,r,a=e[0]/100,o=e[1]/100,i=e[2]/100;return t=3.2406*a+-1.5372*o+i*-.4986,n=a*-.9689+1.8758*o+.0415*i,r=.0557*a+o*-.204+1.057*i,t=t>.0031308?1.055*Math.pow(t,1/2.4)-.055:t=12.92*t,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:n=12.92*n,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=12.92*r,t=Math.min(Math.max(0,t),1),n=Math.min(Math.max(0,n),1),r=Math.min(Math.max(0,r),1),[255*t,255*n,255*r]}function N(e){var t,n,r,a=e[0],o=e[1],i=e[2];return a/=95.047,o/=100,i/=108.883,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,o=o>.008856?Math.pow(o,1/3):7.787*o+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116,t=116*o-16,n=500*(a-o),r=200*(o-i),[t,n,r]}function P(e){return G(N(e))}function R(e){var t,n,r,a,o=e[0],i=e[1],s=e[2];return 8>=o?(n=100*o/903.3,a=7.787*(n/100)+16/116):(n=100*Math.pow((o+16)/116,3),a=Math.pow(n/100,1/3)),t=.008856>=t/95.047?t=95.047*(i/500+a-16/116)/7.787:95.047*Math.pow(i/500+a,3),r=.008859>=r/108.883?r=108.883*(a-s/200-16/116)/7.787:108.883*Math.pow(a-s/200,3),[t,n,r]}function G(e){var t,n,r,a=e[0],o=e[1],i=e[2];return t=Math.atan2(i,o),n=360*t/2/Math.PI,0>n&&(n+=360),r=Math.sqrt(o*o+i*i),[a,r,n]}function B(e){return O(R(e))}function F(e){var t,n,r,a=e[0],o=e[1],i=e[2];return r=i/360*2*Math.PI,t=o*Math.cos(r),n=o*Math.sin(r),[a,t,n]}function U(e){return R(F(e))}function Q(e){return B(F(e))}function z(e){return J[e]}function q(e){return a(z(e))}function V(e){return o(z(e))}function Z(e){return i(z(e))}function H(e){return s(z(e))}function $(e){return c(z(e))}function W(e){return u(z(e))}t.exports={rgb2hsl:a,rgb2hsv:o,rgb2hwb:i,rgb2cmyk:s,rgb2keyword:l,rgb2xyz:u,rgb2lab:c,rgb2lch:d,hsl2rgb:f,hsl2hsv:p,hsl2hwb:h,hsl2cmyk:m,hsl2keyword:v,hsv2rgb:y,hsv2hsl:_,hsv2hwb:x,hsv2cmyk:L,hsv2keyword:w,hwb2rgb:S,hwb2hsl:k,hwb2hsv:C,hwb2cmyk:j,hwb2keyword:M,cmyk2rgb:T,cmyk2hsl:A,cmyk2hsv:D,cmyk2hwb:E,cmyk2keyword:I,keyword2rgb:z,keyword2hsl:q,keyword2hsv:V,keyword2hwb:Z,keyword2cmyk:H,keyword2lab:$,keyword2xyz:W,xyz2rgb:O,xyz2lab:N,xyz2lch:P,lab2xyz:R,lab2rgb:B,lab2lch:G,lch2lab:F,lch2xyz:U,lch2rgb:Q};var J={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},K={};for(var Y in J)K[JSON.stringify(J[Y])]=Y},{}],3:[function(e,t,n){var r=e("./conversions"),a=function(){return new u};for(var o in r){a[o+"Raw"]=function(e){return function(t){return"number"==typeof t&&(t=Array.prototype.slice.call(arguments)),r[e](t)}}(o);var i=/(\w+)2(\w+)/.exec(o),s=i[1],l=i[2];a[s]=a[s]||{},a[s][l]=a[o]=function(e){return function(t){"number"==typeof t&&(t=Array.prototype.slice.call(arguments));var n=r[e](t);if("string"==typeof n||void 0===n)return n;for(var a=0;a<n.length;a++)n[a]=Math.round(n[a]);return n}}(o)}var u=function(){this.convs={}};u.prototype.routeSpace=function(e,t){var n=t[0];return void 0===n?this.getValues(e):("number"==typeof n&&(n=Array.prototype.slice.call(t)),this.setValues(e,n))},u.prototype.setValues=function(e,t){return this.space=e,this.convs={},this.convs[e]=t,this},u.prototype.getValues=function(e){var t=this.convs[e];if(!t){var n=this.space,r=this.convs[n];t=a[n][e](r),this.convs[e]=t}return t},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(e){u.prototype[e]=function(t){return this.routeSpace(e,arguments)}}),t.exports=a},{"./conversions":2}],4:[function(e,t,n){function r(e){if(e){var t=/^#([a-fA-F0-9]{3})$/,n=/^#([a-fA-F0-9]{6})$/,r=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,a=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,o=/(\D+)/,i=[0,0,0],s=1,l=e.match(t);if(l){l=l[1];for(var u=0;u<i.length;u++)i[u]=parseInt(l[u]+l[u],16)}else if(l=e.match(n)){l=l[1];for(var u=0;u<i.length;u++)i[u]=parseInt(l.slice(2*u,2*u+2),16)}else if(l=e.match(r)){for(var u=0;u<i.length;u++)i[u]=parseInt(l[u+1]);s=parseFloat(l[4])}else if(l=e.match(a)){for(var u=0;u<i.length;u++)i[u]=Math.round(2.55*parseFloat(l[u+1]));s=parseFloat(l[4])}else if(l=e.match(o)){if("transparent"==l[1])return[0,0,0,0];if(i=_[l[1]],!i)return}for(var u=0;u<i.length;u++)i[u]=y(i[u],0,255);return s=s||0==s?y(s,0,1):1,i[3]=s,i}}function a(e){if(e){var t=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=parseFloat(n[4]),a=y(parseInt(n[1]),0,360),o=y(parseFloat(n[2]),0,100),i=y(parseFloat(n[3]),0,100),s=y(isNaN(r)?1:r,0,1);return[a,o,i,s]}}}function o(e){if(e){var t=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,n=e.match(t);if(n){var r=parseFloat(n[4]),a=y(parseInt(n[1]),0,360),o=y(parseFloat(n[2]),0,100),i=y(parseFloat(n[3]),0,100),s=y(isNaN(r)?1:r,0,1);return[a,o,i,s]}}}function i(e){var t=r(e);return t&&t.slice(0,3)}function s(e){var t=a(e);return t&&t.slice(0,3)}function l(e){var t=r(e);return t?t[3]:(t=a(e))?t[3]:(t=o(e))?t[3]:void 0}function u(e){return"#"+b(e[0])+b(e[1])+b(e[2])}function c(e,t){return 1>t||e[3]&&e[3]<1?d(e,t):"rgb("+e[0]+", "+e[1]+", "+e[2]+")"}function d(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+t+")"}function f(e,t){if(1>t||e[3]&&e[3]<1)return p(e,t);var n=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),a=Math.round(e[2]/255*100);return"rgb("+n+"%, "+r+"%, "+a+"%)"}function p(e,t){var n=Math.round(e[0]/255*100),r=Math.round(e[1]/255*100),a=Math.round(e[2]/255*100);return"rgba("+n+"%, "+r+"%, "+a+"%, "+(t||e[3]||1)+")"}function h(e,t){return 1>t||e[3]&&e[3]<1?m(e,t):"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)"}function m(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+t+")"}function g(e,t){return void 0===t&&(t=void 0!==e[3]?e[3]:1),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+(void 0!==t&&1!==t?", "+t:"")+")"}function v(e){return x[e.slice(0,3)]}function y(e,t,n){return Math.min(Math.max(t,e),n)}function b(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}var _=e("color-name");t.exports={getRgba:r,getHsla:a,getRgb:i,getHsl:s,getHwb:o,getAlpha:l,hexString:u,rgbString:c,rgbaString:d,percentString:f,percentaString:p,hslString:h,hslaString:m,hwbString:g,keyword:v};var x={};for(var L in _)x[_[L]]=L},{"color-name":5}],5:[function(e,t,n){t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],
teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],6:[function(e,t,n){t.exports=e("./lib/geocrunch")},{"./lib/geocrunch":11}],7:[function(e,t,n){var r=e("underscore"),a=e("./constants").EARTHRADIUS,o=e("./units"),i=e("./flipcoords"),s={sqmeters:function(e){return e},sqmiles:function(e){return o.sqMeters.toSqMiles(e)},acres:function(e){return o.sqMeters.toAcres(e)},hectares:function(e){return o.sqMeters.toHectares(e)}},l=function(e){var t,n,r,i,s=0;for(t=0,n=e.length;n>t;t+=1)r=e[t],i=e[(t+1)%e.length],s+=o.degrees.toRadians(i[0]-r[0])*(2+Math.sin(o.degrees.toRadians(r[1]))+Math.sin(o.degrees.toRadians(i[1])));return Math.abs(s*a*a/2)},u=function(e){var t,n,r,a,o,i=e[0],s=0,l=0,u=0;if(1===e.length)return e[0];for(t=0,n=e.length;n>t;t+=1)r=e[t],a=e[(t+1)%e.length],o=(r[1]-i[1])*(a[0]-i[0])-(a[1]-i[1])*(r[0]-i[0]),s+=o,l+=(r[0]+a[0]-2*i[0])*o,u+=(r[1]+a[1]-2*i[1])*o;return o=3*s,[l/o+i[0],u/o+i[1]]};t.exports={_internalAreaCalc:function(){this._calcedArea||(this._calcedArea=this._coords.length<3?0:l(this._coords))},_internalCenterCalc:function(){!this._calcedCenter&&this._coords.length&&(this._calcedCenter=u(this._coords))},area:function(e){var t=r.extend({units:"sqmeters"},e);return this._internalAreaCalc(),r.isFunction(s[t.units])?s[t.units](this._calcedArea):void 0},center:function(){return this._internalCenterCalc(),this._options.imBackwards===!0?i(this._calcedCenter):this._calcedCenter}}},{"./constants":8,"./flipcoords":10,"./units":13,underscore:14}],8:[function(e,t,n){t.exports={EARTHRADIUS:6371e3}},{}],9:[function(e,t,n){var r=e("underscore"),a=e("./constants").EARTHRADIUS,o=e("./units"),i={meters:function(e){return e},kilometers:function(e){return o.meters.toKilometers(e)},feet:function(e){return o.meters.toFeet(e)},miles:function(e){return o.meters.toMiles(e)}},s=function(e,t){var n=o.degrees.toRadians(e[0]-t[0]),r=o.degrees.toRadians(e[1]-t[1]),i=o.degrees.toRadians(e[1]),s=o.degrees.toRadians(t[1]),l=Math.sin(n/2),u=Math.sin(r/2),c=u*u+l*l*Math.cos(i)*Math.cos(s);return 2*a*Math.atan2(Math.sqrt(c),Math.sqrt(1-c))};t.exports={_internalDistanceCalc:function(){var e,t,n=0;if(!this._calcedDistance){for(e=0,t=this._coords.length;t>e;e+=1)e>0&&(n+=s(this._coords[e-1],this._coords[e]));this._calcedDistance=n}},distance:function(e){var t=r.extend({units:"meters"},e);return this._internalDistanceCalc(),r.isFunction(i[t.units])?i[t.units](this._calcedDistance):void 0}}},{"./constants":8,"./units":13,underscore:14}],10:[function(e,t,n){var r=e("underscore");t.exports=function(e){return r.map(e,function(e){return[e[1],e[0]]})}},{underscore:14}],11:[function(e,t,n){var r=e("underscore"),a=e("./path"),o=e("./distance"),i=e("./area");r.extend(a.prototype,o,i),n.path=function(e,t){return new a(e,t)}},{"./area":7,"./distance":9,"./path":12,underscore:14}],12:[function(e,t,n){var r=e("./flipcoords"),a=function(e,t){this._options=t||{},e=e||[],this._coords=this._options.imBackwards===!0?r(e):e};t.exports=a},{"./flipcoords":10}],13:[function(e,t,n){n.meters={toFeet:function(e){return 3.28084*e},toKilometers:function(e){return.001*e},toMiles:function(e){return 621371e-9*e}},n.sqMeters={toSqMiles:function(e){return 3.86102e-7*e},toAcres:function(e){return 247105e-9*e},toHectares:function(e){return 1e-4*e}},n.degrees={toRadians:function(e){return e*Math.PI/180}}},{}],14:[function(e,t,n){(function(){var e=this,r=e._,a={},o=Array.prototype,i=Object.prototype,s=Function.prototype,l=o.push,u=o.slice,c=o.concat,d=i.toString,f=i.hasOwnProperty,p=o.forEach,h=o.map,m=o.reduce,g=o.reduceRight,v=o.filter,y=o.every,b=o.some,_=o.indexOf,x=o.lastIndexOf,L=Array.isArray,w=Object.keys,S=s.bind,k=function(e){return e instanceof k?e:this instanceof k?void(this._wrapped=e):new k(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=k),n._=k):e._=k,k.VERSION="1.5.2";var C=k.each=k.forEach=function(e,t,n){if(null!=e)if(p&&e.forEach===p)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,o=e.length;o>r;r++)if(t.call(n,e[r],r,e)===a)return}else for(var i=k.keys(e),r=0,o=i.length;o>r;r++)if(t.call(n,e[i[r]],i[r],e)===a)return};k.map=k.collect=function(e,t,n){var r=[];return null==e?r:h&&e.map===h?e.map(t,n):(C(e,function(e,a,o){r.push(t.call(n,e,a,o))}),r)};var j="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(e,t,n,r){var a=arguments.length>2;if(null==e&&(e=[]),m&&e.reduce===m)return r&&(t=k.bind(t,r)),a?e.reduce(t,n):e.reduce(t);if(C(e,function(e,o,i){a?n=t.call(r,n,e,o,i):(n=e,a=!0)}),!a)throw new TypeError(j);return n},k.reduceRight=k.foldr=function(e,t,n,r){var a=arguments.length>2;if(null==e&&(e=[]),g&&e.reduceRight===g)return r&&(t=k.bind(t,r)),a?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var i=k.keys(e);o=i.length}if(C(e,function(s,l,u){l=i?i[--o]:--o,a?n=t.call(r,n,e[l],l,u):(n=e[l],a=!0)}),!a)throw new TypeError(j);return n},k.find=k.detect=function(e,t,n){var r;return M(e,function(e,a,o){return t.call(n,e,a,o)?(r=e,!0):void 0}),r},k.filter=k.select=function(e,t,n){var r=[];return null==e?r:v&&e.filter===v?e.filter(t,n):(C(e,function(e,a,o){t.call(n,e,a,o)&&r.push(e)}),r)},k.reject=function(e,t,n){return k.filter(e,function(e,r,a){return!t.call(n,e,r,a)},n)},k.every=k.all=function(e,t,n){t||(t=k.identity);var r=!0;return null==e?r:y&&e.every===y?e.every(t,n):(C(e,function(e,o,i){return(r=r&&t.call(n,e,o,i))?void 0:a}),!!r)};var M=k.some=k.any=function(e,t,n){t||(t=k.identity);var r=!1;return null==e?r:b&&e.some===b?e.some(t,n):(C(e,function(e,o,i){return r||(r=t.call(n,e,o,i))?a:void 0}),!!r)};k.contains=k.include=function(e,t){return null==e?!1:_&&e.indexOf===_?-1!=e.indexOf(t):M(e,function(e){return e===t})},k.invoke=function(e,t){var n=u.call(arguments,2),r=k.isFunction(t);return k.map(e,function(e){return(r?t:e[t]).apply(e,n)})},k.pluck=function(e,t){return k.map(e,function(e){return e[t]})},k.where=function(e,t,n){return k.isEmpty(t)?n?void 0:[]:k[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},k.findWhere=function(e,t){return k.where(e,t,!0)},k.max=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&k.isEmpty(e))return-(1/0);var r={computed:-(1/0),value:-(1/0)};return C(e,function(e,a,o){var i=t?t.call(n,e,a,o):e;i>r.computed&&(r={value:e,computed:i})}),r.value},k.min=function(e,t,n){if(!t&&k.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&k.isEmpty(e))return 1/0;var r={computed:1/0,value:1/0};return C(e,function(e,a,o){var i=t?t.call(n,e,a,o):e;i<r.computed&&(r={value:e,computed:i})}),r.value},k.shuffle=function(e){var t,n=0,r=[];return C(e,function(e){t=k.random(n++),r[n-1]=r[t],r[t]=e}),r},k.sample=function(e,t,n){return arguments.length<2||n?e[k.random(e.length-1)]:k.shuffle(e).slice(0,Math.max(0,t))};var T=function(e){return k.isFunction(e)?e:function(t){return t[e]}};k.sortBy=function(e,t,n){var r=T(t);return k.pluck(k.map(e,function(e,t,a){return{value:e,index:t,criteria:r.call(n,e,t,a)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var A=function(e){return function(t,n,r){var a={},o=null==n?k.identity:T(n);return C(t,function(n,i){var s=o.call(r,n,i,t);e(a,s,n)}),a}};k.groupBy=A(function(e,t,n){(k.has(e,t)?e[t]:e[t]=[]).push(n)}),k.indexBy=A(function(e,t,n){e[t]=n}),k.countBy=A(function(e,t){k.has(e,t)?e[t]++:e[t]=1}),k.sortedIndex=function(e,t,n,r){n=null==n?k.identity:T(n);for(var a=n.call(r,t),o=0,i=e.length;i>o;){var s=o+i>>>1;n.call(r,e[s])<a?o=s+1:i=s}return o},k.toArray=function(e){return e?k.isArray(e)?u.call(e):e.length===+e.length?k.map(e,k.identity):k.values(e):[]},k.size=function(e){return null==e?0:e.length===+e.length?e.length:k.keys(e).length},k.first=k.head=k.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:u.call(e,0,t)},k.initial=function(e,t,n){return u.call(e,0,e.length-(null==t||n?1:t))},k.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},k.rest=k.tail=k.drop=function(e,t,n){return u.call(e,null==t||n?1:t)},k.compact=function(e){return k.filter(e,k.identity)};var D=function(e,t,n){return t&&k.every(e,k.isArray)?c.apply(n,e):(C(e,function(e){k.isArray(e)||k.isArguments(e)?t?l.apply(n,e):D(e,t,n):n.push(e)}),n)};k.flatten=function(e,t){return D(e,t,[])},k.without=function(e){return k.difference(e,u.call(arguments,1))},k.uniq=k.unique=function(e,t,n,r){k.isFunction(t)&&(r=n,n=t,t=!1);var a=n?k.map(e,n,r):e,o=[],i=[];return C(a,function(n,r){(t?r&&i[i.length-1]===n:k.contains(i,n))||(i.push(n),o.push(e[r]))}),o},k.union=function(){return k.uniq(k.flatten(arguments,!0))},k.intersection=function(e){var t=u.call(arguments,1);return k.filter(k.uniq(e),function(e){return k.every(t,function(t){return k.indexOf(t,e)>=0})})},k.difference=function(e){var t=c.apply(o,u.call(arguments,1));return k.filter(e,function(e){return!k.contains(t,e)})},k.zip=function(){for(var e=k.max(k.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;e>n;n++)t[n]=k.pluck(arguments,""+n);return t},k.object=function(e,t){if(null==e)return{};for(var n={},r=0,a=e.length;a>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},k.indexOf=function(e,t,n){if(null==e)return-1;var r=0,a=e.length;if(n){if("number"!=typeof n)return r=k.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,a+n):n}if(_&&e.indexOf===_)return e.indexOf(t,n);for(;a>r;r++)if(e[r]===t)return r;return-1},k.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=null!=n;if(x&&e.lastIndexOf===x)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var a=r?n:e.length;a--;)if(e[a]===t)return a;return-1},k.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((t-e)/n),0),a=0,o=new Array(r);r>a;)o[a++]=e,e+=n;return o};var E=function(){};k.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!k.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(u.call(arguments)));E.prototype=e.prototype;var a=new E;E.prototype=null;var o=e.apply(a,n.concat(u.call(arguments)));return Object(o)===o?o:a}},k.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},k.bindAll=function(e){var t=u.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return C(t,function(t){e[t]=k.bind(e[t],e)}),e},k.memoize=function(e,t){var n={};return t||(t=k.identity),function(){var r=t.apply(this,arguments);return k.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},k.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},k.defer=function(e){return k.delay.apply(k,[e,1].concat(u.call(arguments,1)))},k.throttle=function(e,t,n){var r,a,o,i=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:new Date,i=null,o=e.apply(r,a)};return function(){var u=new Date;s||n.leading!==!1||(s=u);var c=t-(u-s);return r=this,a=arguments,0>=c?(clearTimeout(i),i=null,s=u,o=e.apply(r,a)):i||n.trailing===!1||(i=setTimeout(l,c)),o}},k.debounce=function(e,t,n){var r,a,o,i,s;return function(){o=this,a=arguments,i=new Date;var l=function(){var u=new Date-i;t>u?r=setTimeout(l,t-u):(r=null,n||(s=e.apply(o,a)))},u=n&&!r;return r||(r=setTimeout(l,t)),u&&(s=e.apply(o,a)),s}},k.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},k.wrap=function(e,t){return function(){var n=[e];return l.apply(n,arguments),t.apply(this,n)}},k.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},k.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},k.keys=w||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)k.has(e,n)&&t.push(n);return t},k.values=function(e){for(var t=k.keys(e),n=t.length,r=new Array(n),a=0;n>a;a++)r[a]=e[t[a]];return r},k.pairs=function(e){for(var t=k.keys(e),n=t.length,r=new Array(n),a=0;n>a;a++)r[a]=[t[a],e[t[a]]];return r},k.invert=function(e){for(var t={},n=k.keys(e),r=0,a=n.length;a>r;r++)t[e[n[r]]]=n[r];return t},k.functions=k.methods=function(e){var t=[];for(var n in e)k.isFunction(e[n])&&t.push(n);return t.sort()},k.extend=function(e){return C(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},k.pick=function(e){var t={},n=c.apply(o,u.call(arguments,1));return C(n,function(n){n in e&&(t[n]=e[n])}),t},k.omit=function(e){var t={},n=c.apply(o,u.call(arguments,1));for(var r in e)k.contains(n,r)||(t[r]=e[r]);return t},k.defaults=function(e){return C(u.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},k.clone=function(e){return k.isObject(e)?k.isArray(e)?e.slice():k.extend({},e):e},k.tap=function(e,t){return t(e),e};var I=function(e,t,n,r){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return e===t;e instanceof k&&(e=e._wrapped),t instanceof k&&(t=t._wrapped);var a=d.call(e);if(a!=d.call(t))return!1;switch(a){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]==e)return r[o]==t;var i=e.constructor,s=t.constructor;if(i!==s&&!(k.isFunction(i)&&i instanceof i&&k.isFunction(s)&&s instanceof s))return!1;n.push(e),r.push(t);var l=0,u=!0;if("[object Array]"==a){if(l=e.length,u=l==t.length)for(;l--&&(u=I(e[l],t[l],n,r)););}else{for(var c in e)if(k.has(e,c)&&(l++,!(u=k.has(t,c)&&I(e[c],t[c],n,r))))break;if(u){for(c in t)if(k.has(t,c)&&!l--)break;u=!l}}return n.pop(),r.pop(),u};k.isEqual=function(e,t){return I(e,t,[],[])},k.isEmpty=function(e){if(null==e)return!0;if(k.isArray(e)||k.isString(e))return 0===e.length;for(var t in e)if(k.has(e,t))return!1;return!0},k.isElement=function(e){return!(!e||1!==e.nodeType)},k.isArray=L||function(e){return"[object Array]"==d.call(e)},k.isObject=function(e){return e===Object(e)},C(["Arguments","Function","String","Number","Date","RegExp"],function(e){k["is"+e]=function(t){return d.call(t)=="[object "+e+"]"}}),k.isArguments(arguments)||(k.isArguments=function(e){return!(!e||!k.has(e,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(e){return"function"==typeof e}),k.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},k.isNaN=function(e){return k.isNumber(e)&&e!=+e},k.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==d.call(e)},k.isNull=function(e){return null===e},k.isUndefined=function(e){return void 0===e},k.has=function(e,t){return f.call(e,t)},k.noConflict=function(){return e._=r,this},k.identity=function(e){return e},k.times=function(e,t,n){for(var r=Array(Math.max(0,e)),a=0;e>a;a++)r[a]=t.call(n,a);return r},k.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};O.unescape=k.invert(O.escape);var N={escape:new RegExp("["+k.keys(O.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(O.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(e){k[e]=function(t){return null==t?"":(""+t).replace(N[e],function(t){return O[e][t]})}}),k.result=function(e,t){if(null==e)return void 0;var n=e[t];return k.isFunction(n)?n.call(e):n},k.mixin=function(e){C(k.functions(e),function(t){var n=k[t]=e[t];k.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),F.call(this,n.apply(k,e))}})};var P=0;k.uniqueId=function(e){var t=++P+"";return e?e+t:t},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var R=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(e,t,n){var r;n=k.defaults({},n,k.templateSettings);var a=new RegExp([(n.escape||R).source,(n.interpolate||R).source,(n.evaluate||R).source].join("|")+"|$","g"),o=0,i="__p+='";e.replace(a,function(t,n,r,a,s){return i+=e.slice(o,s).replace(B,function(e){return"\\"+G[e]}),n&&(i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(i+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),a&&(i+="';\n"+a+"\n__p+='"),o=s+t.length,t}),i+="';\n",n.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{r=new Function(n.variable||"obj","_",i)}catch(s){throw s.source=i,s}if(t)return r(t,k);var l=function(e){return r.call(this,e,k)};return l.source="function("+(n.variable||"obj")+"){\n"+i+"}",l},k.chain=function(e){return k(e).chain()};var F=function(e){return this._chain?k(e).chain():e};k.mixin(k),C(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=o[e];k.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],F.call(this,n)}}),C(["concat","join","slice"],function(e){var t=o[e];k.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},{}],15:[function(e,t,n){(function(){var e=this,r=e.humanize,a={};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=a),n.humanize=a):("function"==typeof define&&define.amd&&define("humanize",function(){return a}),e.humanize=a),a.noConflict=function(){return e.humanize=r,this},a.pad=function(e,t,n,r){if(e+="",n?n.length>1&&(n=n.charAt(0)):n=" ",r=void 0===r?"left":"right","right"===r)for(;e.length<t;)e+=n;else for(;e.length<t;)e=n+e;return e},a.time=function(){return(new Date).getTime()/1e3};var o=[0,0,31,59,90,120,151,181,212,243,273,304,334],i=[0,0,31,60,91,121,152,182,213,244,274,305,335];a.date=function(e,t){var n=void 0===t?new Date:new Date(t instanceof Date?t:1e3*t),r=/\\?([a-z])/gi,s=function(e,t){return c[e]?c[e]():t},l=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],u=["January","February","March","April","May","June","July","August","September","October","November","December"],c={d:function(){return a.pad(c.j(),2,"0")},D:function(){return c.l().slice(0,3)},j:function(){return n.getDate()},l:function(){return l[c.w()]},N:function(){return c.w()||7},S:function(){var e=c.j();return e>4&&21>e?"th":{1:"st",2:"nd",3:"rd"}[e%10]||"th"},w:function(){return n.getDay()},z:function(){return(c.L()?i[c.n()]:o[c.n()])+c.j()-1},W:function(){var e=c.z()-c.N()+1.5;return a.pad(1+Math.floor(Math.abs(e)/7)+(e%7>3.5?1:0),2,"0")},F:function(){return u[n.getMonth()]},m:function(){return a.pad(c.n(),2,"0")},M:function(){return c.F().slice(0,3)},n:function(){return n.getMonth()+1},t:function(){return new Date(c.Y(),c.n(),0).getDate()},L:function(){return 1===new Date(c.Y(),1,29).getMonth()?1:0},o:function(){var e=c.n(),t=c.W();return c.Y()+(12===e&&9>t?-1:1===e&&t>9)},Y:function(){return n.getFullYear()},y:function(){return String(c.Y()).slice(-2)},a:function(){return n.getHours()>11?"pm":"am"},A:function(){return c.a().toUpperCase()},B:function(){var e=n.getTime()/1e3,t=e%86400+3600;0>t&&(t+=86400);var r=t/86.4%1e3;return 0>e?Math.ceil(r):Math.floor(r)},g:function(){return c.G()%12||12},G:function(){return n.getHours()},h:function(){return a.pad(c.g(),2,"0")},H:function(){return a.pad(c.G(),2,"0")},i:function(){return a.pad(n.getMinutes(),2,"0")},s:function(){return a.pad(n.getSeconds(),2,"0")},u:function(){return a.pad(1e3*n.getMilliseconds(),6,"0")},O:function(){var e=n.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+a.pad(100*Math.floor(t/60)+t%60,4,"0")},P:function(){var e=c.O();return e.substr(0,3)+":"+e.substr(3,2)},Z:function(){return 60*-n.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(r,s)},r:function(){return"D, d M Y H:i:s O".replace(r,s)},U:function(){return n.getTime()/1e3||0}};return e.replace(r,s)},a.numberFormat=function(e,t,n,r){t=isNaN(t)?2:Math.abs(t),n=void 0===n?".":n,r=void 0===r?",":r;var a=0>e?"-":"";e=Math.abs(+e||0);var o=parseInt(e.toFixed(t),10)+"",i=o.length>3?o.length%3:0;return a+(i?o.substr(0,i)+r:"")+o.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+r)+(t?n+Math.abs(e-o).toFixed(t).slice(2):"")},a.naturalDay=function(e,t){e=void 0===e?a.time():e,t=void 0===t?"Y-m-d":t;var n=86400,r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime()/1e3;return o>e&&e>=o-n?"yesterday":e>=o&&o+n>e?"today":e>=o+n&&o+2*n>e?"tomorrow":a.date(t,e)},a.relativeTime=function(e){e=void 0===e?a.time():e;var t=a.time(),n=t-e;if(2>n&&n>-2)return(n>=0?"just ":"")+"now";if(60>n&&n>-60)return n>=0?Math.floor(n)+" seconds ago":"in "+Math.floor(-n)+" seconds";if(120>n&&n>-120)return n>=0?"about a minute ago":"in about a minute";if(3600>n&&n>-3600)return n>=0?Math.floor(n/60)+" minutes ago":"in "+Math.floor(-n/60)+" minutes";if(7200>n&&n>-7200)return n>=0?"about an hour ago":"in about an hour";if(86400>n&&n>-86400)return n>=0?Math.floor(n/3600)+" hours ago":"in "+Math.floor(-n/3600)+" hours";var r=172800;if(r>n&&n>-r)return n>=0?"1 day ago":"in 1 day";var o=2505600;if(o>n&&n>-o)return n>=0?Math.floor(n/86400)+" days ago":"in "+Math.floor(-n/86400)+" days";var i=5184e3;if(i>n&&n>-i)return n>=0?"about a month ago":"in about a month";var s=parseInt(a.date("Y",t),10),l=parseInt(a.date("Y",e),10),u=12*s+parseInt(a.date("n",t),10),c=12*l+parseInt(a.date("n",e),10),d=u-c;if(12>d&&d>-12)return d>=0?d+" months ago":"in "+-d+" months";var f=s-l;return 2>f&&f>-2?f>=0?"a year ago":"in a year":f>=0?f+" years ago":"in "+-f+" years"},a.ordinal=function(e){e=parseInt(e,10),e=isNaN(e)?0:e;var t=0>e?"-":"";e=Math.abs(e);var n=e%100;return t+e+(n>4&&21>n?"th":{1:"st",2:"nd",3:"rd"}[e%10]||"th")},a.filesize=function(e,t,n,r,o,i){return t=void 0===t?1024:t,0>=e?"0 bytes":(t>e&&void 0===n&&(n=0),void 0===i&&(i=" "),a.intword(e,["bytes","KB","MB","GB","TB","PB"],t,n,r,o,i))},a.intword=function(e,t,n,r,o,i,s){var l,u;t=t||["","K","M","B","T"],u=t.length-1,n=n||1e3,r=isNaN(r)?2:Math.abs(r),o=o||".",i=i||",",s=s||"";for(var c=0;c<t.length;c++)if(e<Math.pow(n,c+1)){u=c;break}l=e/Math.pow(n,u);var d=t[u]?s+t[u]:"";return a.numberFormat(l,r,o,i)+d},a.linebreaks=function(e){return e=e.replace(/^([\n|\r]*)/,""),e=e.replace(/([\n|\r]*)$/,""),e=e.replace(/(\r\n|\n|\r)/g,"\n"),e=e.replace(/(\n{2,})/g,"</p><p>"),e=e.replace(/\n/g,"<br />"),"<p>"+e+"</p>"},a.nl2br=function(e){return e.replace(/(\r\n|\n|\r)/g,"<br />")},a.truncatechars=function(e,t){return e.length<=t?e:e.substr(0,t)+"…"},a.truncatewords=function(e,t){var n=e.split(" ");return n.length<t?e:n.slice(0,t).join(" ")+"…"}}).call(this)},{}],16:[function(e,t,n){(function(){var e=this,r=e._,a=Array.prototype,o=Object.prototype,i=Function.prototype,s=a.push,l=a.slice,u=a.concat,c=o.toString,d=o.hasOwnProperty,f=Array.isArray,p=Object.keys,h=i.bind,m=function(e){return e instanceof m?e:this instanceof m?void(this._wrapped=e):new m(e)};"undefined"!=typeof n?("undefined"!=typeof t&&t.exports&&(n=t.exports=m),n._=m):e._=m,m.VERSION="1.7.0";var g=function(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,a){return e.call(t,n,r,a)};case 4:return function(n,r,a,o){return e.call(t,n,r,a,o)}}return function(){return e.apply(t,arguments)}};m.iteratee=function(e,t,n){return null==e?m.identity:m.isFunction(e)?g(e,t,n):m.isObject(e)?m.matches(e):m.property(e)},m.each=m.forEach=function(e,t,n){if(null==e)return e;t=g(t,n);var r,a=e.length;if(a===+a)for(r=0;a>r;r++)t(e[r],r,e);else{var o=m.keys(e);for(r=0,a=o.length;a>r;r++)t(e[o[r]],o[r],e)}return e},m.map=m.collect=function(e,t,n){if(null==e)return[];t=m.iteratee(t,n);for(var r,a=e.length!==+e.length&&m.keys(e),o=(a||e).length,i=Array(o),s=0;o>s;s++)r=a?a[s]:s,i[s]=t(e[r],r,e);return i};var v="Reduce of empty array with no initial value";m.reduce=m.foldl=m.inject=function(e,t,n,r){null==e&&(e=[]),t=g(t,r,4);var a,o=e.length!==+e.length&&m.keys(e),i=(o||e).length,s=0;if(arguments.length<3){if(!i)throw new TypeError(v);n=e[o?o[s++]:s++]}for(;i>s;s++)a=o?o[s]:s,n=t(n,e[a],a,e);return n},m.reduceRight=m.foldr=function(e,t,n,r){null==e&&(e=[]),t=g(t,r,4);var a,o=e.length!==+e.length&&m.keys(e),i=(o||e).length;if(arguments.length<3){if(!i)throw new TypeError(v);n=e[o?o[--i]:--i]}for(;i--;)a=o?o[i]:i,n=t(n,e[a],a,e);return n},m.find=m.detect=function(e,t,n){var r;return t=m.iteratee(t,n),m.some(e,function(e,n,a){return t(e,n,a)?(r=e,!0):void 0}),r},m.filter=m.select=function(e,t,n){var r=[];return null==e?r:(t=m.iteratee(t,n),m.each(e,function(e,n,a){t(e,n,a)&&r.push(e)}),r)},m.reject=function(e,t,n){return m.filter(e,m.negate(m.iteratee(t)),n)},m.every=m.all=function(e,t,n){if(null==e)return!0;t=m.iteratee(t,n);var r,a,o=e.length!==+e.length&&m.keys(e),i=(o||e).length;for(r=0;i>r;r++)if(a=o?o[r]:r,!t(e[a],a,e))return!1;return!0},m.some=m.any=function(e,t,n){if(null==e)return!1;t=m.iteratee(t,n);var r,a,o=e.length!==+e.length&&m.keys(e),i=(o||e).length;for(r=0;i>r;r++)if(a=o?o[r]:r,t(e[a],a,e))return!0;return!1},m.contains=m.include=function(e,t){return null==e?!1:(e.length!==+e.length&&(e=m.values(e)),m.indexOf(e,t)>=0)},m.invoke=function(e,t){var n=l.call(arguments,2),r=m.isFunction(t);return m.map(e,function(e){return(r?t:e[t]).apply(e,n)})},m.pluck=function(e,t){return m.map(e,m.property(t))},m.where=function(e,t){return m.filter(e,m.matches(t))},m.findWhere=function(e,t){return m.find(e,m.matches(t))},m.max=function(e,t,n){var r,a,o=-(1/0),i=-(1/0);if(null==t&&null!=e){e=e.length===+e.length?e:m.values(e);for(var s=0,l=e.length;l>s;s++)r=e[s],r>o&&(o=r)}else t=m.iteratee(t,n),m.each(e,function(e,n,r){a=t(e,n,r),(a>i||a===-(1/0)&&o===-(1/0))&&(o=e,i=a)});return o},m.min=function(e,t,n){var r,a,o=1/0,i=1/0;if(null==t&&null!=e){e=e.length===+e.length?e:m.values(e);for(var s=0,l=e.length;l>s;s++)r=e[s],o>r&&(o=r)}else t=m.iteratee(t,n),m.each(e,function(e,n,r){a=t(e,n,r),(i>a||a===1/0&&o===1/0)&&(o=e,i=a)});return o},m.shuffle=function(e){for(var t,n=e&&e.length===+e.length?e:m.values(e),r=n.length,a=Array(r),o=0;r>o;o++)t=m.random(0,o),t!==o&&(a[o]=a[t]),a[t]=n[o];return a},m.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=m.values(e)),e[m.random(e.length-1)]):m.shuffle(e).slice(0,Math.max(0,t))},m.sortBy=function(e,t,n){return t=m.iteratee(t,n),m.pluck(m.map(e,function(e,n,r){return{value:e,index:n,criteria:t(e,n,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return e.index-t.index}),"value")};var y=function(e){return function(t,n,r){var a={};return n=m.iteratee(n,r),m.each(t,function(r,o){var i=n(r,o,t);e(a,r,i)}),a}};m.groupBy=y(function(e,t,n){m.has(e,n)?e[n].push(t):e[n]=[t]}),m.indexBy=y(function(e,t,n){e[n]=t}),m.countBy=y(function(e,t,n){m.has(e,n)?e[n]++:e[n]=1}),m.sortedIndex=function(e,t,n,r){n=m.iteratee(n,r,1);for(var a=n(t),o=0,i=e.length;i>o;){var s=o+i>>>1;n(e[s])<a?o=s+1:i=s}return o},m.toArray=function(e){return e?m.isArray(e)?l.call(e):e.length===+e.length?m.map(e,m.identity):m.values(e):[]},m.size=function(e){return null==e?0:e.length===+e.length?e.length:m.keys(e).length},m.partition=function(e,t,n){t=m.iteratee(t,n);var r=[],a=[];return m.each(e,function(e,n,o){(t(e,n,o)?r:a).push(e)}),[r,a]},m.first=m.head=m.take=function(e,t,n){return null==e?void 0:null==t||n?e[0]:0>t?[]:l.call(e,0,t)},m.initial=function(e,t,n){return l.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))},m.last=function(e,t,n){return null==e?void 0:null==t||n?e[e.length-1]:l.call(e,Math.max(e.length-t,0))},m.rest=m.tail=m.drop=function(e,t,n){return l.call(e,null==t||n?1:t)},m.compact=function(e){return m.filter(e,m.identity)};var b=function(e,t,n,r){if(t&&m.every(e,m.isArray))return u.apply(r,e);for(var a=0,o=e.length;o>a;a++){var i=e[a];m.isArray(i)||m.isArguments(i)?t?s.apply(r,i):b(i,t,n,r):n||r.push(i)}return r};m.flatten=function(e,t){return b(e,t,!1,[])},m.without=function(e){return m.difference(e,l.call(arguments,1))},m.uniq=m.unique=function(e,t,n,r){if(null==e)return[];m.isBoolean(t)||(r=n,n=t,t=!1),null!=n&&(n=m.iteratee(n,r));for(var a=[],o=[],i=0,s=e.length;s>i;i++){var l=e[i];if(t)i&&o===l||a.push(l),o=l;else if(n){var u=n(l,i,e);m.indexOf(o,u)<0&&(o.push(u),a.push(l))}else m.indexOf(a,l)<0&&a.push(l)}return a},m.union=function(){return m.uniq(b(arguments,!0,!0,[]))},m.intersection=function(e){if(null==e)return[];for(var t=[],n=arguments.length,r=0,a=e.length;a>r;r++){var o=e[r];if(!m.contains(t,o)){for(var i=1;n>i&&m.contains(arguments[i],o);i++);i===n&&t.push(o)}}return t},m.difference=function(e){var t=b(l.call(arguments,1),!0,!0,[]);return m.filter(e,function(e){return!m.contains(t,e)})},m.zip=function(e){if(null==e)return[];for(var t=m.max(arguments,"length").length,n=Array(t),r=0;t>r;r++)n[r]=m.pluck(arguments,r);return n},m.object=function(e,t){if(null==e)return{};for(var n={},r=0,a=e.length;a>r;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},m.indexOf=function(e,t,n){if(null==e)return-1;var r=0,a=e.length;if(n){if("number"!=typeof n)return r=m.sortedIndex(e,t),e[r]===t?r:-1;r=0>n?Math.max(0,a+n):n}for(;a>r;r++)if(e[r]===t)return r;return-1},m.lastIndexOf=function(e,t,n){if(null==e)return-1;var r=e.length;for("number"==typeof n&&(r=0>n?r+n+1:Math.min(r,n+1));--r>=0;)if(e[r]===t)return r;return-1},m.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=n||1;for(var r=Math.max(Math.ceil((t-e)/n),0),a=Array(r),o=0;r>o;o++,e+=n)a[o]=e;return a};var _=function(){};m.bind=function(e,t){var n,r;if(h&&e.bind===h)return h.apply(e,l.call(arguments,1));if(!m.isFunction(e))throw new TypeError("Bind must be called on a function");return n=l.call(arguments,2),r=function(){if(!(this instanceof r))return e.apply(t,n.concat(l.call(arguments)));_.prototype=e.prototype;var a=new _;_.prototype=null;var o=e.apply(a,n.concat(l.call(arguments)));return m.isObject(o)?o:a}},m.partial=function(e){var t=l.call(arguments,1);return function(){for(var n=0,r=t.slice(),a=0,o=r.length;o>a;a++)r[a]===m&&(r[a]=arguments[n++]);for(;n<arguments.length;)r.push(arguments[n++]);return e.apply(this,r)}},m.bindAll=function(e){var t,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(t=1;r>t;t++)n=arguments[t],e[n]=m.bind(e[n],e);return e},m.memoize=function(e,t){var n=function(r){var a=n.cache,o=t?t.apply(this,arguments):r;return m.has(a,o)||(a[o]=e.apply(this,arguments)),a[o]};return n.cache={},n},m.delay=function(e,t){var n=l.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},m.defer=function(e){return m.delay.apply(m,[e,1].concat(l.call(arguments,1)))},m.throttle=function(e,t,n){var r,a,o,i=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:m.now(),i=null,o=e.apply(r,a),i||(r=a=null)};return function(){var u=m.now();s||n.leading!==!1||(s=u);var c=t-(u-s);return r=this,a=arguments,0>=c||c>t?(clearTimeout(i),i=null,s=u,o=e.apply(r,a),i||(r=a=null)):i||n.trailing===!1||(i=setTimeout(l,c)),o}},m.debounce=function(e,t,n){var r,a,o,i,s,l=function(){var u=m.now()-i;t>u&&u>0?r=setTimeout(l,t-u):(r=null,n||(s=e.apply(o,a),r||(o=a=null)))};return function(){o=this,a=arguments,i=m.now();var u=n&&!r;return r||(r=setTimeout(l,t)),u&&(s=e.apply(o,a),o=a=null),s}},m.wrap=function(e,t){return m.partial(t,e)},m.negate=function(e){return function(){return!e.apply(this,arguments)}},m.compose=function(){var e=arguments,t=e.length-1;return function(){for(var n=t,r=e[t].apply(this,arguments);n--;)r=e[n].call(this,r);return r}},m.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0;

}},m.before=function(e,t){var n;return function(){return--e>0?n=t.apply(this,arguments):t=null,n}},m.once=m.partial(m.before,2),m.keys=function(e){if(!m.isObject(e))return[];if(p)return p(e);var t=[];for(var n in e)m.has(e,n)&&t.push(n);return t},m.values=function(e){for(var t=m.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=e[t[a]];return r},m.pairs=function(e){for(var t=m.keys(e),n=t.length,r=Array(n),a=0;n>a;a++)r[a]=[t[a],e[t[a]]];return r},m.invert=function(e){for(var t={},n=m.keys(e),r=0,a=n.length;a>r;r++)t[e[n[r]]]=n[r];return t},m.functions=m.methods=function(e){var t=[];for(var n in e)m.isFunction(e[n])&&t.push(n);return t.sort()},m.extend=function(e){if(!m.isObject(e))return e;for(var t,n,r=1,a=arguments.length;a>r;r++){t=arguments[r];for(n in t)d.call(t,n)&&(e[n]=t[n])}return e},m.pick=function(e,t,n){var r,a={};if(null==e)return a;if(m.isFunction(t)){t=g(t,n);for(r in e){var o=e[r];t(o,r,e)&&(a[r]=o)}}else{var i=u.apply([],l.call(arguments,1));e=new Object(e);for(var s=0,c=i.length;c>s;s++)r=i[s],r in e&&(a[r]=e[r])}return a},m.omit=function(e,t,n){if(m.isFunction(t))t=m.negate(t);else{var r=m.map(u.apply([],l.call(arguments,1)),String);t=function(e,t){return!m.contains(r,t)}}return m.pick(e,t,n)},m.defaults=function(e){if(!m.isObject(e))return e;for(var t=1,n=arguments.length;n>t;t++){var r=arguments[t];for(var a in r)void 0===e[a]&&(e[a]=r[a])}return e},m.clone=function(e){return m.isObject(e)?m.isArray(e)?e.slice():m.extend({},e):e},m.tap=function(e,t){return t(e),e};var x=function(e,t,n,r){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return e===t;e instanceof m&&(e=e._wrapped),t instanceof m&&(t=t._wrapped);var a=c.call(e);if(a!==c.call(t))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t}if("object"!=typeof e||"object"!=typeof t)return!1;for(var o=n.length;o--;)if(n[o]===e)return r[o]===t;var i=e.constructor,s=t.constructor;if(i!==s&&"constructor"in e&&"constructor"in t&&!(m.isFunction(i)&&i instanceof i&&m.isFunction(s)&&s instanceof s))return!1;n.push(e),r.push(t);var l,u;if("[object Array]"===a){if(l=e.length,u=l===t.length)for(;l--&&(u=x(e[l],t[l],n,r)););}else{var d,f=m.keys(e);if(l=f.length,u=m.keys(t).length===l)for(;l--&&(d=f[l],u=m.has(t,d)&&x(e[d],t[d],n,r)););}return n.pop(),r.pop(),u};m.isEqual=function(e,t){return x(e,t,[],[])},m.isEmpty=function(e){if(null==e)return!0;if(m.isArray(e)||m.isString(e)||m.isArguments(e))return 0===e.length;for(var t in e)if(m.has(e,t))return!1;return!0},m.isElement=function(e){return!(!e||1!==e.nodeType)},m.isArray=f||function(e){return"[object Array]"===c.call(e)},m.isObject=function(e){var t=typeof e;return"function"===t||"object"===t&&!!e},m.each(["Arguments","Function","String","Number","Date","RegExp"],function(e){m["is"+e]=function(t){return c.call(t)==="[object "+e+"]"}}),m.isArguments(arguments)||(m.isArguments=function(e){return m.has(e,"callee")}),"function"!=typeof/ . /&&(m.isFunction=function(e){return"function"==typeof e||!1}),m.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},m.isNaN=function(e){return m.isNumber(e)&&e!==+e},m.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"===c.call(e)},m.isNull=function(e){return null===e},m.isUndefined=function(e){return void 0===e},m.has=function(e,t){return null!=e&&d.call(e,t)},m.noConflict=function(){return e._=r,this},m.identity=function(e){return e},m.constant=function(e){return function(){return e}},m.noop=function(){},m.property=function(e){return function(t){return t[e]}},m.matches=function(e){var t=m.pairs(e),n=t.length;return function(e){if(null==e)return!n;e=new Object(e);for(var r=0;n>r;r++){var a=t[r],o=a[0];if(a[1]!==e[o]||!(o in e))return!1}return!0}},m.times=function(e,t,n){var r=Array(Math.max(0,e));t=g(t,n,1);for(var a=0;e>a;a++)r[a]=t(a);return r},m.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},m.now=Date.now||function(){return(new Date).getTime()};var L={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},w=m.invert(L),S=function(e){var t=function(t){return e[t]},n="(?:"+m.keys(e).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(e){return e=null==e?"":""+e,r.test(e)?e.replace(a,t):e}};m.escape=S(L),m.unescape=S(w),m.result=function(e,t){if(null==e)return void 0;var n=e[t];return m.isFunction(n)?e[t]():n};var k=0;m.uniqueId=function(e){var t=++k+"";return e?e+t:t},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},M=/\\|'|\r|\n|\u2028|\u2029/g,T=function(e){return"\\"+j[e]};m.template=function(e,t,n){!t&&n&&(t=n),t=m.defaults({},t,m.templateSettings);var r=RegExp([(t.escape||C).source,(t.interpolate||C).source,(t.evaluate||C).source].join("|")+"|$","g"),a=0,o="__p+='";e.replace(r,function(t,n,r,i,s){return o+=e.slice(a,s).replace(M,T),a=s+t.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(o+="';\n"+i+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var i=new Function(t.variable||"obj","_",o)}catch(s){throw s.source=o,s}var l=function(e){return i.call(this,e,m)},u=t.variable||"obj";return l.source="function("+u+"){\n"+o+"}",l},m.chain=function(e){var t=m(e);return t._chain=!0,t};var A=function(e){return this._chain?m(e).chain():e};m.mixin=function(e){m.each(m.functions(e),function(t){var n=m[t]=e[t];m.prototype[t]=function(){var e=[this._wrapped];return s.apply(e,arguments),A.call(this,n.apply(m,e))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=a[e];m.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0],A.call(this,n)}}),m.each(["concat","join","slice"],function(e){var t=a[e];m.prototype[e]=function(){return A.call(this,t.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this)},{}],17:[function(e,t,n){var r=e("underscore"),a=e("geocrunch"),o=function(e){return 10>e?"0"+e.toString():e.toString()},i=function(e,t,n){var r=Math.abs(e),a=Math.floor(r),i=Math.floor(60*(r-a)),s=Math.round(3600*(r-a-i/60)*100)/100,l=r===e?t:n;return o(a)+"&deg; "+o(i)+"' "+o(s)+'" '+l},s=function(e){var t=r.last(e),n=a.path(r.map(e,function(e){return[e.lng,e.lat]}));return{lastCoord:{dd:{x:t.lng,y:t.lat},dms:{x:i(t.lng,"E","W"),y:i(t.lat,"N","S")}},length:{feet:n.distance({units:"feet"}),miles:n.distance({units:"miles"}),meters:n.distance({units:"meters"}),kilometers:n.distance({units:"kilometers"})},area:{acres:n.area({units:"acres"}),sqmeters:n.area({units:"sqmeters"}),hectares:n.area({units:"hectares"})}}};t.exports={measure:s}},{geocrunch:6,underscore:16}],18:[function(e,t,n){var r=function(e,t){return t||(t=document),t.querySelector(e)},a=function(e,t){return t||(t=document),Array.prototype.slice.call(t.querySelectorAll(e))},o=function(e){return e?(e.setAttribute("style","display:none;"),e):void 0},i=function(e){return e?(e.removeAttribute("style"),e):void 0};t.exports={$:r,$$:a,hide:o,show:i}},{}],19:[function(e,t,n){(function(t){var n,r,a,o,i,s=e("underscore"),l="undefined"!=typeof window?window.L:"undefined"!=typeof t?t.L:null,u=e("humanize"),c=e("./calc"),d=e("./dom"),f=d.$,p=e("./mapsymbology");l.Control.Measure=l.Control.extend({_className:"leaflet-control-measure",options:{position:"topright",activeColor:"#ABE67E",completedColor:"#C8F2BE",popupOptions:{className:"leaflet-measure-resultpopup",autoPanPadding:[10,10]},title:"Measure distances and areas",start:"Create a new measurement",addpoint:"Start creating a measurement by adding points to the map",cancel:"Cancel",finish:"Finish Measurement",lastpoint:"Last Point",pathdistance:"Path Distance",meters:"Meters",kilometers:"Kilometers",area:"Area",acres:"Acres",sqmeters:"square meters",hectares:"Hectares",pointlocation:"Point Location",centerlocation:"Center on this Location","delete":"Delete",linearmesurement:"Linear Measurement",areamesurement:"Area Measurement",perimeter:"Perimeter",thousandsep:"'",decsep:"."},initialize:function(e){n=s.template('<a class="<%= model.className %>-toggle js-toggle" href="#" title="\'+options.title+\'"></a>\n<div class="<%= model.className %>-interaction js-interaction">\n  <div class="js-startprompt startprompt">\n<ul class="tasks">\n      <a href="#" class="js-start start">'+e.start+'</a>\n    </ul>\n  </div>\n  <div class="js-measuringprompt">\n<p class="js-starthelp">'+e.addpoint+'</p>\n    <div class="js-results results"></div>\n    <ul class="js-measuretasks tasks">\n      <li><a href="#" class="js-cancel cancel">'+e.cancel+'</a></li>\n      <li><a href="#" class="js-finish finish">'+e.finish+"</a></li>\n    </ul>\n  </div>\n</div>"),r=s.template('<div class="group">\n<p class="lastpoint heading">'+e.lastpoint+'</p>\n<p><%= model.lastCoord.dms.y %> <span class="coorddivider">/</span> <%= model.lastCoord.dms.x %></p>\n<p><%= humanize.numberFormat(model.lastCoord.dd.y, 6) %> <span class="coorddivider">/</span> <%= humanize.numberFormat(model.lastCoord.dd.x, 6) %></p>\n</div>\n<% if (model.pointCount > 1) { %>\n<div class="group">\n<p><span class="heading">'+e.pathdistance+"</span> <%= humanize.numberFormat(model.length.meters, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.meters+" (<%= humanize.numberFormat(model.length.kilometers, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.kilometers+')</p>\n</div>\n<% } %>\n<% if (model.pointCount > 2) { %>\n<div class="group">\n<p><span class="heading">'+e.area+"</span> <%= humanize.numberFormat(model.area.sqmeters, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.sqmeters+" (<%= humanize.numberFormat(model.area.hectares, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.hectares+")</p>\n</div>\n<% } %>"),a=s.template("<h3>"+e.pointlocation+'</h3>\n<p><%= model.lastCoord.dms.y %> <span class="coorddivider">/</span> <%= model.lastCoord.dms.x %></p>\n<p><%= humanize.numberFormat(model.lastCoord.dd.y, 6) %> <span class="coorddivider">/</span> <%= humanize.numberFormat(model.lastCoord.dd.x, 6) %></p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">'+e.centerlocation+'</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">'+e["delete"]+"</a></li>\n</ul>"),o=s.template("<h3>"+e.linearmesurement+"</h3>\n<p><%= humanize.numberFormat(model.length.meters, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.meters+"</p>\n<p><%= humanize.numberFormat(model.length.kilometers, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.kilometers+'</p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">'+e.centerlocation+'</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">'+e["delete"]+"</a></li>\n</ul>"),i=s.template("<h3>"+e.areamesurement+"</h3>\n<p><%= humanize.numberFormat(model.area.sqmeters, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.sqmeters+" (<%= humanize.numberFormat(model.area.hectares, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.hectares+")</p>\n<p><%= humanize.numberFormat(model.length.meters, 2,'"+e.decsep+"','"+e.thousandsep+"') %> "+e.meters+" (<%= humanize.numberFormat(model.length.kilometers, 2,'"+e.decsep+"','"+e.thousandsep+"') %> Kilometers) "+e.perimeter+'</p>\n<ul class="tasks">\n  <li><a href="#" class="js-zoomto zoomto">'+e.centerlocation+'</a></li>\n  <li><a href="#" class="js-deletemarkup deletemarkup">'+e["delete"]+"</a></li>\n</ul>"),l.setOptions(this,e),this._symbols=new p(s.pick(this.options,"activeColor","completedColor"))},onAdd:function(e){return this._map=e,this._latlngs=[],this._initLayout(),e.on("click",this._collapse,this),this._layer=l.layerGroup().addTo(e),this._container},onRemove:function(e){e.off("click",this._collapse,this),e.removeLayer(this._layer)},_initLayout:function(){var e,t,r,a,o=this._className,i=this._container=l.DomUtil.create("div",o);i.innerHTML=n({model:{className:o}}),i.setAttribute("aria-haspopup",!0),l.Browser.touch?l.DomEvent.on(i,"click",l.DomEvent.stopPropagation):(l.DomEvent.disableClickPropagation(i),l.DomEvent.disableScrollPropagation(i)),e=this.$toggle=f(".js-toggle",i),this.$interaction=f(".js-interaction",i),t=f(".js-start",i),r=f(".js-cancel",i),a=f(".js-finish",i),this.$startPrompt=f(".js-startprompt",i),this.$measuringPrompt=f(".js-measuringprompt",i),this.$startHelp=f(".js-starthelp",i),this.$results=f(".js-results",i),this.$measureTasks=f(".js-measuretasks",i),this._collapse(),this._updateMeasureNotStarted(),l.Browser.android||(l.DomEvent.on(i,"mouseenter",this._expand,this),l.DomEvent.on(i,"mouseleave",this._collapse,this)),l.DomEvent.on(e,"click",l.DomEvent.stop),l.Browser.touch?l.DomEvent.on(e,"click",this._expand,this):l.DomEvent.on(e,"focus",this._expand,this),l.DomEvent.on(t,"click",l.DomEvent.stop),l.DomEvent.on(t,"click",this._startMeasure,this),l.DomEvent.on(r,"click",l.DomEvent.stop),l.DomEvent.on(r,"click",this._finishMeasure,this),l.DomEvent.on(a,"click",l.DomEvent.stop),l.DomEvent.on(a,"click",this._handleMeasureDoubleClick,this)},_expand:function(){d.hide(this.$toggle),d.show(this.$interaction)},_collapse:function(){this._locked||(d.hide(this.$interaction),d.show(this.$toggle))},_updateMeasureNotStarted:function(){d.hide(this.$startHelp),d.hide(this.$results),d.hide(this.$measureTasks),d.hide(this.$measuringPrompt),d.show(this.$startPrompt)},_updateMeasureStartedNoPoints:function(){d.hide(this.$results),d.show(this.$startHelp),d.show(this.$measureTasks),d.hide(this.$startPrompt),d.show(this.$measuringPrompt)},_updateMeasureStartedWithPoints:function(){d.hide(this.$startHelp),d.show(this.$results),d.show(this.$measureTasks),d.hide(this.$startPrompt),d.show(this.$measuringPrompt)},_startMeasure:function(){this._locked=!0,this._map.doubleClickZoom.disable(),this._map.on("mouseout",this._handleMapMouseOut,this),l.DomEvent.on(this._container,"mouseenter",this._handleMapMouseOut,this),this._measureCollector||(this._measureCollector=l.polygon([[90,-180],[90,180],[-90,180],[-90,-180]],this._symbols.getSymbol("measureCollector")).addTo(this._layer),this._measureCollector.on("mousemove",this._handleMeasureMove,this),this._measureCollector.on("dblclick",this._handleMeasureDoubleClick,this),this._measureCollector.on("click",this._handleMeasureClick,this)),this._measureCollector.bringToFront(),this._measureVertexes=l.featureGroup().addTo(this._layer),this._updateMeasureStartedNoPoints()},_finishMeasure:function(){this._locked=!1,this._map.doubleClickZoom.enable(),this._map.off("mouseout",this._handleMapMouseOut,this),l.DomEvent.off(this._container,"mouseover",this._handleMapMouseOut,this),this._clearMeasure(),this._measureCollector.off(),this._layer.removeLayer(this._measureCollector),this._measureCollector=null,this._layer.removeLayer(this._measureVertexes),this._measureVertexes=null,this._updateMeasureNotStarted(),this._collapse()},_clearMeasure:function(){this._latlngs=[],this._measureVertexes.clearLayers(),this._measureDrag&&this._layer.removeLayer(this._measureDrag),this._measureArea&&this._layer.removeLayer(this._measureArea),this._measureBoundary&&this._layer.removeLayer(this._measureBoundary),this._measureDrag=null,this._measureArea=null,this._measureBoundary=null},_updateResults:function(){var e=c.measure(this._latlngs);this.$results.innerHTML=r({model:s.extend({},e,{pointCount:this._latlngs.length}),humanize:u})},_handleMeasureMove:function(e){this._measureDrag?this._measureDrag.setLatLng(e.latlng):this._measureDrag=l.circleMarker(e.latlng,this._symbols.getSymbol("measureDrag")).addTo(this._layer),this._measureDrag.bringToFront()},_handleMeasureDoubleClick:function(){var e,t,n,r,d,p,h=this._latlngs;this._finishMeasure(),h.length&&(h.length>2&&h.push(s.first(h)),e=c.measure(h),1===h.length?(t=l.circleMarker(h[0],this._symbols.getSymbol("resultPoint")),r=a({model:e,humanize:u})):2===h.length?(t=l.polyline(h,this._symbols.getSymbol("resultLine")).addTo(this._map),r=o({model:e,humanize:u})):(t=l.polygon(h,this._symbols.getSymbol("resultArea")),r=i({model:e,humanize:u})),n=l.DomUtil.create("div",""),n.innerHTML=r,d=f(".js-zoomto",n),d&&(l.DomEvent.on(d,"click",l.DomEvent.stop),l.DomEvent.on(d,"click",function(){this._map.fitBounds(t.getBounds(),{padding:[20,20],maxZoom:17})},this)),p=f(".js-deletemarkup",n),p&&(l.DomEvent.on(p,"click",l.DomEvent.stop),l.DomEvent.on(p,"click",function(){this._map.removeLayer(t)},this)),t.addTo(this._map),t.bindPopup(n,this.options.popupOptions),t.openPopup(t.getBounds().getCenter()))},_handleMeasureClick:function(e){var t=e.latlng,n=s.last(this._latlngs),r=this._symbols.getSymbol("measureVertex");this._map.closePopup(),n&&t.equals(n)||(this._latlngs.push(t),this._addMeasureArea(this._latlngs),this._addMeasureBoundary(this._latlngs),this._measureVertexes.eachLayer(function(e){e.setStyle(r),e._path.setAttribute("class",r.className)}),this._addNewVertex(t),this._measureBoundary&&this._measureBoundary.bringToFront(),this._measureVertexes.bringToFront()),this._updateResults(),this._updateMeasureStartedWithPoints()},_handleMapMouseOut:function(){this._measureDrag&&(this._layer.removeLayer(this._measureDrag),this._measureDrag=null)},_addNewVertex:function(e){l.circleMarker(e,this._symbols.getSymbol("measureVertexActive")).addTo(this._measureVertexes)},_addMeasureArea:function(e){return e.length<3?void(this._measureArea&&(this._layer.removeLayer(this._measureArea),this._measureArea=null)):void(this._measureArea?this._measureArea.setLatLngs(e):this._measureArea=l.polygon(e,this._symbols.getSymbol("measureArea")).addTo(this._layer))},_addMeasureBoundary:function(e){return e.length<2?void(this._measureBoundary&&(this._layer.removeLayer(this._measureBoundary),this._measureBoundary=null)):void(this._measureBoundary?this._measureBoundary.setLatLngs(e):this._measureBoundary=l.polyline(e,this._symbols.getSymbol("measureBoundary")).addTo(this._layer))}}),l.Map.mergeOptions({measureControl:!1}),l.Map.addInitHook(function(){this.options.measureControl&&(this.measureControl=(new l.Control.Measure).addTo(this))}),l.control.measure=function(e){return new l.Control.Measure(e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./calc":17,"./dom":18,"./mapsymbology":20,humanize:15,underscore:16}],20:[function(e,t,n){var r=e("underscore"),a=(e("color"),function(e){this.setOptions(e)});a.DEFAULTS={activeColor:"#ABE67E",completedColor:"#C8F2BE"},r.extend(a.prototype,{setOptions:function(e){return this._options=r.extend({},a.DEFAULTS,this._options,e),this},getSymbol:function(e){var t={measureCollector:{clickable:!0,stroke:!1,fillOpacity:0,className:"layer-measurecollector"},measureDrag:{clickable:!1,radius:4,color:this._options.activeColor,weight:2,opacity:.7,fillColor:this._options.activeColor,fillOpacity:.5,className:"layer-measuredrag"},measureArea:{clickable:!1,stroke:!1,fillColor:this._options.activeColor,fillOpacity:.2,className:"layer-measurearea"},measureBoundary:{clickable:!1,color:this._options.activeColor,weight:2,opacity:.9,fill:!1,className:"layer-measureboundary"},measureVertex:{clickable:!1,radius:4,color:this._options.activeColor,weight:2,opacity:1,fillColor:this._options.activeColor,fillOpacity:.7,className:"layer-measurevertex"},measureVertexActive:{clickable:!1,radius:4,color:this._options.activeColor,weight:2,opacity:1,fillColor:this._options.activeColor,fillOpacity:.7,className:"layer-measurevertex active"},resultArea:{clickable:!0,color:this._options.completedColor,weight:2,opacity:.9,fillColor:this._options.completedColor,fillOpacity:.2,className:"layer-measure-resultarea"},resultLine:{clickable:!0,color:this._options.completedColor,weight:3,opacity:.9,fill:!1,className:"layer-measure-resultline"},resultPoint:{clickable:!0,radius:4,color:this._options.completedColor,weight:2,opacity:1,fillColor:this._options.completedColor,fillOpacity:.7,className:"layer-measure-resultpoint"}};return t[e]}}),t.exports=a},{color:1,underscore:16}]},{},[19]),function(e){var t;if("function"==typeof define&&define.amd)define(["leaflet"],e);else if("undefined"!=typeof module)t=require("leaflet"),module.exports=e(t);else{if("undefined"==typeof window.L)throw"Leaflet must be loaded first";e(window.L)}}(function(e){"use strict";return e.Control.Geocoder=e.Control.extend({options:{showResultIcons:!1,collapsed:!0,expand:"click",position:"topright",placeholder:"Search...",errorMessage:"Nothing found.",title:"Find an address"},_callbackId:0,initialize:function(t){e.Util.setOptions(this,t),this.options.geocoder||(this.options.geocoder=new e.Control.Geocoder.Nominatim)},onAdd:function(t){var n,r="leaflet-control-geocoder",a=e.DomUtil.create("div",r),o=e.DomUtil.create("div","leaflet-control-geocoder-icon",a),i=this._form=e.DomUtil.create("form",r+"-form",a);return this._map=t,this._container=a,this._container.title=this.options.title,n=this._input=e.DomUtil.create("input"),n.type="text",n.placeholder=this.options.placeholder,e.DomEvent.addListener(n,"keydown",this._keydown,this),this._errorElement=document.createElement("div"),this._errorElement.className=r+"-form-no-error",this._errorElement.innerHTML=this.options.errorMessage,this._alts=e.DomUtil.create("ul",r+"-alternatives leaflet-control-geocoder-alternatives-minimized"),i.appendChild(n),i.appendChild(this._errorElement),a.appendChild(this._alts),e.DomEvent.addListener(i,"submit",this._geocode,this),this.options.collapsed?"click"===this.options.expand?e.DomEvent.addListener(o,"click",function(e){0===e.button&&2!==e.detail&&this._toggle()},this):(e.DomEvent.addListener(o,"mouseover",this._expand,this),e.DomEvent.addListener(o,"mouseout",this._collapse,this),this._map.on("movestart",this._collapse,this)):this._expand(),e.DomEvent.disableClickPropagation(a),a},_geocodeResult:function(t){if(e.DomUtil.removeClass(this._container,"leaflet-control-geocoder-throbber"),t.length>0){this._alts.innerHTML="",this._results=t,e.DomUtil.removeClass(this._alts,"leaflet-control-geocoder-alternatives-minimized");for(var n=0;n<t.length;n++)this._alts.appendChild(this._createAlt(t[n],n))}else e.DomUtil.addClass(this._errorElement,"leaflet-control-geocoder-error")},markGeocode:function(t){return this._map.fitBounds(t.bbox),this._geocodeMarker&&this._map.removeLayer(this._geocodeMarker),this._geocodeMarker=new e.Marker(t.center).bindPopup(t.html||t.name).addTo(this._map).openPopup(),this},_geocode:function(t){return null!==t&&e.DomEvent.preventDefault(t),e.DomUtil.addClass(this._container,"leaflet-control-geocoder-throbber"),this._clearResults(),this.options.geocoder.geocode(this._input.value,this._geocodeResult,this),!1},_geocodeResultSelected:function(e){this.options.collapsed?this._collapse():this._clearResults(),this.markGeocode(e)},_toggle:function(){this._container.className.indexOf("leaflet-control-geocoder-expanded")>=0?this._collapse():this._expand()},_expand:function(){e.DomUtil.addClass(this._container,"leaflet-control-geocoder-expanded"),this._input.select()},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-geocoder-expanded",""),e.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),e.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error")},_clearResults:function(){e.DomUtil.addClass(this._alts,"leaflet-control-geocoder-alternatives-minimized"),this._selection=null,e.DomUtil.removeClass(this._errorElement,"leaflet-control-geocoder-error")},_createAlt:function(t,n){var r=document.createElement("li"),a=e.DomUtil.create("a","",r),o=this.options.showResultIcons&&t.icon?e.DomUtil.create("img","",a):null,i=t.html?void 0:document.createTextNode(t.name);return o&&(o.src=t.icon),a.href="#",a.setAttribute("data-result-index",n),t.html?a.innerHTML=t.html:a.appendChild(i),e.DomEvent.addListener(r,"click",function(n){e.DomEvent.preventDefault(n),this._geocodeResultSelected(t)},this),r},_keydown:function(t){var n=this;setTimeout(function(){n._input.value.length>2?n._geocode(null):n._clearResults()},50);var n=this,r=function(t){n._selection&&(e.DomUtil.removeClass(n._selection.firstChild,"leaflet-control-geocoder-selected"),n._selection=n._selection[t>0?"nextSibling":"previousSibling"]),n._selection||(n._selection=n._alts[t>0?"firstChild":"lastChild"]),n._selection&&e.DomUtil.addClass(n._selection.firstChild,"leaflet-control-geocoder-selected")};switch(t.keyCode){case 27:this.options.collapsed&&this._collapse();break;case 38:r(-1),e.DomEvent.preventDefault(t);break;case 40:r(1),e.DomEvent.preventDefault(t);break;case 13:if(this._selection){var a=parseInt(this._selection.firstChild.getAttribute("data-result-index"),10);this._geocodeResultSelected(this._results[a]),this._clearResults(),e.DomEvent.preventDefault(t)}}return!0}}),e.Control.geocoder=function(t,n){return new e.Control.Geocoder(t,n)},e.Control.Geocoder.callbackId=0,e.Control.Geocoder.jsonp=function(t,n,r,a,o){var i="_l_geocoder_"+e.Control.Geocoder.callbackId++;n[o||"callback"]=i,window[i]=e.Util.bind(r,a);var s=document.createElement("script");s.type="text/javascript",s.src=t+e.Util.getParamString(n),s.id=i,document.getElementsByTagName("head")[0].appendChild(s)},e.Control.Geocoder.getJSON=function(t,n,r){var a=new XMLHttpRequest;a.open("GET",t+e.Util.getParamString(n),!0),a.send(null),a.onreadystatechange=function(){4==a.readyState&&(200==a.status||304==req.status)&&r(JSON.parse(a.response))}},e.Control.Geocoder.template=function(t,n,r){return t.replace(/\{ *([\w_]+) *\}/g,function(t,r){var a=n[r];return void 0===a?a="":"function"==typeof a&&(a=a(n)),e.Control.Geocoder.htmlEscape(a)})},e.Control.Geocoder.htmlEscape=function(){function e(e){return r[e]}var t=/[&<>"'`]/g,n=/[&<>"'`]/,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return function(r){return null==r?"":r?(r=""+r,n.test(r)?r.replace(t,e):r):r+""}}(),e.Control.Geocoder.Nominatim=e.Class.extend({options:{serviceUrl:"//nominatim.openstreetmap.org/",geocodingQueryParams:{},reverseQueryParams:{},htmlTemplate:function(t){var n=t.address,r=[];return(n.road||n.building)&&r.push("{building} {road} {house_number}"),(n.city||n.town||n.village)&&r.push('<span class="'+(r.length>0?"leaflet-control-geocoder-address-detail":"")+'">{postcode} {city} {town} {village}</span>'),(n.state||n.country)&&r.push('<span class="'+(r.length>0?"leaflet-control-geocoder-address-context":"")+'">{state} {country}</span>'),e.Control.Geocoder.template(r.join("<br/>"),n,!0)}},initialize:function(t){e.Util.setOptions(this,t)},geocode:function(t,n,r){e.Control.Geocoder.jsonp(this.options.serviceUrl+"search/",e.extend({q:t,limit:5,format:"json",addressdetails:1},this.options.geocodingQueryParams),function(t){for(var a=[],o=t.length-1;o>=0;o--){for(var i=t[o].boundingbox,s=0;4>s;s++)i[s]=parseFloat(i[s]);a[o]={icon:t[o].icon,name:t[o].display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(t[o]):void 0,bbox:e.latLngBounds([i[0],i[2]],[i[1],i[3]]),center:e.latLng(t[o].lat,t[o].lon),properties:t[o]}}n.call(r,a)},this,"json_callback")},reverse:function(t,n,r,a){e.Control.Geocoder.jsonp(this.options.serviceUrl+"reverse/",e.extend({lat:t.lat,lon:t.lng,zoom:Math.round(Math.log(n/256)/Math.log(2)),addressdetails:1,format:"json"},this.options.reverseQueryParams),function(t){var n,o=[];t&&t.lat&&t.lon&&(n=e.latLng(t.lat,t.lon),o.push({name:t.display_name,html:this.options.htmlTemplate?this.options.htmlTemplate(t):void 0,center:n,bounds:e.latLngBounds(n,n),properties:t})),r.call(a,o)},this,"json_callback")}}),e.Control.Geocoder.nominatim=function(t){return new e.Control.Geocoder.Nominatim(t)},e.Control.Geocoder.Bing=e.Class.extend({initialize:function(e){this.key=e},geocode:function(t,n,r){e.Control.Geocoder.jsonp("//dev.virtualearth.net/REST/v1/Locations",{query:t,key:this.key},function(t){for(var a=[],o=t.resourceSets[0].resources.length-1;o>=0;o--){var i=t.resourceSets[0].resources[o],s=i.bbox;a[o]={name:i.name,bbox:e.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:e.latLng(i.point.coordinates)}}n.call(r,a)},this,"jsonp")},reverse:function(t,n,r,a){e.Control.Geocoder.jsonp("//dev.virtualearth.net/REST/v1/Locations/"+t.lat+","+t.lng,{key:this.key},function(t){for(var n=[],o=t.resourceSets[0].resources.length-1;o>=0;o--){var i=t.resourceSets[0].resources[o],s=i.bbox;n[o]={name:i.name,bbox:e.latLngBounds([s[0],s[1]],[s[2],s[3]]),center:e.latLng(i.point.coordinates)}}r.call(a,n)},this,"jsonp")}}),e.Control.Geocoder.bing=function(t){return new e.Control.Geocoder.Bing(t)},e.Control.Geocoder.RaveGeo=e.Class.extend({options:{querySuffix:"",deepSearch:!0,wordBased:!1},jsonp:function(t,n,r){var a="_l_geocoder_"+e.Control.Geocoder.callbackId++,o=[];t.prepend=a+"(",t.append=")";for(var i in t)o.push(i+"="+escape(t[i]));window[a]=e.Util.bind(n,r);var s=document.createElement("script");s.type="text/javascript",s.src=this._serviceUrl+"?"+o.join("&"),s.id=a,document.getElementsByTagName("head")[0].appendChild(s)},initialize:function(t,n,r){e.Util.setOptions(this,r),this._serviceUrl=t,this._scheme=n},geocode:function(t,n,r){e.Control.Geocoder.jsonp(this._serviceUrl,{address:t+this.options.querySuffix,scheme:this._scheme,outputFormat:"jsonp",deepSearch:this.options.deepSearch,wordBased:this.options.wordBased},function(t){for(var a=[],o=t.length-1;o>=0;o--){var i=t[o],s=e.latLng(i.y,i.x);a[o]={name:i.address,bbox:e.latLngBounds([s]),center:s}}n.call(r,a)},this)}}),e.Control.Geocoder.raveGeo=function(t,n,r){return new e.Control.Geocoder.RaveGeo(t,n,r)},e.Control.Geocoder.MapQuest=e.Class.extend({options:{serviceUrl:"//www.mapquestapi.com/geocoding/v1"},initialize:function(t,n){this._key=decodeURIComponent(t),e.Util.setOptions(this,n)},_formatName:function(){var e,t=[];for(e=0;e<arguments.length;e++)arguments[e]&&t.push(arguments[e]);return t.join(", ")},geocode:function(t,n,r){e.Control.Geocoder.jsonp(this.options.serviceUrl+"/address",{key:this._key,location:t,limit:5,outFormat:"json"},function(t){var a,o,i=[];if(t.results&&t.results[0].locations)for(var s=t.results[0].locations.length-1;s>=0;s--)a=t.results[0].locations[s],o=e.latLng(a.latLng),i[s]={name:this._formatName(a.street,a.adminArea4,a.adminArea3,a.adminArea1),bbox:e.latLngBounds(o,o),center:o};n.call(r,i)},this)},reverse:function(t,n,r,a){e.Control.Geocoder.jsonp(this.options.serviceUrl+"/reverse",{key:this._key,location:t.lat+","+t.lng,outputFormat:"json"},function(t){var n,o,i=[];if(t.results&&t.results[0].locations)for(var s=t.results[0].locations.length-1;s>=0;s--)n=t.results[0].locations[s],o=e.latLng(n.latLng),i[s]={name:this._formatName(n.street,n.adminArea4,n.adminArea3,n.adminArea1),bbox:e.latLngBounds(o,o),center:o};r.call(a,i)},this)}}),e.Control.Geocoder.mapQuest=function(t,n){return new e.Control.Geocoder.MapQuest(t,n)},e.Control.Geocoder.Mapbox=e.Class.extend({options:{service_url:"https://api.tiles.mapbox.com/v4/geocode/mapbox.places-v1/"},initialize:function(e){this._access_token=e},geocode:function(t,n,r){e.Control.Geocoder.getJSON(this.options.service_url+encodeURIComponent(t)+".json",{access_token:this._access_token},function(t){var a,o,i,s=[];if(t.features&&t.features.length)for(var l=0;l<=t.features.length-1;l++)a=t.features[l],o=e.latLng(a.center.reverse()),i=a.hasOwnProperty("bbox")?e.latLngBounds(e.latLng(a.bbox.slice(0,2).reverse()),e.latLng(a.bbox.slice(2,4).reverse())):e.latLngBounds(o,o),s[l]={name:a.place_name,bbox:i,center:o};n.call(r,s)})},suggest:function(e,t,n){return this.geocode(e,t,n)},reverse:function(t,n,r,a){e.Control.Geocoder.getJSON(this.options.service_url+encodeURIComponent(t.lng)+","+encodeURIComponent(t.lat)+".json",{access_token:this._access_token},function(t){var n,o,i,s=[];if(t.features&&t.features.length)for(var l=0;l<=t.features.length-1;l++)n=t.features[l],
o=e.latLng(n.center.reverse()),i=n.hasOwnProperty("bbox")?e.latLngBounds(e.latLng(n.bbox.slice(0,2).reverse()),e.latLng(n.bbox.slice(2,4).reverse())):e.latLngBounds(o,o),s[l]={name:n.place_name,bbox:i,center:o};r.call(a,s)})}}),e.Control.Geocoder.mapbox=function(t){return new e.Control.Geocoder.Mapbox(t)},e.Control.Geocoder.Google=e.Class.extend({options:{service_url:"https://maps.googleapis.com/maps/api/geocode/json"},initialize:function(t){this._key=t.key,e.extend(this.options,t)},geocode:function(t,n,r){var a={address:t};if(this._key&&this._key.length&&(a.key=this._key),"undefined"!=typeof this.options.language&&null!==this.options.language&&(a.language=this.options.language),"undefined"!=typeof this.options.bounds&&null!==this.options.bounds){var o=this.options.bounds.split(",");a.bounds=parseFloat(o[1])+","+parseFloat(o[0])+"|"+parseFloat(o[3])+","+parseFloat(o[2])}e.Control.Geocoder.getJSON(this.options.service_url,a,function(t){var a,o,i,s=[];if(t.results&&t.results.length)for(var l=0;l<=t.results.length-1;l++)a=t.results[l],o=e.latLng(a.geometry.location),i=e.latLngBounds(e.latLng(a.geometry.viewport.northeast),e.latLng(a.geometry.viewport.southwest)),s[l]={name:a.formatted_address,bbox:i,center:o};n.call(r,s)})},reverse:function(t,n,r,a){var o={latlng:encodeURIComponent(t.lat)+","+encodeURIComponent(t.lng)};this._key&&this._key.length&&(o.key=this._key),e.Control.Geocoder.getJSON(this.options.service_url,o,function(t){var n,o,i,s=[];if(t.results&&t.results.length)for(var l=0;l<=t.results.length-1;l++)n=t.results[l],o=e.latLng(n.geometry.location),i=e.latLngBounds(e.latLng(n.geometry.viewport.northeast),e.latLng(n.geometry.viewport.southwest)),s[l]={name:n.formatted_address,bbox:i,center:o};r.call(a,s)})}}),e.Control.Geocoder.google=function(t){return new e.Control.Geocoder.Google(t)},e.Control.Geocoder.Photon=e.Class.extend({options:{serviceUrl:"//photon.komoot.de/api/"},initialize:function(t){e.setOptions(this,t)},geocode:function(t,n,r){var a=e.extend({q:t},this.options.geocodingQueryParams);e.Control.Geocoder.getJSON(this.options.serviceUrl,a,function(t){var a,o,i,s,l,u,c=[];if(t&&t.features)for(a=0;a<t.features.length;a++)o=t.features[a],i=o.geometry.coordinates,s=e.latLng(i[1],i[0]),l=o.properties.extent,u=l?e.latLngBounds([l[1],l[0]],[l[3],l[2]]):e.latLngBounds(s,s),c.push({name:o.properties.name,center:s,bbox:u});n.call(r,c)})},suggest:function(e,t,n){return this.geocode(e,t,n)},reverse:function(e,t,n){t.call(n,[])}}),e.Control.Geocoder.photon=function(t){return new e.Control.Geocoder.Photon(t)},e.Control.Geocoder}),L.Control.EasyPrint=L.Control.extend({options:{position:"topleft",title:"Print",print:"Print",cancel:"cancel",copyright:"",defaulttitle:"",defaultdesc:""},onAdd:function(e){var t=this.options,n=L.DomUtil.create("div","leaflet-control-easyPrint leaflet-bar leaflet-control");return n.title=t.title,this.link=L.DomUtil.create("a","leaflet-control-easyPrint-button leaflet-bar-part",n),this.link.href="#",L.DomEvent.on(n,"click",function(e){L.DomEvent.stopPropagation(e),L.DomEvent.preventDefault(e),L.easyPrint(t)}),jQuery("body").on("click",".easySDImapPrintOk",function(e){e.preventDefault(),window.print()}),jQuery("body").on("click",".easySDImapPrintCancel",function(e){e.preventDefault(),L.easyPrintCancel()}),n}}),L.easyPrintControl=function(e){return new L.Control.EasyPrint(e)},L.easyPrint=function(e){{var t=jQuery(".leaflet-control-easyPrint"),n=t.parents(".leaflet-container"),r=n.width();n.height()}void 0==e.defaulttitle&&(e.defaulttitle=""),void 0==e.defaultdesc&&(e.defaultdesc=""),jQuery("body").addClass("easySDImapPrint"),jQuery("body *").addClass("mapPrintHideMe");var a=t.parents(".easySDImapPrintBlock");0===a.length&&(a=t),a.parents().removeClass("mapPrintHideMe"),a.find("*.mapPrintHideMe").removeClass("mapPrintHideMe"),a.removeClass("mapPrintHideMe");var o='<div class="easySDImapPrintMeta">';o+='<input type="text" class="easySDImapPrintTitle" value="'+e.defaulttitle+'" placeholder="Titre"/>',o+='<textarea type="text" class="easySDImapPrintDesc">'+e.defaultdesc+"</textarea>",o+='<p class="easySDImapPrintCopyright">'+e.copyright+"</p>",o+="</div>",o+='<div class="easySDImapPrintButtons">',o+='<a href="#" class="easySDImapPrintOk btn btn-lg btn-large btn-primary">'+e.print+"</a>",o+='<a href="#" class="easySDImapPrintCancel btn btn-lg btn-large btn-default">'+e.cancel+"</a>",o+="</div>",console.log(n),console.log(t),n.after(o),jQuery(".easySDImapPrintMeta, .easySDImapPrintButtons").width(r),jQuery("html, body").animate({scrollTop:jQuery(document).height()},1e3)},L.easyPrintCancel=function(){jQuery(".easySDImapPrint").removeClass("easySDImapPrint"),jQuery(".mapPrintHideMe").removeClass("mapPrintHideMe"),jQuery(".easySDImapPrintMeta").remove(),jQuery(".easySDImapPrintButtons").remove()},function(e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.Ka?define([],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).WMSCapabilities=e()}(function(){return function e(t,n,r){function a(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(o)return o(i,!0);throw l=Error("Cannot find module '"+i+"'"),l.code="MODULE_NOT_FOUND",l}l=n[i]={exports:{}},t[i][0].call(l.exports,function(e){var n=t[i][1][e];return a(n?n:e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var o="function"==typeof require&&require,i=0;i<r.length;i++)a(r[i]);return a}({1:[function(e,t){t.exports=e("./src/wms")},{"./src/wms":6}],2:[function(e,t){t.exports={u:1,Ba:2,ba:3,M:4,Ga:5,Fa:6,Ja:7,Ca:8,o:9,Ea:10,Da:11,Ia:12}},{}],3:[function(e,t){t.exports=function(e){return void 0!==e}},{}],4:[function(e,t){t.exports=function(e,t,n){return t in e?e[t]:e[t]=n}},{}],5:[function(e,t){var n=e("./isdef"),r=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;t.exports={trim:function(e){return e.replace(r,"")},m:function(e,t,r){return e=n(r)?e.toFixed(r):String(e),r=e.indexOf("."),-1==r&&(r=e.length),t=Math.max(0,t-r),Array(t+1).join("0")+e}}},{"./isdef":3}],6:[function(e,t){function n(e){this.version=void 0,this.v=new r,this.F=e}var r=e("./xml_parser"),a=e("./utils/isdef"),o=e("./node_types"),i=e("./utils/setifundefined"),s=e("./xsd"),l=e("./xlink"),u=r.va;n.prototype.data=function(e){return this.F=e,this},n.prototype.toJSON=function(e){return e=e||this.F,this.parse(e)},n.prototype.parse=function(e){return this.oa(this.v.za(e))},n.prototype.oa=function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType==o.u)return this.ya(e);return null},n.prototype.ya=function(e){return this.version=e.getAttribute("version"),r.b({version:this.version},n.Y,e,[])||null},n.ca=function(e,t){return r.b({},n.K,e,t)},n.ea=function(e){var t=s.s,n=[t(e.getAttribute("minx")),t(e.getAttribute("miny")),t(e.getAttribute("maxx")),t(e.getAttribute("maxy"))],t=[t(e.getAttribute("resx")),t(e.getAttribute("resy"))];return{crs:e.getAttribute("CRS")||e.getAttribute("SRS"),extent:n,res:t}},n.ma=function(e,t){var o=r.b({},n.T,e,t);if(a(o)){var i=o.westBoundLongitude,s=o.southBoundLatitude,l=o.eastBoundLongitude,o=o.northBoundLatitude;return a(i)&&a(s)&&a(l)&&a(o)?[i,s,l,o]:void 0}},n.fa=function(e,t){return r.b({},n.L,e,t)},n.ta=function(e,t){return r.b({},n.$,e,t)},n.ia=function(e,t){return r.b({},n.O,e,t)},n.ja=function(e,t){return r.b({},n.P,e,t)},n.ha=function(e,t){return r.b({},n.N,e,t)},n.na=function(e,t){return r.b([],n.S,e,t)},n.ga=function(e,t){return r.b({},n.D,e,t)},n.qa=function(e,t){var o=t[t.length-1],l=r.b({},n.D,e,t);if(a(l)){var u=s.i(e.getAttribute("queryable"));a(u)||(u=o.queryable),l.queryable=a(u)?u:!1,u=s.C(e.getAttribute("cascaded")),a(u)||(u=o.cascaded),l.cascaded=u,u=s.i(e.getAttribute("opaque")),a(u)||(u=o.opaque),l.opaque=a(u)?u:!1,u=s.i(e.getAttribute("noSubsets")),a(u)||(u=o.noSubsets),l.noSubsets=a(u)?u:!1,u=s.s(e.getAttribute("fixedWidth")),a(u)||(u=o.fixedWidth),l.fixedWidth=u,u=s.s(e.getAttribute("fixedHeight")),a(u)||(u=o.fixedHeight),l.fixedHeight=u;for(var c=["Style","CRS","AuthorityURL"],u=0,d=c.length;d>u;u++){var f=c[u],p=o[f];if(a(p)){var h=i(l,f,[]),h=h.concat(p);l[f]=h}}for(c="EX_GeographicBoundingBox BoundingBox Dimension Attribution MinScaleDenominator MaxScaleDenominator".split(" "),u=0,d=c.length;d>u;u++)f=c[u],h=l[f],a(h)||(p=o[f],l[f]=p);return l}},n.la=function(e){return{name:e.getAttribute("name"),units:e.getAttribute("units"),unitSymbol:e.getAttribute("unitSymbol"),"default":e.getAttribute("default"),multipleValues:s.i(e.getAttribute("multipleValues")),nearestValue:s.i(e.getAttribute("nearestValue")),current:s.i(e.getAttribute("current")),values:s.a(e)}},n.h=function(e,t){return r.b({},n.U,e,t)},n.sa=function(e,t){return r.b({},n.Z,e,t)},n.ka=function(e,t){return r.b({},n.R,e,t)},n.pa=function(e,t){return r.b({},n.V,e,t)},n.w=function(e,t){return r.b({},n.X,e,t)},n.H=function(e,t){var r=n.h(e,t);if(a(r)){var o=s.C,o=[o(e.getAttribute("width")),o(e.getAttribute("height"))];return r.size=o,r}},n.da=function(e,t){var r=n.h(e,t);return a(r)?(r.name=e.getAttribute("name"),r):void 0},n.ra=function(e,t){var r=n.h(e,t);return a(r)?(r.type=e.getAttribute("type"),r):void 0},n.ua=function(e,t){return r.b({},n.aa,e,t)},n.G=function(e,t){return r.b([],n.W,e,t)},n.c=[null,"http://www.opengis.net/wms"],n.Y=r.f(n.c,{Service:u(n.ta),Capability:u(n.fa)}),n.L=r.f(n.c,{Request:u(n.sa),Exception:u(n.na),Layer:u(n.ga)}),n.$=r.f(n.c,{Name:u(s.a),Title:u(s.a),Abstract:u(s.a),KeywordList:u(n.G),OnlineResource:u(l.A),ContactInformation:u(n.ia),Fees:u(s.a),AccessConstraints:u(s.a),LayerLimit:u(s.B),MaxWidth:u(s.B),MaxHeight:u(s.B)}),n.O=r.f(n.c,{ContactPersonPrimary:u(n.ja),ContactPosition:u(s.a),ContactAddress:u(n.ha),ContactVoiceTelephone:u(s.a),ContactFacsimileTelephone:u(s.a),ContactElectronicMailAddress:u(s.a)}),n.P=r.f(n.c,{ContactPerson:u(s.a),ContactOrganization:u(s.a)}),n.N=r.f(n.c,{AddressType:u(s.a),Address:u(s.a),City:u(s.a),StateOrProvince:u(s.a),PostCode:u(s.a),Country:u(s.a)}),n.S=r.f(n.c,{Format:r.J(s.a)}),n.D=r.f(n.c,{Name:u(s.a),Title:u(s.a),Abstract:u(s.a),KeywordList:u(n.G),CRS:r.g(s.a),EX_GeographicBoundingBox:u(n.ma),BoundingBox:r.g(n.ea),Dimension:r.g(n.la),Attribution:u(n.ca),AuthorityURL:r.g(n.da),Identifier:r.g(s.a),MetadataURL:r.g(n.ra),DataURL:r.g(n.h),FeatureListURL:r.g(n.h),Style:r.g(n.ua),MinScaleDenominator:u(s.j),MaxScaleDenominator:u(s.j),Layer:r.g(n.qa)}),n.K=r.f(n.c,{Title:u(s.a),OnlineResource:u(l.A),LogoURL:u(n.H)}),n.T=r.f(n.c,{westBoundLongitude:u(s.j),eastBoundLongitude:u(s.j),southBoundLatitude:u(s.j),northBoundLatitude:u(s.j)}),n.Z=r.f(n.c,{GetCapabilities:u(n.w),GetMap:u(n.w),GetFeatureInfo:u(n.w)}),n.X=r.f(n.c,{Format:r.g(s.a),DCPType:r.g(n.ka)}),n.R=r.f(n.c,{HTTP:u(n.pa)}),n.V=r.f(n.c,{Get:u(n.h),Post:u(n.h)}),n.aa=r.f(n.c,{Name:u(s.a),Title:u(s.a),Abstract:u(s.a),LegendURL:r.g(n.H),StyleSheetURL:u(n.h),StyleURL:u(n.h)}),n.U=r.f(n.c,{Format:u(s.a),OnlineResource:u(l.A)}),n.W=r.f(n.c,{Keyword:r.J(s.a)}),t.exports=n},{"./node_types":2,"./utils/isdef":3,"./utils/setifundefined":4,"./xlink":7,"./xml_parser":8,"./xsd":9}],7:[function(e,t){t.exports={A:function(e){return e.getAttributeNS("http://www.w3.org/1999/xlink","href")}}},{}],8:[function(e,t){function n(){this.v=new DOMParser}var r=e("./utils/isdef"),a=e("./utils/setifundefined"),o=e("./node_types");n.prototype.za=function(e){return this.v.parseFromString(e,"application/xml")},n.l=function(e){return n.I(e,!1,[]).join("")},n.I=function(e,t,r){if(e.nodeType===o.M||e.nodeType===o.ba)r.push(t?String(e.nodeValue).replace(/(\r\n|\r|\n)/g,""):e.nodeValue);else for(e=e.firstChild;e;e=e.nextSibling)n.I(e,t,r);return r},n.xa=function(e,t,a){for(t=n.firstElementChild(t);t;t=n.nextElementSibling(t)){var o=e[t.namespaceURI||null];r(o)&&(o=o[t.localName],r(o)&&o.call(void 0,t,a))}},n.firstElementChild=function(e){for(e=e.firstElementChild||e.firstChild;e&&e.nodeType!==o.u;)e=e.nextSibling;return e},n.nextElementSibling=function(e){for(e=e.nextElementSibling||e.nextSibling;e&&e.nodeType!==o.u;)e=e.nextSibling;return e},n.f=function(e,t){return n.wa(e,t)},n.wa=function(e,t){var n,a,o=r(void 0)?void 0:{};for(n=0,a=e.length;a>n;++n)o[e[n]]=t;return o},n.va=function(e,t,n){return function(a,o){var i=e.call(r(n)?n:this,a,o);if(r(i)){var s=o[o.length-1],l=r(t)?t:a.localName;s[l]=i}}},n.g=function(e){return function(t,n){var o=e.call(r(void 0)?void 0:this,t,n);if(r(o)){var i=n[n.length-1],s=r(void 0)?void 0:t.localName;a(i,s,[]).push(o)}}},n.J=function(e){return function(t,n){var a=e.call(r(void 0)?void 0:this,t,n);r(a)&&n[n.length-1].push(a)}},n.b=function(e,t,r,a){return a.push(e),n.xa(t,r,a),a.pop()},t.exports=n},{"./node_types":2,"./utils/isdef":3,"./utils/setifundefined":4}],9:[function(e,t){var n=e("./utils/isdef"),r=e("./utils/string"),a=e("./xml_parser"),o={Ha:"http://www.w3.org/2001/XMLSchema",La:function(e){return e=a.l(e),o.i(e)},i:function(e){return(e=/^\s*(true|1)|(false|0)\s*$/.exec(e))?n(e[1])||!1:void 0},Ma:function(e){if(e=a.l(e),e=/^\s*(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(Z|(?:([+\-])(\d{2})(?::(\d{2}))?))\s*$/.exec(e)){var t=Date.UTC(parseInt(e[1],10),parseInt(e[2],10)-1,parseInt(e[3],10),parseInt(e[4],10),parseInt(e[5],10),parseInt(e[6],10))/1e3;if("Z"!=e[7]){var r="-"==e[8]?-1:1,t=t+60*r*parseInt(e[9],10);n(e[10])&&(t+=3600*r*parseInt(e[10],10))}return t}},j:function(e){return e=a.l(e),o.s(e)},s:function(e){return(e=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e))?parseFloat(e[1]):void 0},B:function(e){return e=a.l(e),o.C(e)},C:function(e){return(e=/^\s*(\d+)\s*$/.exec(e))?parseInt(e[1],10):void 0},a:function(e){return e=a.l(e),r.trim(e)},Na:function(e,t){o.Aa(e,t?"1":"0")},Oa:function(e,t){var n=new Date(1e3*t),r=n.getUTCFullYear()+"-"+r.m(n.getUTCMonth()+1,2)+"-"+r.m(n.getUTCDate(),2)+"T"+r.m(n.getUTCHours(),2)+":"+r.m(n.getUTCMinutes(),2)+":"+r.m(n.getUTCSeconds(),2)+"Z";e.appendChild(a.o.createTextNode(r))},Pa:function(e,t){e.appendChild(a.o.createTextNode(t.toPrecision()))},Qa:function(e,t){e.appendChild(a.o.createTextNode(t.toString()))},Aa:function(e,t){e.appendChild(a.o.createTextNode(t))}};t.exports=o},{"./utils/isdef":3,"./utils/string":5,"./xml_parser":8}]},{},[1])(1)}),L.Control.Sidebar=L.Control.extend({includes:L.Mixin.Events,initialize:function(e,t){var n,r;for(L.setOptions(this,t),this._sidebar=L.DomUtil.get(e),L.Browser.touch&&L.DomUtil.addClass(this._sidebar,"leaflet-touch"),n=this._sidebar.children.length-1;n>=0;n--)r=this._sidebar.children[n],"UL"==r.tagName&&L.DomUtil.hasClass(r,"sidebar-tabs")?this._tabs=r:"DIV"==r.tagName&&L.DomUtil.hasClass(r,"sidebar-content")&&(this._container=r);for(this._tabitems=[],n=this._tabs.children.length-1;n>=0;n--)r=this._tabs.children[n],"LI"==r.tagName&&(this._tabitems.push(r),r._sidebar=this);for(this._panes=[],n=this._container.children.length-1;n>=0;n--)r=this._container.children[n],"DIV"==r.tagName&&L.DomUtil.hasClass(r,"sidebar-pane")&&this._panes.push(r);this._hasTouchStart=L.Browser.touch&&"ontouchstart"in document.documentElement},addTo:function(e){this._map=e;for(var t=this._hasTouchStart?"touchstart":"click",n=this._tabitems.length-1;n>=0;n--){var r=this._tabitems[n];L.DomEvent.on(r.firstChild,t,this._onClick,r)}return this},removeFrom:function(e){this._map=null;for(var t=this._hasTouchStart?"touchstart":"click",n=this._tabitems.length-1;n>=0;n--){var r=this._tabitems[n];L.DomEvent.off(r.firstChild,t,this._onClick)}return this},open:function(e){var t,n;for(t=this._panes.length-1;t>=0;t--)n=this._panes[t],n.id==e?L.DomUtil.addClass(n,"active"):L.DomUtil.hasClass(n,"active")&&L.DomUtil.removeClass(n,"active");for(t=this._tabitems.length-1;t>=0;t--)n=this._tabitems[t],n.firstChild.hash=="#"+e?L.DomUtil.addClass(n,"active"):L.DomUtil.hasClass(n,"active")&&L.DomUtil.removeClass(n,"active");return this.fire("content",{id:e}),L.DomUtil.hasClass(this._sidebar,"collapsed")&&(this.fire("opening"),L.DomUtil.removeClass(this._sidebar,"collapsed")),this},close:function(){for(var e=this._tabitems.length-1;e>=0;e--){var t=this._tabitems[e];L.DomUtil.hasClass(t,"active")&&L.DomUtil.removeClass(t,"active")}return L.DomUtil.hasClass(this._sidebar,"collapsed")||(this.fire("closing"),L.DomUtil.addClass(this._sidebar,"collapsed")),this},_onClick:function(e){e.preventDefault(),L.DomUtil.hasClass(this,"active")?this._sidebar.close():this._sidebar.open(this.firstChild.hash.slice(1))}}),L.control.sidebar=function(e,t){return new L.Control.Sidebar(e,t)},easyLayer=function(e,t){function n(e,t,n){var r;return function(){var a=this,o=arguments,i=function(){r=null,n||e.apply(a,o)},s=n&&!r;clearTimeout(r),r=setTimeout(i,t),s&&e.apply(a,o)}}var r={baseGroupName:"",addlayers:"add layers"};jQuery.extend(r,t);var a={map:e,groups:[],baseLayer:{},layers:{}},o=null,i=function(e){return"undefined"!=typeof e&&null!==e},s=function(e){var t=L.Util.stamp(e.layer);"layeradd"===e.type?u(t):c(t)};e.on("layeradd",s,this).on("layerremove",s,this).on("zoomend",function(){a.update()});var l=function(e){var t=!1;return jQuery.each(a.baseLayer,function(n,r){var a=L.Util.stamp(r.layer);a==e&&(t=r)}),jQuery.each(a.groups,function(n,r){var o=a.layers[r];jQuery.each(o,function(n,r){var a=L.Util.stamp(r.layer);a==e&&(t=r)})}),t};a.getLayerById=l;var u=function(e){o.find(".easyLayerTree .layer"+e).addClass("on"),jQuery.each(a.groups,function(t,n){var r=a.layers[n];i(r)&&i(r[e])&&(r[e].on=!0)}),i(a.baseLayer[e])&&(jQuery.each(a.baseLayer,function(e,t){t.on=!1}),a.baseLayer[e].on=!0)},c=function(e){o.find(".easyLayerTree .layer"+e).removeClass("on"),jQuery.each(a.groups,function(t,n){var r=a.layers[n];i(r)&&i(r[e])&&(r[e].on=!1)})};a.addTo=function(e){o=e,o.on("change",".easyLayerTree input[type=checkbox]",function(){a.switchLayer(this.name)}),o.on("change",".easyLayerTree input[type=radio]",function(){var e=this.value;jQuery.each(a.baseLayer,function(t,n){t!==e&&a.switchLayer(t,"off")}),a.switchLayer(e,"on")})};var d=function(e,t,n){return{name:e,layer:t,overlay:n,on:null}};a.addOverlay=function(e,t,n){-1===jQuery.inArray(n,a.groups)&&(a.addGroup(n),a.layers[n]={}),a.layers[n][L.Util.stamp(e)]=d(t,e,!0),a.update()},a.addBaseLayer=function(e,t){a.baseLayer[L.Util.stamp(e)]=d(t,e,!1),a.update()},a.addGroup=function(e){a.groups.push(e)},a.setBaseGroupName=function(e){r.baseGroupName=e,a.update()},a.getBaseGroupName=function(){return r.baseGroupName},a.removeGroup=function(e){var t=jQuery.inArray(e,a.groups);t>-1&&a.groups.splice(t,1)},a.switchLayer=function(e,t){var n=l(e);n.on&&"on"!==t||"off"===t?a.map.removeLayer(n.layer):a.map.addLayer(n.layer)};var f=function(){var t=e.getZoom();jQuery.each(a.groups,function(e,n){jQuery.each(a.layers[n],function(e,n){var r=t>=n.layer.options.minZoom&&t<=n.layer.options.maxZoom;r?o.find(".easyLayerTree .layer"+e).removeClass("outOfZoom"):o.find(".easyLayerTree .layer"+e).addClass("outOfZoom")})})};return a.update=n(function(){if(null!==o){o.html("<h4>"+r.title+'</h4><ul class="easyLayerTree"></ul>'),Object.keys(a.baseLayer).length>0&&o.find(".easyLayerTree").append('<li><a href="#" class="grouplink basegroup">'+r.baseGroupName+"</a></li>");var e=jQuery('<ul class="groupbasegroup"></ul>').appendTo(o.find(".easyLayerTree"));jQuery.each(a.baseLayer,function(t,n){var r=L.Util.stamp(n.layer);jQuery('<li class="baselayer layer'+r+(n.on?" on":"")+(i(n.layer.data.serviceconnector)?" LC_"+n.layer.data.serviceconnector:"")+'"><label><input name="baselayer" value="'+r+'" type="radio" '+(n.on?" checked=checked":"")+"> "+n.name+"</label></li>").appendTo(e)}),jQuery.each(a.groups,function(e,t){o.find(".easyLayerTree").append('<li><a href="#" class="grouplink group'+e+' data-group="'+e+'">'+t+"</a></li>");var n=jQuery('<ul class="group'+e+'"></ul>').appendTo(o.find(".easyLayerTree"));jQuery.each(a.layers[t],function(e,t){var r=L.Util.stamp(t.layer);jQuery('<li class="layer'+r+(t.on?" on":"")+(i(t.layer.data.serviceconnector)?" LC_"+t.layer.data.serviceconnector:"")+'"><label><input name="'+r+'" type="checkbox" '+(t.on?" checked=checked":"")+"> "+t.name+"</label></li>").appendTo(n)})}),r.addLayer!==!1&&jQuery('<div><a href="#" class="addLayerBtn">'+r.addlayers+"</a></div>").appendTo(o),f()}},100),a},easyAddLayer=function(e,t,n,r){var a={selectserver:"View available data from",addserver:"add a server",loadingtext:"loading ...",nolayersfound:"No available layer"},o=e.mapObj;jQuery.extend(a,r);var i=null,s=null,l={map:o},u=function(e){return"undefined"!=typeof e&&null!==e},c=function(){if(null==i||0==i.find(".service_switcher").length)return!1;var e=n.getAllServices(o);e._new_={servicealias:"",name:a.addserver,list:!0};i.find(".service_switcher select");for(var t in e)e[t].list&&(null==s&&(s=e[t].servicealias),jQuery('<option value="'+e[t].servicealias+'"'+(s==e[t].servicealias?" selected":"")+">"+e[t].name+"</option>").appendTo("select"));d()},d=function(){var e=i.find(".available_layers ul");if(""==s)return e.html('<form class="addservice"><div><label>Type</label><select name="type"><option value="WMS">Web Map Service (WMS)</option></select></div><div><label>URL</label><input type="text" name="url"/></div><input type="submit" value="'+a.addserver+'" /></form>'),!1;if(null==i||0==i.find(".available_layers").length)return!1;var t=n.getServiceLayers(s);if(null===t)return e.html(a.loadingtext),setTimeout(d,500),setTimeout(c,500),!1;e.html(""),0==t.length&&e.html('<p class="warning">'+a.nolayersfound+"</p>");for(var r in t){var o=t[r];if(u(o.Title)){var l=o.Title,f=o.Name;jQuery('<li><a href="#" data-layer="'+f+'">'+l+"</a></li>").appendTo(e)}"string"==typeof o&&jQuery('<li><a href="#" data-layer="'+o+'">'+o+"</a></li>").appendTo(e)}},f=function(t,r){var o=n.getCapabilities(t),i=n.getLayerData(o,r),s=n.services[t],l=!0,u=!0,c=a.defaultGroup;if("WMS"==s.serviceconnector)var d={name:i.Title,serviceconnector:s.serviceconnector,serviceurl:s.serviceurl,servicealias:t,layername:r,opacity:1,format:"image/png",attribution:n.getAttribution(i),style:"",bounds:"",maxZoom:"",zIndex:1e4};if("WMTS"==s.serviceconnector)var d={name:i.Title,serviceconnector:s.serviceconnector,serviceurl:s.serviceurl,servicealias:t,layername:r,opacity:1,format:"image/png",attribution:n.getAttribution(i),style:"",bounds:"",maxZoom:"",zIndex:1e4};if("Google"==s.serviceconnector){var d={name:"Google "+r,serviceconnector:s.serviceconnector,servicealias:t,layername:r,opacity:1};l=!1,c=null}if("OSM"==s.serviceconnector){var d={name:"OSM "+r,serviceconnector:s.serviceconnector,servicealias:t,layername:r,opacity:1};l=!1,c=null}if("Bing"==s.serviceconnector){var d={name:"Bing "+r,serviceconnector:s.serviceconnector,servicealias:t,layername:r,opacity:1};l=!1,c=null}e.addLayer(d,l,u,c),0==l&&console.log("la couche "+d.name+" a été ajoutée aux couches de fond")};return l.show=function(e){i=e,jQuery('<div class="service_switcher"><label>'+a.selectserver+'</label><select class="services"></select></div><div class="available_layers"><ul></ul></div>').appendTo(e),c(),e.on("change",".service_switcher select",function(){s=jQuery(this).val(),d()}),e.on("click",".available_layers a",function(){var e=jQuery(this).data("layer");f(s,e)}),e.on("submit",".addservice",function(e){e.preventDefault();var t=jQuery(this).find("input[name=url]").val(),r=jQuery(this).find("select[name=type]").val(),a={serviceconnector:r,servicetype:"physical",serviceurl:t,servicealias:t};s=t;var o=n.addService(a);o.list=!0,d()})},l},easyLegend=function(e,t,n,r){function a(e,t,n){var r;return function(){var a=this,o=arguments,i=function(){r=null,n||e.apply(a,o)},s=n&&!r;clearTimeout(r),r=setTimeout(i,t),s&&e.apply(a,o)}}var o={zoomOnExtends:"Zoom on layer",order:"Order",download:"Download",metadata:"Info",remove:"Remove",openLegend:"Open",legendTitle:"Legend"};jQuery.extend(o,r);var i={map:e,layertree:t},s=null,l=function(e){return"undefined"!=typeof e&&null!==e};e.on("layeradd",function(){i.update()}).on("layerremove",function(){i.update()}).on("zoomend",function(){i.update()}),window.addEventListener("getCapabilities",function(e){i.update()}),i.addTo=function(n){s=n,s.on("click",".removeLayer",function(){t.switchLayer(jQuery(this).data("layerid"),"off")}),s.on("click",".zoomlink",function(t){t.preventDefault();var n=jQuery(this).data("bbox").split(",");return n=L.latLngBounds([[n[1],n[0]],[n[3],n[2]]]),e.fitBounds(n),!1})};var u=function(e,t){return"GEOGRAPHICALGRIDSYSTEMS.CASSINI"==e?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GEOGRAPHICALGRIDSYSTEMS_ETATMAJOR.jpg":"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR"==e||"GEOGRAPHICALGRIDSYSTEMS.ETATMAJOR40"==e?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GEOGRAPHICALGRIDSYSTEMS_CASSINI.jpg":"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD"==e?t>=18?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_STANDARD_GE.jpg":t>=15?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_STANDARD_25K.jpg":t>=11?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_STANDARD_100K.jpg":t>=9?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_STANDARD_250K.jpg":"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_STANDARD_1000K.jpg":"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.CLASSIQUE"==e?t>=18?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_CLASSIQUE_GE.jpg":t>=15?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_CLASSIQUE_25K.jpg":t>=11?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_CLASSIQUE_100K.jpg":t>=9?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_CLASSIQUE_250K.jpg":"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GM_SCAN-EXPRESS_CLASSIQUE_1000K.jpg":"GEOGRAPHICALGRIDSYSTEMS.MAPS"==e?t>=18?!1:t>=15?!1:t>=13?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GEOGRAPHICALGRIDSYSTEMS_SCANDEP.jpg":"http://www.geoportail.gouv.fr/depot/api/legende/LEG_GEOGRAPHICALGRIDSYSTEMS_SCANREG.jpg":"ADMINISTRATIVEUNITS.BOUNDARIES"==e?"http://www.geoportail.gouv.fr/depot/api/legende/LEG_ADMINISTRATIVEUNITS_BOUNDARIES.jpg":!1},c=function(t,r){var a=L.Util.stamp(r.layer),i=jQuery('<div class="action_btns"></div>');t.append(i);var s=n.getBBox(r.layer,e);s!==!1&&null!==s&&jQuery('<a href="#"  class="zoomlink" rel="tooltip" data-bbox="'+s.toBBoxString()+'" title="'+o.zoomOnExtends+'"><i class="fa fa-search"></i></a>').appendTo(i),o.layerorder!==!1&&1==r.layer.data.hasextraction&&jQuery('<a href="'+r.layer.data.extractionurl+'" target=_blank class="commandlink" rel="tooltip" title="'+o.order+'"><i class="fa fa-shopping-cart"></i></a>').appendTo(i),o.layerdownload!==!1&&1==r.layer.data.hasdownload&&jQuery('<a href="'+r.layer.data.downloadurl+'" target=_blank class="downloadlink" rel="tooltip" title="'+o.download+'"><i class="fa fa-download"></i></a>').appendTo(i),o.layerdetailsheet!==!1&&l(r.layer.data.metadatalink)&&""!==r.layer.data.metadatalink&&jQuery('<a href="'+r.layer.data.metadatalink+'" target=_blank class="metadatalink" rel="tooltip" title="'+o.metadata+'"><i class="fa fa-info-circle"></i></a>').appendTo(i),r.overlay===!0&&jQuery('<a href="#" class="removeLayer" data-layerId="'+a+'" rel="tooltip" title="'+o.remove+'"><i class="fa fa-times-circle"></i></a>').appendTo(i)},d=function(e,t,r){var a=!1;if(l(t.legendUrl))a=t.legendUrl;else{var i=r.getZoom(),s=n.getLegendURL(t.layer);a=s,"http://www.geoportail.gouv.fr/depot/LEGEND.jpg"==a&&(a=u(t.layer.data.layername,i)),a===!1&&(a=n.getLegendGraphic(t.layer,r))}0!=a&&null!=a&&(html="<br>",html+='<a href="'+a+'" target=_blank title="'+o.openLegend+'" rel="tooltip"><img src="'+a+'" alt=""/></a>',e.append(html))};return i.update=a(function(){if(null!==s){s.html("<h4>"+o.title+"<br><small>"+o.legendTitle+'</small></h4><ul class="easyLegend"></ul>');var n="";for(var r in t.baseLayer){var a=t.baseLayer[r];if(a.on){if("baselayer"!==n){s.find(".easyLegend").append('<li><a href="#" class="grouplink basegroup">'+t.getBaseGroupName()+"</a></li>");var i=jQuery('<ul class="group'+r+'"></ul>').appendTo(s.find(".easyLegend"));n="baselayer"}var u=jQuery('<li class="baselayer layer'+r+(l(a.layer.data.serviceconnector)?" LC_"+a.layer.data.serviceconnector:"")+'"></li>').appendTo(i);c(u,a),jQuery("<span>"+a.name+"</span>").appendTo(u),d(u,a,e),u.append('<div class="clearfix"></div>')}}for(var r in t.groups){var f=t.groups[r];for(var p in t.layers[f]){var a=t.layers[f][p];if(a.on){if(n!=="group"+r){s.find(".easyLegend").append('<li><a href="#" class="grouplink group'+r+' data-group="'+r+'">'+f+"</a></li>");var i=jQuery('<ul class="group'+r+'"></ul>').appendTo(s.find(".easyLegend"));n="group"+r}var u=jQuery('<li class="layer'+p+(l(a.layer.data.serviceconnector)?" LC_"+a.layer.data.serviceconnector:"")+'"></li>').appendTo(i);c(u,a),jQuery("<span>"+a.name+"</span>").appendTo(u),d(u,a,e),u.append('<div class="clearfix"></div>')}}}}},100),i},easyGetFeature=function(e,t,n,r){function a(e,t,n){var r;return function(){var a=this,o=arguments,i=function(){r=null,n||e.apply(a,o)},s=n&&!r;clearTimeout(r),r=setTimeout(i,t),s&&e.apply(a,o)}}var o={queryablelayers_title:"Select a layer",noqueryablelayers:"No queryanle layer.",emptyselection:"empty",noresults:"nothing found"};jQuery.extend(o,r);var i={map:e,layertree:t,query:[]},s=null,l=null,u=null,c=L.layerGroup(),d=null,f=function(e){return"undefined"!=typeof e&&null!==e};e.on("layeradd",function(){i.update()}).on("layerremove",function(){i.update()}).on("click",function(e){i.onclick(e)}),jQuery("#sidebar").on("click",".sidebar-tabs a",function(){i.update()}),window.addEventListener("getCapabilities",function(e){i.update()}),i.addTo=function(e){s=e,l=jQuery('<div class="getfeature_info"></div>').appendTo(s),u=jQuery('<div class="getfeature_results"></div>').appendTo(s),l.on("change","select.queryable_layers",function(){d=jQuery(this).val()}),u.on("click",".removeResult",function(e){e.stopPropagation(),queryid=jQuery(this).data("queryid"),p(i.query[queryid])}),u.on("click",".removeAllResult",function(e){e.stopPropagation();for(var t in i.query)p(i.query[t])}),u.on("click",".found",function(){queryid=jQuery(this).data("queryid"),h(i.query[queryid])})};var p=function(e){e.html=!1,f(e.obj)&&c.removeLayer(e.obj),i.updateResults()},h=function(t){t.obj.openPopup(),e.panTo(t.latlng)};i.onclick=function(e){if(console.log(jQuery(".leaflet-zoom-box-crosshair").length),0==jQuery(".leaflet-zoom-box-crosshair").length){var n=s.find(".queryable_layers").val();i.getFeature(t.getLayerById(n),e)}},i.getFeature=function(t,r){var a=r.containerPoint,o=n.getFeatureUrl(t.layer,e,a),s={loading:!0,layer:t,latlng:r.latlng,html:null};i.query.push(s);var l=i.query.length-1;s=i.query[l],s.id=l,i.updateResults(),jQuery.ajax({type:"GET",url:o,success:function(e){if(s.loading=!1,null!=e){var t=jQuery("<div></div>").html(e).find("table");t.length>0?(s.html="",jQuery.each(t,function(){s.html+='<table class="featureInfo easygetfeature_table">'+jQuery(this).html()+"</table>"})):(e=e.replace("GetFeatureInfo results:","").trim(),e.length>0&&-1==e.search("Search returned no results.")?s.html='<pre class="featureInfo easygetfeature_pre">'+e+"</pre>":(s.html="none",setTimeout(function(){p(i.query[s.id])},1e3)))}var n=new CustomEvent("getFeature",s);window.dispatchEvent(n),i.updateResults()}}).fail(function(){s.html=!1,i.updateResults()})},i.update=a(function(){var r=[];if(jQuery(e._container).removeClass("getFeatureOn"),null!==l){l.html("");for(var a in t.baseLayer){var i=t.baseLayer[a];i.on&&n.getQueryable(i.layer)&&r.push(i)}for(var a in t.groups){var s=t.groups[a];for(var u in t.layers[s]){var i=t.layers[s][u];if(i.on){var f=n.getQueryable(i.layer,e);0!=f&&null!=f&&r.push(i)}}}if(r.length>0){l.append(jQuery("<p>"+o.queryablelayers_title+"</p>"));var p=jQuery('<select class="queryable_layers"></select>');l.append(p),jQuery.each(r,function(e,t){var n=L.Util.stamp(t.layer);jQuery('<option value="'+n+'"'+(d==n?" selected":"")+">"+r[e].name+"</option>").appendTo(p)}),jQuery("#sidebar #getfeature").hasClass("active")?(e.hasLayer(c)||e.addLayer(c),jQuery(e._container).addClass("getFeatureOn")):e.hasLayer(c)&&e.removeLayer(c);

}else l.html('<p class="warning">'+o.noqueryablelayers+"</p>")}},250);var m=function(t){var n=t.html,r=new L.Marker(t.latlng).bindPopup(n,{className:"easygetfeature_popup"}).addTo(c).openPopup();if(!jQuery("#sidebar #getfeature").hasClass("active")){L.popup({className:"easygetfeature_popup"}).setLatLng(t.latlng).setContent(n).openOn(e)}t.obj=r};return i.updateResults=a(function(){if(null!==u){u.html("");var e=jQuery.grep(i.query,function(e){return 0==e.loading&&null!=e.html&&0!=e.html});e.length>1&&u.append('<a href="#" class="removeAllResult" rel="tooltip" title="'+o.emptyselection+'"><i class="fa fa-eraser"></i></a>'),jQuery.each(i.query,function(e,t){if(t.loading){var n='<div class="query'+e+' loading"></div>',r=jQuery(n).appendTo(u);r.append(jQuery("<p>"+t.layer.name+"</p>")),r.append(jQuery("<p><small>"+t.latlng.lat+", "+t.latlng.lng+"</small></p>"))}else if(t.html!==!1){if("none"!==t.html)var n='<div class="query'+e+' found" data-queryid='+e+"></div>";else var n='<div class="query'+e+' none" data-queryid='+e+"></div>";var r=jQuery(n).appendTo(u);"none"!==t.html&&r.append('<div class="query-btns"><a href="#" class="removeResult" data-queryid="'+e+'" rel="tooltip" title="Enlever le résultat"><i class="fa fa-times-circle"></i></a></div>'),r.append(jQuery("<p>"+t.layer.name+"</p>")),r.append(jQuery("<p><small>"+t.latlng.lat+", "+t.latlng.lng+"</small></p>")),"none"!==t.html?null==t.obj&&m(t):r.append(jQuery('<p class="warning"><small>'+o.noresults+"</small></p>"))}})}},250),i.showPanel=function(e){e.open(),jQuery("#sidebar #getfeature").hasClass("active")||(jQuery("#sidebar .sidebar-content.active,#sidebar .sidebar-tabs li.active").removeClass("active"),jQuery("#sidebar #getfeature").addClass("active"),jQuery("#sidebar a[href=#getfeature]").parent().addClass("active")),i.update()},i};var easySDImap;jQuery(document).ready(function($){function urlObject(e){"use strict";var t,n,r,a,o,i,s,l,u={},c=document.createElement("a"),d={url:window.location.href,unescape:!0,convert_num:!0};if("object"!=typeof e)e=d;else for(n in d)d.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=d[n]);if(c.href=e.url,l=c.search.substring(1),t=l.split("&"),t[0].length>1)for(r=0;r<t.length;r+=1)o=t[r].split("="),e.unescape?(i=decodeURI(o[0]),s=decodeURI(o[1])):(i=o[0],s=o[1]),e.convert_num&&(s.match(/^\d+$/)?s=parseInt(s,10):s.match(/^\d+\.\d+$/)&&(s=parseFloat(s))),void 0===u[i]?u[i]=s:"string"==typeof u[i]?u[i]=[u[i],s]:u[i].push(s),o=[];return a={protocol:c.protocol,hostname:c.hostname,host:c.host,port:c.port,hash:c.hash.substr(1),pathname:c.pathname,search:c.search,parameters:u}}function xmlToJson(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var n=0;n<e.attributes.length;n++){var r=e.attributes.item(n);t["@attributes"][r.nodeName]=r.nodeValue}}}else 3==e.nodeType&&(t=e.nodeValue);if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var o=e.childNodes.item(a),i=o.nodeName;if("undefined"==typeof t[i])t[i]=xmlToJson(o);else{if("undefined"==typeof t[i].push){var s=t[i];t[i]=[],t[i].push(s)}t[i].push(xmlToJson(o))}}return t}var isset=function(e){return"undefined"!=typeof e&&null!==e},addIfSet=function(e,t,n){isset(n)&&(e[t]=n)},byOrdering=function(e,t){var n=isset(e.ordering)?parseInt(e.ordering):0,r=isset(t.ordering)?parseInt(t.ordering):0;return r>n?-1:n>r?1:0},projectedToLatLng=function(e,t,n){var r=L.point(e,t).divideBy(6378137);return n.projection.unproject(r)},LatLngFromString=function(e,t){var n=e.split(","),r=n.length/2;if(r!=Math.round(r))return console.log("ERROR: nb impair de coordonnées "+n.length),null;if(1==r)return void 0!==t?projectedToLatLng(n[0],n[1],t):L.latLng(n[1],n[0]);if(r>1){var a=[];for(i=0;i<=r-1;i++)a.push(void 0!==t?projectedToLatLng(n[2*i],n[2*i+1],t):L.latLng(n[2*i+1],n[2*i]));return a}};easymapServiceConnector=function(e){var t={services:{},proxy:e};t.addService=function(e){return isset(t.services[e.servicealias])||(t.services[e.servicealias]={serviceconnector:e.serviceconnector,servicetype:e.servicetype,serviceurl:e.serviceurl,servicealias:e.servicealias},("WMS"==e.serviceconnector||"WMTS"==e.serviceconnector)&&t.getCapabilities(e.servicealias)),t.services[e.servicealias]},t.getAllServices=function(e){return jQuery.each(e.contextMapData.services,function(e,n){var r=t.addService(n);r.name=n.name,r.list=!0}),t.services},t.getServiceLayers=function(e){var n=t.services[e];if("WMS"==n.serviceconnector||"WMTS"==n.serviceconnector){var a=t.getCapabilities(e);return r(a)}switch(n.serviceconnector){case"Google":return["ROADMAP","SATELLITE","HYBRID","TERRAIN"];case"Bing":break;case"OSM":return["mapnik"];default:return!1}};var n=function(n){var r=t.services[n],a=r.serviceurl+"?service="+r.serviceconnector+"&request=GetCapabilities";isset(t.proxy)&&(a=e+encodeURIComponent(a)),r.loading=!0,jQuery.ajax({type:"GET",url:a,dataType:"text",success:function(e){r.loading=!1,null!=e&&(r.getCapabilitiesXML=e,r.getCapabilities=new WMSCapabilities(e).toJSON(),isset(r.name)||o(n));var t=new CustomEvent("getCapabilities",r);window.dispatchEvent(t)}}).fail(function(){r.getCapabilities=!1})};t.getCapabilities=function(e){var r=t.services[e];return isset(r.getCapabilities)?r.getCapabilities:(isset(r.loading)||n(e),null)};var r=function(e){if(null==e)return null;var t=[],n=function(e,r,a){isset(a)||(a=0),isset(r)||(r=""),isset(e.Layer)?jQuery.each(e.Layer,function(t,o){n(o,a>1?r+e.Title+" ":r,a+1)}):(e.Group=r,t.push(e))};if(isset(e.Capability)){var r=jQuery.extend({},e.Capability.Layer);n(r,"",0)}return t},a=function(e,t){var n=!1,a=r(e);return jQuery.each(a,function(e,r){var a;isset(r.Name)&&(a=r.Name),a==t&&(n=r)}),n};t.getLayerData=function(e,t){return a(e,t)},t.getLegendURL=function(e){if("WMS"!=e.data.serviceconnector&&"WMTS"!=e.data.serviceconnector)return!1;var n=t.getCapabilities(e.data.servicealias,e);if(!isset(n)||"object"!=typeof n)return null;var r=a(n,e.data.layername);return isset(r.Style)&&isset(r.Style[0].LegendURL)?isset(r.Style[0].LegendURL[0].OnlineResource)?r.Style[0].LegendURL[0].OnlineResource:r.Style[0].LegendURL[0]:!1},t.getLegendGraphic=function(e,n){if("WMS"!=e.data.serviceconnector&&"WMTS"!=e.data.serviceconnector)return!1;var r=t.services[e.data.servicealias],a=n.contextMapData.srs,o=816401536/Math.pow(2,n.getZoom()),i=r.serviceurl+"?service="+r.serviceconnector+"&request=GetLegendGraphic&CRS="+a+"&LAYER="+e.data.layername+"&transparent=true&format=image%2Fpng&legend_options=fontAntiAliasing%3Atrue%3BfontSize%3A11%3BfontName%3AAria&scale="+o;return i},t.getAttribution=function(e){if(isset(e.Layer))return t.getAttribution(e.Layer[0]);if(!isset(e.Attribution))return null;var n=e.Attribution.Title;return isset(e.Attribution.LogoURL)&&(n='<img src="'+e.Attribution.LogoURL.OnlineResource+'" alt="" />'+n),isset(e.Attribution.OnlineResource)&&(n='<a href="'+e.Attribution.OnlineResource+'">'+n+"</a>"),n};var o=function(e){var n=t.services[e].getCapabilities;isset(n.Service)&&(t.services[e].name=n.Service.Title)};t.getBBox=function(e,n){if("WMS"!=e.data.serviceconnector&&"WMTS"!=e.data.serviceconnector)return!1;var r=t.getCapabilities(e.data.servicealias,e);if(!isset(r)||"object"!=typeof r)return null;var o=n.contextMapData.srs,i=a(r,e.data.layername);if(isset(i.BoundingBox)){var s=i.BoundingBox;for(var l in s){var u=s[l];if("CRS:84"==u.crs){var c=LatLngFromString(u.extent[0]+","+u.extent[1]+","+u.extent[2]+","+u.extent[3]);return L.latLngBounds(c)}}for(var l in s){var u=s[l];if(o==u.crs){var c=LatLngFromString(u.extent[0]+","+u.extent[1]+","+u.extent[2]+","+u.extent[3],n.options.crs);return L.latLngBounds(c)}}}return!1};var i=function(n,r,a,o){var i={request:"GetFeatureInfo",query_layers:r.data.layername,layers:r.data.layername,info_format:"",feature_count:10,X:Math.round(o.x),Y:Math.round(o.y)};jQuery.each(n.Capability.Request.GetFeatureInfo.Format,function(e,t){"text/plain"==t&&""==i.info_format&&(i.info_format=t),"text/html"==t&&(i.info_format=t)});var s=a.getBounds(),l=a.getSize(),u=parseFloat(r.wmsParams.version),c=a.options.crs||a.options.crs,d=u>=1.3?"crs":"srs",f=c.project(s.getNorthWest()),p=c.project(s.getSouthEast()),h={width:l.x,height:l.y};h[d]=c.code,h.bbox=(u>=1.3&&c===L.CRS.EPSG4326?[p.y,f.x,f.y,p.x]:[f.x,p.y,p.x,f.y]).join(","),L.extend(i,h);var m=n.Capability.Request.GetFeatureInfo.DCPType[0].HTTP.Get.OnlineResource;return m+=L.Util.getParamString(i,m),isset(t.proxy)&&(m=e+encodeURIComponent(m)),m};return t.getQueryable=function(e){if("WMS"!=e.data.serviceconnector&&"WMTS"!=e.data.serviceconnector)return!1;var n=t.getCapabilities(e.data.servicealias,e);if(!isset(n)||"object"!=typeof n)return null;var r=a(n,e.data.layername);return isset(r.queryable)&&1==r.queryable?!0:!1},t.getFeatureUrl=function(e,n,r){if(!isset(e))return!1;if("WMS"!=e.data.serviceconnector&&"WMTS"!=e.data.serviceconnector)return!1;var a=t.getCapabilities(e.data.servicealias,e);return isset(a)&&"object"==typeof a?i(a,e,n,r):null},t},easySDImap=function(obj,data,options){var params={};jQuery.extend(params,options);var _easySDImap={},map,baseLayers={},overlays={},services={},mapOptions={zoomControl:!1,attributionControl:!1,dragging:!1,touchZoom:!1,doubleClickZoom:!1,scrollWheelZoom:!1,boxZoom:!1,keyboard:!1},container,controlLayer,controlLegend,controlFeature,serviceConnector,lastBaseLayer=null,baseLayerGroup="",url_obj=urlObject(window.location.href),lang,boundsLatLng,contextMapData;_easySDImap.params=params;var pushTool=function(e,t,n){_easySDImap.tools.push({alias:e,control:t,params:n})},init=function(){container=obj;var e=jQuery(window).height();container.height(.95*e),contextMapData.groups.sort(byOrdering),contextMapData.services.sort(byOrdering),_easySDImap.contextMapData=contextMapData,serviceConnector=easymapServiceConnector(contextMapData.proxyhost),mapOptions.crs=setCRS(contextMapData.srs),mapOptions.center=LatLngFromString(contextMapData.centercoordinates,mapOptions.crs),mapOptions.zoom=parseFloat(contextMapData.zoom);var t=LatLngFromString(contextMapData.maxextent,mapOptions.crs);mapOptions.maxBounds=L.latLngBounds(t),boundsLatLng=mapOptions.maxBounds,map=L.map(container[0],mapOptions),_easySDImap.mapObj=map;var n=map.getBoundsZoom(mapOptions.maxBounds);map.options.minZoom=n,map.contextMapData=contextMapData,_easySDImap.tools=[],jQuery.each(contextMapData.tools,function(e,t){var n=addTool(t.alias,t.params);n!==!1&&pushTool(t.alias,n,t.params)}),pushTool("attribution",addTool("attribution")),isset(controlLayer)||(controlLayer=L.control.groupedLayers(baseLayers,overlays,{autoZIndex:!1}).addTo(map)),jQuery.each(contextMapData.groups,function(e,t){var n="1"!=t.isbackground;isset(t.layers)&&jQuery.each(t.layers,function(e,r){var a="1"==r.isdefaultvisible;addLayer(r,n,a,t.name)})});var r=obj.siblings(".addGeoJson");if(r.length>0){var a=L.geoJson(JSON.parse(r.html()),{style:{className:"addedGeoJsonLayer"}});overlays.textareaGeoJson=a,a.addTo(map),r.remove()}isset(lastBaseLayer)&&lastBaseLayer.addTo(map),obj.addClass("easySDImap"),_easySDImap.obj=obj,_easySDImap.addLayer=addLayer,_easySDImap.getContext=getContext,_easySDImap.setContext=setContext,_easySDImap.layers={baseLayers:baseLayers,overlays:overlays},_easySDImap.services=services,isset(url_obj.parameters.bbox)&&(console.info("use url bbox "+url_obj.parameters.bbox),_easySDImap.setBBox(url_obj.parameters.bbox)),setTimeout(updateMapFromContext,200)},updateMapFromContext=function(){isset(_easySDImap.params.context)&&("object"!=typeof _easySDImap.params.context&&eval("_easySDImap.params.context="+_easySDImap.params.context+";"),setContext(_easySDImap.params.context)),isset(url_obj.parameters.bbox)&&(console.info("use url bbox "+url_obj.parameters.bbox),_easySDImap.setBBox(url_obj.parameters.bbox))};_easySDImap.setBBox=function(e){var t=L.latLngBounds(LatLngFromString(e,mapOptions.crs));map.fitBounds(t)};var hasTool=function(e){var t=!1;return jQuery.each(_easySDImap.contextMapData.tools,function(n,r){r.alias==e&&(t=r)}),t};_easySDImap.getTool=function(e){var t=!1;return jQuery.each(_easySDImap.tools,function(n,r){r.alias==e&&(t=r.control)}),t};var addTool=function(e,t){switch(e){case"googleearth":return!1;case"navigation":return initNavigation(t);case"zoom":return initZoom(t);case"navigationhistory":return!1;case"zoomtoextent":return!1;case"measure":return initMeasure(t);case"googlegeocoder":return initGeocoder("google",t);case"print":return initPrint(t);case"addlayer":return!1;case"removelayer":return!1;case"layerproperties":return!1;case"getfeatureinfo":return!1;case"layertree":return initLayertree(t);case"scaleline":return!1;case"mouseposition":return!1;case"wfslocator":return!1;case"searchcatalog":return!1;case"layerdetailsheet":return!1;case"layerdownload":return!1;case"layerorder":return!1;case"attribution":return initAttribution(t);default:console.info("ERROR Tool "+e+" non géré")}},setCRS=function(e){return"EPSG:3857"==e?L.CRS.EPSG3857:"EPSG:4326"==e?L.CRS.EPSG4326:"EPSG:3395"==e?L.CRS.EPSG3395:null},getOloptions=function(e){if(!isset(e)||""==e)return[];var t=JSON.parse(e);return t},_ImportOL={};_ImportOL.Bounds=function(e,t,n,r){var a=LatLngFromString(e+","+t+","+n+","+r,mapOptions.crs.crs);return L.latLngBounds(a)};var getLayersStatus=function(){var e={baseLayers:[],overlays:[]};return jQuery.each(baseLayers,function(t,n){e.baseLayers.push({layer:t,status:isset(n._map)})}),jQuery.each(overlays,function(t,n){e.overlays.push({layer:t,status:isset(n._map)})}),e},getContext=function(){var e=map.getBounds().toBBoxString();return{bbox:e,layers:getLayersStatus()}},setContext=function(e){var t=e.bbox.split(",");t=[[t[1],t[0]],[t[3],t[2]]],map.fitBounds(t),jQuery.each(e.layers.baseLayers,function(e,t){isset(baseLayers[t])&&(t.status?map.addLayer(baseLayers[t.layer]):map.removeLayer(baseLayers[t.layer]))}),jQuery.each(e.layers.overlays,function(e,t){isset(overlays[t.layer])&&(t.status?map.addLayer(overlays[t.layer]):map.removeLayer(overlays[t.layer]))})},addLayer=function(e,t,n,r){serviceConnector.addService(e);var a=null;switch(e.serviceconnector){case"WMS":a=addWMS(e);break;case"WMTS":a=addWMTS(e);break;case"OSM":a=addOSM(e);break;case"Google":a=addGoogle(e);break;case"Bing":a=addBing(e);break;default:return console.error("ERROR "+e.serviceconnector+" non géré"),!1}return null!==a&&a!==!1&&(a.data=e,t===!1?(isset(r)&&setBaseLayerGroup(r),addBaseLayer(a,e.name)):addOverlay(a,r,e.name),n&&isset(a.addTo)&&a.addTo(map)),a},setBaseLayerGroup=function(e){baseLayerGroup=e,isset(controlLayer.setBaseGroupName)&&controlLayer.setBaseGroupName(baseLayerGroup)},addBaseLayer=function(e,t){isset(e.setZIndex)&&e.setZIndex(1),baseLayers[t]=e,isset(controlLayer)&&controlLayer.addBaseLayer(e,t),lastBaseLayer=e},addOverlay=function(e,t,n){overlays[n]=e,isset(controlLayer)&&controlLayer.addOverlay(e,n,t)},changeIGNkey=function(e,t){return isset(t)&&(e=e.replace(/\.ign\.fr\/[\w]*\/geoportail\//gi,".ign.fr/"+t+"/geoportail/")),e},addWMS=function(e){var t=e.serviceurl;t=changeIGNkey(t,params.ignkey);var n={};addIfSet(n,"layers",e.layername),n.format="image/png",addIfSet(n,"opacity",parseFloat(e.opacity)),n.zIndex=10,addIfSet(n,"zIndex",parseInt(e.ordering)+10),addIfSet(n,"zIndex",e.zIndex),addIfSet(n,"format",e.format),addIfSet(n,"attribution",e.attribution),addIfSet(n,"style",e.style),addIfSet(n,"bounds",e.bounds),addIfSet(n,"maxZoom",e.maxZoom);var r=getOloptions(e.asOLoptions);return addIfSet(n,"format",r.format),addIfSet(n,"attribution",r.attribution),addIfSet(n,"style",r.style),addIfSet(n,"bounds",r.bounds),r.maxZoom=24,isset(r.numZoomLevels)&&(r.maxZoom=parseInt(r.numZoomLevels)-1),addIfSet(n,"maxZoom",r.maxZoom),n.transparent=!0,e.TileLayer_options=n,new L.tileLayer.wms(t,n)},addWMTS=function(e){var t=e.serviceurl;t=changeIGNkey(t,params.ignkey);var n={};addIfSet(n,"layer",e.layername),addIfSet(n,"tilematrixSet",e.asOLmatrixset),addIfSet(n,"opacity",parseFloat(e.opacity)),n.zIndex=10,addIfSet(n,"zIndex",parseInt(e.ordering)+10);var r=getOloptions(e.asOLoptions);return n.format="image/png",addIfSet(n,"format",r.format),addIfSet(n,"attribution",r.attribution),addIfSet(n,"style",r.style),addIfSet(n,"bounds",r.bounds),isset(r.numZoomLevels)&&(r.maxZoom=parseInt(r.numZoomLevels)-1),addIfSet(n,"maxZoom",r.maxZoom),isset(r.maxResolution)&&(r.minZoom=parseInt(r.maxResolution),r.minZoom=r.maxZoom-Math.floor(Math.log(r.minZoom)/Math.log(2))+1),addIfSet(n,"minZoom",r.minZoom),addIfSet(n,"matrixIds",r.matrixIds),isset(r.matrixIds)&&(n.topLeftCorner=new L.LatLng(20037508,-20037508)),isset(n.topLeftCorner)&&jQuery.each(n.matrixIds,function(e,t){n.matrixIds[e]={identifier:t,topLeftCorner:n.topLeftCorner}}),addIfSet(n,"format",e.format),addIfSet(n,"attribution",e.attribution),addIfSet(n,"style",e.style),addIfSet(n,"bounds",e.bounds),addIfSet(n,"maxZoom",e.maxZoom),e.TileLayer_options=n,new L.TileLayer.WMTS(t,n)},addOSM=function(e){return L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'})},addGoogle=function(e){return"undefined"!=typeof google?new L.Google(e.layername):!1},addBing=function(e){return!1},initNavigation=function(e){var t={position:"topleft",zoomInTitle:i18n.t("tools_tooltips.zoomInTitle"),zoomOutTitle:i18n.t("tools_tooltips.zoomOutTitle")};jQuery.extend(t,e),map.dragging.enable(),map.touchZoom.enable(),map.doubleClickZoom.enable(),map.scrollWheelZoom.enable(),map.boxZoom.enable(),map.keyboard.enable();var n=L.control.zoom(t);return n.addTo(map),n},initZoom=function(e){var t={position:"topleft",title:i18n.t("tools_tooltips.zoomBoxTitle")};jQuery.extend(t,e);var n=L.control.zoomBox(t);return n.addTo(map),n},initMeasure=function(e){var t={position:"topright",activeColor:"#D9534F",completedColor:"#5BC0DE"};jQuery.extend(t,i18n.t("measure",{returnObjectTrees:!0})),jQuery.extend(t,e);var n=L.control.measure(t);return n.addTo(map),n},initAttribution=function(e){var t={position:"bottomright",prefix:!1};jQuery.extend(t,e);var n=L.control.attribution(t);return n.addTo(map),n},initGeocoder=function(e,t){var n={position:"topleft",language:lang,bounds:boundsLatLng.toBBoxString()};jQuery.extend(n,i18n.t("geocoder",{returnObjectTrees:!0})),jQuery.extend(n,t),"google"==e&&(n.geocoder=new L.Control.Geocoder.Google({language:n.language,bounds:n.bounds}));var r=L.Control.geocoder(n);return r.markGeocode=function(e){var t=e.bbox;map.fitBounds(t),map._geocodeMarker=new L.Marker(e.center).bindPopup(e.html||e.name).addTo(map).openPopup(),setTimeout(function(){map.removeLayer(map._geocodeMarker)},3e3)},r.addTo(map),r},initPrint=function(e){var t=new Date,n={position:"topright",copyright:"© "+_easySDImap.contextMapData.sitename+" "+t.getFullYear(),defaulttitle:_easySDImap.contextMapData.title,defaultdesc:_easySDImap.contextMapData["abstract"]};jQuery.extend(n,i18n.t("print",{returnObjectTrees:!0})),jQuery.extend(n,e);var r=L.easyPrintControl(n);return r.addTo(map),r},initLayertree=function(e){function t(e){return $("<div/>").text(e).html()}var n={},r={position:"topleft",title:_easySDImap.contextMapData.name,baseGroupName:baseLayerGroup,addlayer:hasTool("addlayer"),removelayer:hasTool("removelayer"),layerproperties:hasTool("layerproperties"),getfeatureinfo:hasTool("getfeatureinfo"),searchcatalog:hasTool("searchcatalog"),layerdetailsheet:hasTool("layerdetailsheet"),layerdownload:hasTool("layerdownload"),layerorder:hasTool("layerorder"),defaultGroup:_easySDImap.contextMapData.default_group,sharelink:1==_easySDImap.params.sharelink};jQuery.extend(r,i18n.t("layertree",{returnObjectTrees:!0})),jQuery.extend(r,e);var a=jQuery('<div id="sidebar" class="sidebar collapsed"><ul class="sidebar-tabs sidebar-tabs-top" role="tablist"></ul><ul class="sidebar-tabs sidebar-tabs-bottom" role="tablist"></ul><div class="sidebar-content active"></div></div>').prependTo("#easySDIMap");if(jQuery('<li><a href="#tree" role="tab" title="'+i18n.t("tools_tooltips.layertree")+'"><i class="fa fa-bars"></i></a></li>').appendTo(a.find(".sidebar-tabs-top")),n.panelTree=jQuery('<div class="sidebar-pane" id="tree"></div>').appendTo(a.find(".sidebar-content")),n.easyLayer=easyLayer(map,r),controlLayer=n.easyLayer,controlLayer.addTo(n.panelTree),pushTool("panelTree",n.panelTree),jQuery('<li><a href="#legend" role="tab" title="'+i18n.t("tools_tooltips.legend")+'"><i class="fa fa-newspaper-o"></i></a></li>').appendTo(a.find(".sidebar-tabs-top")),n.panelLegend=jQuery('<div class="sidebar-pane" id="legend"></div>').appendTo(a.find(".sidebar-content")),n.easyLegend=easyLegend(map,controlLayer,serviceConnector,r),controlLegend=n.easyLegend,controlLegend.addTo(n.panelLegend),r.addLayer!==!1&&(n.easyAddLayer=easyAddLayer(_easySDImap,controlLayer,serviceConnector,r),a.on("click",".addLayerBtn",function(e){e.preventDefault();var t=jQuery('<div class="addlayer_container"></div>');jQuery(this).after(t).hide(),n.easyAddLayer.show(t)}),pushTool("addlayer",n.easyAddLayer)),r.getfeatureinfo!==!1&&(jQuery('<li><a href="#getfeature" role="tab" title="'+i18n.t("tools_tooltips.getfeatureinfo")+'"><i class="fa fa-map-marker"></i></a></li>').appendTo(a.find(".sidebar-tabs-top")),n.panelFeature=jQuery('<div class="sidebar-pane" id="getfeature"></div>').appendTo(a.find(".sidebar-content")),n.easyGetFeature=easyGetFeature(map,controlLayer,serviceConnector,r),controlGetFeature=n.easyGetFeature,controlGetFeature.addTo(n.panelFeature),map.on("click",function(e){}),pushTool("getfeatureinfo",controlGetFeature)),r.sharelink){var o=function(){if(!_easySDImap.getContext)return setTimeout(o,250),!1;var e=location.protocol+"//"+location.host,n=_easySDImap.params.url;0!=n.search("http://")&&0!=n.search("https://")&&0!=n.search("//")&&(n=e+n);var r=_easySDImap.getContext();code="",code+="<!-- ---------------------------------- -->\r\n",code+="<!-- CODE A AJOUTER DANS LE BLOC <head> -->\r\n",code+="<!-- ---------------------------------- -->\r\n",code+='<link rel="stylesheet" href="'+e+'/bdt32/administrator/components/com_easysdi_core/libraries/leaflet/libs/leaflet/leaflet.css" type="text/css"/>\r\n',code+='<link rel="stylesheet" href="'+e+'/bdt32/administrator/components/com_easysdi_core/libraries/leaflet/libs/easySDI_leaflet.pack/main.css" type="text/css"/>\r\n',code+="\r\n",code+="\r\n",code+="<!-- -------------------------------------------------- -->\r\n",code+="<!-- CODE A AJOUTER OU VOUS SOUHAITEZ AFFICHER LA CARTE -->\r\n",code+="<!-- -------------------------------------------------- -->\r\n",code+='<div id="easySDIMap" class="easySDImapPrintBlock">\r\n',code+='   <div id="map" class="easySDI-leaflet sidebar-map" data-url="'+n+'"',code+=" data-context='"+JSON.stringify(r)+"'",isset(_easySDImap.params.ignkey)&&(code+=' data-ignkey="VOTRE_CLEF_IGN"'),code+="></div>\r\n",code+="</div>\r\n",code+="\r\n",code+="<script> window.jQuery ||  document.write('<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js\"><\\/script>');</script>\r\n",code+="<script> window.L ||  document.write('<script src=\"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.5/leaflet.js\"><\\/script>');</script>\r\n",code+='<script src="'+e+'/bdt32/administrator/components/com_easysdi_core/libraries/leaflet/libs/easySDI_leaflet.pack/easySDI_leaflet.pack.js" type="text/javascript"></script>\r\n',(-1!=jQuery.inArray("Google",r.layers.baseLayer)||-1!=jQuery.inArray("Google",r.layers.overlays))&&(code+='<script src="https://maps.google.com/maps/api/js?v=3&sensor=false" type="text/javascript"></script>\r\n'),code+="",html="<h4>Vous pouvez intégrer cette carte à votre site en utilisant le code suivant:</h4>",html+='<pre class="sharelink">'+t(code)+"</pre>",jQuery("#sharelink").html(html)};jQuery('<li><a href="#sharelink" role="tab" title="'+i18n.t("tools_tooltips.sharelink")+'"><i class="fa fa-share-alt"></i></a></li>').appendTo(a.find(".sidebar-tabs-top")),n.panelSharelink=jQuery('<div class="sidebar-pane" id="sharelink"><pre></pre></div>').appendTo(a.find(".sidebar-content")),o(),map.on("moveend",function(e){o()}),map.on("layeradd",function(e){o()}),map.on("layerremove",function(e){o()})}return n.sidebar=L.control.sidebar("sidebar",r),n.sidebar.addTo(map),n};if(void 0===data){var textarea=obj.find("textarea");contextMapData=jQuery.parseJSON(textarea.val()),textarea.remove()}else contextMapData=data;lang=contextMapData.lang;var i18nPath="";return jQuery('script[src$="easySDI_leaflet.pack.js"]').length&&(i18nPath=jQuery('script[src$="easySDI_leaflet.pack.js"]').attr("src").replace("libs/easySDI_leaflet.pack/easySDI_leaflet.pack.js","locales")),jQuery('script[src$="easysdi_leaflet.js"]').length&&(i18nPath=jQuery('script[src$="easysdi_leaflet.js"]').attr("src").replace("libs/easysdi_leaflet/easysdi_leaflet.js","locales")),i18n.init({resGetPath:i18nPath+"/"+lang+"/translation.json",lng:lang},function(e){init()}),obj.data("_easySDImap",_easySDImap),_easySDImap},jQuery("div.easySDI-leaflet[data-url]").each(function(){var obj=jQuery(this);jQuery.getJSON(obj.data("url"),{},function(data){var n=easySDImap(obj,data.data,obj.data());if(void 0!==obj.data("callback")){var c=obj.data("callback");if(jQuery.isFunction(c))c(n);else try{ce=eval(c),ce(n)}catch(e){console.error("invalid callback "+c+" "+e)}}}).fail(function(e,t,n){"abort"!==t&&(console.log("error "+t),console.log("incoming Text "+e.responseText))})}),jQuery.fn.extend({easySDImap:function(e,t){var n=[];return this.each(function(){if(void 0!==e){var r=easySDImap(jQuery(this),e);return jQuery.isFunction(t)&&t(r),r}n.push(jQuery(this).data("_easySDImap"))}),1==n.length?n[0]:n}})});