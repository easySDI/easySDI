Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.LayerTree=Ext.extend(gxp.plugins.LayerTree,{ptype:"sdi_gxp_layertree",createOutputConfig:function(){var b=new Ext.tree.TreeNode({text:this.rootNodeText,expanded:true,checked:false,isTarget:false,allowDrop:false,iconCls:"sdi-gxp-tree-node-root",listeners:{checkchange:function(h,g){h.eachChild(function(i){i.getUI().toggleCheck(g)})}}});var a=this.defaultGroup,c=this,d,f;for(var e in this.groups){d=typeof this.groups[e]=="string"?{title:this.groups[e]}:this.groups[e];f=d.exclusive;b.appendChild(new GeoExt.tree.LayerContainer(Ext.apply({text:d.title,iconCls:"gxp-folder",expanded:true,checked:false,group:e==this.defaultGroup?undefined:e,loader:new GeoExt.tree.LayerLoader({baseAttrs:f?{checkedGroup:Ext.isString(f)?f:e}:undefined,store:this.target.mapPanel.layers,filter:(function(g){return function(h){return(h.get("group")||a)==g&&h.getLayer().displayInLayerSwitcher==true}})(e),createNode:function(g){c.configureLayerNode(this,g);return GeoExt.tree.LayerLoader.prototype.createNode.apply(this,arguments)}}),singleClickExpand:true,allowDrag:false,listeners:{append:function(g,h){h.expand()},checkchange:function(h,g){h.eachChild(function(i){i.getUI().toggleCheck(g)})}}},d)))}return{xtype:"treepanel",root:b,rootVisible:true,shortTitle:this.shortTitle,autoScroll:true,border:false,enableDD:true,selModel:new Ext.tree.DefaultSelectionModel({listeners:{beforeselect:this.handleBeforeSelect,scope:this}}),listeners:{contextmenu:this.handleTreeContextMenu,beforemovenode:this.handleBeforeMoveNode,scope:this},contextMenu:new Ext.menu.Menu({items:[]})}},configureLayerNode:function(b,a){a.uiProvider=this.treeNodeUI;var e=a.layer;var d=a.layerStore;if(e&&d){var c=d.getAt(d.findBy(function(f){return f.getLayer()===e}));if(c){a.qtip=c.get("abstract");if(!c.get("queryable")){a.iconCls="gxp-tree-rasterlayer-icon"}if(c.get("fixed")){a.allowDrag=false}if(c.json){if(c.json.metadataURL){a.href=c.json.metadataURL;a.hrefTarget="_blank";a.cls="sdiMDlink"}}if(c.data){if(c.data.metadataURL){a.href=c.data.metadataURL;a.hrefTarget="_blank";a.cls="sdiMDlink"}}if(e.metadataURL){a.href=e.metadataURL;a.hrefTarget="_blank";a.cls="sdiMDlink"}a.listeners={rendernode:function(f){if(c===this.target.selectedLayer){f.select()}this.target.on("layerselectionchange",function(g){if(!this.selectionChanging&&g===c){f.select()}},this)},scope:this}}}},});Ext.preg(sdi.gxp.plugins.LayerTree.prototype.ptype,sdi.gxp.plugins.LayerTree);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.Print=Ext.extend(gxp.plugins.Print,{ptype:"sdi_gxp_print",constructor:function(a){sdi.gxp.plugins.Print.superclass.constructor.apply(this,arguments)},addActions:function(){if(this.printService!==null||this.printCapabilities!=null){var l=new sdi.geoext.data.PrintProvider({capabilities:this.printCapabilities,url:this.printService,printurl:this.printURL,createurl:this.createURL,customParams:this.customParams,autoLoad:false,listeners:{beforedownload:function(n,m){if(this.openInNewWindow===true){window.open(m);return false}},beforeencodelegend:function(q,p,o){if(o&&o.ptype==="gxp_layermanager"){var n=[];var m=o.output;if(m&&m[0]){m[0].getRootNode().cascade(function(s){if(s.component&&!s.component.hidden){var r=s.component;var t=this.encoders.legends[r.getXType()];n=n.concat(t.call(this,r,p.pages[0].scale))}},q)}p.legends=n;return false}},beforeprint:function(){j.items.get(0).printMapPanel.layers.each(function(m){var o=m.get("layer").params;for(var n in o){if(o[n] instanceof Array){o[n]=o[n].join(",")}}})},loadcapabilities:function(){if(g){g.initialConfig.disabled=false;g.enable()}},print:function(){try{j.close()}catch(m){}},printException:function(n,m){this.target.displayXHRTrouble&&this.target.displayXHRTrouble(m)},scope:this}});var c=gxp.plugins.Print.superclass.addActions.call(this,[{menuText:this.menuText,buttonText:this.buttonText,tooltip:this.tooltip,iconCls:"gxp-icon-print",disabled:this.printCapabilities!==null?false:true,handler:function(){var m=f();if(m.length>0){if(d()||i()){var o="";if(d()){o=o+this.googleLayerCanNotBePrinted}if(i()){o=o+this.bingLayerCanNotBePrinted}Ext.Msg.alert(this.someLayersNotPrintableText,o,function(){var p=k.call(this);h.call(this);return p},this)}else{var n=k.call(this);h.call(this);return n}}else{if(d()||i()){var o="";if(d()){o=o+this.googleLayerCanNotBePrinted}if(i()){o=o+this.bingLayerCanNotBePrinted}Ext.Msg.alert(this.notAllNotPrintableText,o)}else{Ext.Msg.alert(this.notAllNotPrintableText,this.nonePrintableText)}}},scope:this,listeners:{render:function(){l.loadCapabilities()}}}]);var g=c[0].items[0];var j;function a(){if(j){try{var m=j.items.first();m.printMapPanel.printPage.destroy()}catch(n){}j=null}}var b=this.target.mapPanel;function f(){var m=[];b.layers.each(function(n){var o=n.getLayer();if(e(o)){m.push(o)}});return m}function d(){var m=false;b.layers.each(function(n){var o=n.getLayer();if(o.getVisibility()===true&&o instanceof OpenLayers.Layer.Google){m=true}});return m}function i(){var m=false;b.layers.each(function(n){var o=n.getLayer();if(o.getVisibility()===true&&o instanceof OpenLayers.Layer.Bing){m=true}});return m}function e(m){return m.getVisibility()===true&&(m instanceof OpenLayers.Layer.WMS||m instanceof OpenLayers.Layer.OSM||m instanceof OpenLayers.Layer.WMTS)}function k(){var o=null;if(this.includeLegend===true){var n,m;for(n in this.target.tools){m=this.target.tools[n];if(m.ptype==="gxp_legend"){o=m.getLegendPanel();break}}if(o===null){for(n in this.target.tools){m=this.target.tools[n];if(m.ptype==="gxp_layermanager"){o=m;break}}}}j=new Ext.Window({title:this.previewText,modal:true,border:false,autoHeight:true,resizable:false,width:360,items:[new sdi.geoext.ux.PrintPreview({minWidth:336,mapTitle:this.target.about&&this.target.about.title,comment:this.target.about&&this.target.about["abstract"],printMapPanel:{autoWidth:true,height:Math.min(420,Ext.get(document.body).getHeight()-150),limitScales:true,map:Ext.applyIf({controls:[new OpenLayers.Control.Navigation({zoomWheelEnabled:false,zoomBoxEnabled:false}),new OpenLayers.Control.PanPanel(),new OpenLayers.Control.ZoomPanel(),new OpenLayers.Control.Attribution()],eventListeners:{preaddlayer:function(p){return e(p.layer)}}},b.initialConfig.map),items:[{xtype:"gx_zoomslider",vertical:true,height:100,aggressive:true}],listeners:{afterlayout:function(p){j.setWidth(Math.max(360,this.getWidth()+24));j.center()}}},printProvider:l,includeLegend:this.includeLegend,legend:o,sourceMap:b})],listeners:{beforedestroy:a}});return j}function h(){j.show();j.setWidth(0);var n=j.items.get(0).items.get(0);var m=0;n.items.each(function(o){if(o.getEl()){m+=o.getWidth()}});j.setWidth(Math.max(j.items.get(0).printMapPanel.getWidth(),m+20));j.center()}return c}}});Ext.preg(sdi.gxp.plugins.Print.prototype.ptype,sdi.gxp.plugins.Print);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.LayerManager=Ext.extend(sdi.gxp.plugins.LayerTree,{ptype:"sdi_gxp_layermanager",baseNodeText:"Base Maps",createOutputConfig:function(){var a=sdi.gxp.plugins.LayerManager.superclass.createOutputConfig.apply(this,arguments);Ext.applyIf(a,Ext.apply({cls:"gxp-layermanager-tree",lines:false,useArrows:true,plugins:[{ptype:"gx_treenodecomponent"}]},this.treeConfig));return a},configureLayerNode:function(b,a){sdi.gxp.plugins.LayerManager.superclass.configureLayerNode.apply(this,arguments);var c;if(OpenLayers.Layer.WMS&&a.layer instanceof OpenLayers.Layer.WMS){c="gx_wmslegend"}else{if(OpenLayers.Layer.Vector&&a.layer instanceof OpenLayers.Layer.Vector){c="gx_vectorlegend"}}if(c){Ext.apply(a,{component:{xtype:c,baseParams:{transparent:true,format:"image/png",legend_options:"fontAntiAliasing:true;fontSize:11;fontName:Arial"},layerRecord:this.target.mapPanel.layers.getByLayer(a.layer),showTitle:false,cls:"legend"}})}}});Ext.preg(sdi.gxp.plugins.LayerManager.prototype.ptype,sdi.gxp.plugins.LayerManager);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.BingSource=Ext.extend(gxp.plugins.BingSource,{ptype:"sdi_gxp_bingsource",createLayerRecord:function(b){var a=sdi.gxp.plugins.BingSource.superclass.createLayerRecord.apply(this,arguments);a.set("metadataURL",b.metadataURL);a.commit();return a}});Ext.preg(sdi.gxp.plugins.BingSource.prototype.ptype,sdi.gxp.plugins.BingSource);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.GoogleSource=Ext.extend(gxp.plugins.GoogleSource,{ptype:"sdi_gxp_googlesource",createLayerRecord:function(b){var a=sdi.gxp.plugins.GoogleSource.superclass.createLayerRecord.apply(this,arguments);a.set("metadataURL",b.metadataURL);a.commit();return a}});Ext.preg(sdi.gxp.plugins.GoogleSource.prototype.ptype,sdi.gxp.plugins.GoogleSource);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.OSMSource=Ext.extend(gxp.plugins.OSMSource,{ptype:"sdi_gxp_osmsource",createLayerRecord:function(b){var a=sdi.gxp.plugins.OSMSource.superclass.createLayerRecord.apply(this,arguments);a.set("metadataURL",b.metadataURL);a.commit();return a}});Ext.preg(sdi.gxp.plugins.OSMSource.prototype.ptype,sdi.gxp.plugins.OSMSource);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.LoadingIndicator=Ext.extend(gxp.plugins.LoadingIndicator,{ptype:"sdi_gxp_loadingindicator",init:function(a){a.map.events.register("preaddlayer",this,function(c){var b=c.layer;if(b instanceof OpenLayers.Layer.WMS||b instanceof OpenLayers.Layer.WMTS){b.events.on({loadstart:function(){this.layerCount++;if(!this.busyMask){this.busyMask=new Ext.LoadMask(a.map.div,{msg:this.loadingMapMessage})}this.busyMask.show();if(this.onlyShowOnFirstLoad===true){b.events.unregister("loadstart",this,arguments.callee)}},loadend:function(){this.layerCount--;if(this.layerCount===0){this.busyMask.hide()}if(this.onlyShowOnFirstLoad===true){b.events.unregister("loadend",this,arguments.callee)}},scope:this})}})}});Ext.preg(sdi.gxp.plugins.LoadingIndicator.prototype.ptype,sdi.gxp.plugins.LoadingIndicator);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.WMSSource=Ext.extend(gxp.plugins.WMSSource,{ptype:"sdi_gxp_wmssource",createLayerRecord:function(e){var g,d;var j=this.store.findExact("name",e.name);if(j>-1){d=this.store.getAt(j)}else{if(Ext.isObject(e.capability)){d=this.store.reader.readRecords({capability:{request:{getmap:{href:this.trimUrl(this.url,this.baseParams)}},layers:[e.capability]}}).records[0]}else{if(this.layerConfigComplete(e)){d=this.createLazyLayerRecord(e)}}}if(d){var i=d.getLayer().clone();var k=this.getMapProjection();var b=this.getProjection(d);var a=(b||k).getCode(),o=d.get("bbox"),n;if(o&&o[a]){i.addOptions({projection:b});n=OpenLayers.Bounds.fromArray(o[a].bbox,i.reverseAxisOrder())}else{var l=d.get("llbbox");if(l){var p=OpenLayers.Bounds.fromArray(l).transform("EPSG:4326",k);if((1/p.getHeight()>0)&&(1/p.getWidth()>0)){n=p}}}i.mergeNewParams({STYLES:e.styles,FORMAT:e.format,TRANSPARENT:e.transparent,CQL_FILTER:e.cql_filter});var c=false;if("tiled" in e){c=!e.tiled}else{if(d.data.dimensions&&d.data.dimensions.time){c=true}}i.setName(e.title||i.name);i.addOptions({attribution:e.attribution,maxExtent:n,restrictedExtent:n,singleTile:c,ratio:e.ratio||1,visibility:("visibility" in e)?e.visibility:true,opacity:("opacity" in e)?e.opacity:1,buffer:("buffer" in e)?e.buffer:1,dimensions:d.data.dimensions,transitionEffect:c?"resize":null,minScale:e.minscale,maxScale:e.maxscale});var f=Ext.applyIf({title:i.name,group:e.group,infoFormat:e.infoFormat,source:e.source,properties:"gxp_wmslayerpanel",fixed:e.fixed,selected:"selected" in e?e.selected:false,restUrl:this.restUrl,layer:i},d.data);var h=[{name:"source",type:"string"},{name:"group",type:"string"},{name:"properties",type:"string"},{name:"fixed",type:"boolean"},{name:"selected",type:"boolean"},{name:"restUrl",type:"string"},{name:"infoFormat",type:"string"}];d.fields.each(function(q){h.push(q)});var m=GeoExt.data.LayerRecord.create(h);g=new m(f,i.id);g.json=e}else{if(window.console&&this.store.getCount()>0&&e.name!==undefined){console.warn("Could not create layer record for layer '"+e.name+"'. Check if the layer is found in the WMS GetCapabilities response.")}}return g}});Ext.preg(sdi.gxp.plugins.WMSSource.prototype.ptype,sdi.gxp.plugins.WMSSource);Ext.namespace("gxp");gxp.ScaleOverlay.prototype.addScaleLine=function(){var a=new Ext.BoxComponent({autoEl:{tag:"div",cls:"olControlScaleLine overlay-element overlay-scaleline"}});this.on("afterlayout",function(){a.getEl().dom.style.position="relative";a.getEl().dom.style.display="inline";this.getEl().on("click",this.stopMouseEvents,this);this.getEl().on("mousedown",this.stopMouseEvents,this)},this);a.on("render",function(){var b=new OpenLayers.Control.ScaleLine({bottomInUnits:SdiScaleLineParams.bottomInUnits,bottomOutUnits:SdiScaleLineParams.bottomOutUnits,topInUnits:SdiScaleLineParams.topInUnits,topOutUnits:SdiScaleLineParams.topOutUnits,geodesic:true,div:a.getEl().dom});this.map.addControl(b);b.activate()},this);this.add(a)};Ext.namespace("gxp");var sourceConfig;var layerConfig;gxp.Viewer.prototype.addExtraLayer=function(c,b){sourceConfig=c;layerConfig=b;if(this.sources[sourceConfig.id]===undefined){this.sources[sourceConfig.id]=sourceConfig}this.initialConfig.map.layers.push(layerConfig);var a=[];a.push(this.createSourceLoader(sourceConfig.id));gxp.util.dispatch(a,this.reactivate,this)};gxp.Viewer.prototype.reactivate=function(){Ext.QuickTips.init();var i=this.initialConfig.map;if(i&&i.layers){var g,a,f,h=[],e=[];g=i.layers[i.layers.length-1];a=this.layerSources[g.source];if(a){if(a.id===sourceConfig.id){f=a.createLayerRecord(g);if(f){if(f.get("group")==="background"){h.push(f)}else{e.push(f)}}}}var b=this.mapPanel;var c=b.map;extent=f.getLayer().maxExtent.clone();c.zoomToExtent(extent);var d=h.concat(e);if(d.length){b.layers.add(d)}}this.checkLayerRecordQueue();this.fireEvent("ready")};Ext.namespace("sdi.geoext.data");sdi.geoext.data.PrintProvider=Ext.extend(GeoExt.data.PrintProvider,{loadCapabilities:function(){if(!this.url){return}var a=this.url+"info.json";Ext.Ajax.request({url:a,method:"GET",disableCaching:false,success:function(b){this.capabilities=Ext.decode(b.responseText);this.capabilities.createURL=this.createurl;this.capabilities.printURL=this.printurl;this.loadStores()},params:this.initialConfig.baseParams,scope:this})}});Ext.namespace("sdi.geoext.ux");sdi.geoext.ux.PrintPreview=Ext.extend(GeoExt.ux.PrintPreview,{initComponent:function(){var a={sourceMap:this.sourceMap,printProvider:this.printProvider};if(this.printMapPanel){if(!(this.printMapPanel instanceof GeoExt.PrintMapPanel)){a.xtype="gx_printmappanel";this.printMapPanel=new sdi.geoext.widgets.PrintMapPanel(Ext.applyIf(this.printMapPanel,a))}}else{this.printMapPanel=new sdi.geoext.widgets.PrintMapPanel(a)}this.sourceMap=this.printMapPanel.sourceMap;this.printProvider=this.printMapPanel.printProvider;this.form=this.createForm();if(!this.items){this.items=[]}this.items.push(this.createToolbar(),{xtype:"container",cls:"gx-printpreview",autoHeight:this.autoHeight,autoWidth:this.autoWidth,items:[this.form,this.printMapPanel]});GeoExt.ux.PrintPreview.superclass.initComponent.call(this);this.addMapOverlay&&this.printMapPanel.add(this.createMapOverlay());this.printMapPanel.on({resize:this.updateSize,scope:this});this.on({render:function(){if(!this.busyMask){this.busyMask=new Ext.LoadMask(this.getEl(),{msg:this.creatingPdfText})}this.printProvider.on({beforeprint:this.busyMask.show,print:this.busyMask.hide,printexception:this.busyMask.hide,scope:this.busyMask})},scope:this})}});Ext.namespace("sdi.geoext.widgets");sdi.geoext.widgets.PrintMapPanel=Ext.extend(GeoExt.PrintMapPanel,{initComponent:function(){if(this.sourceMap instanceof GeoExt.MapPanel){this.sourceMap=this.sourceMap.map}if(!this.map){this.map={}}Ext.applyIf(this.map,{projection:this.sourceMap.getProjection(),maxExtent:this.sourceMap.getMaxExtent(),maxResolution:this.sourceMap.getMaxResolution(),units:this.sourceMap.getUnits()});if(!(this.printProvider instanceof GeoExt.data.PrintProvider)){this.printProvider=new GeoExt.data.PrintProvider(this.printProvider)}this.printPage=new GeoExt.data.PrintPage({printProvider:this.printProvider});this.previewScales=new Ext.data.Store();this.previewScales.add(this.printProvider.scales.getRange());this.layers=[];var a;Ext.each(this.sourceMap.layers,function(e){if(e.getVisibility()===true){if(e instanceof OpenLayers.Layer.Vector){var g=e.features,j=new Array(g.length),c=new OpenLayers.Layer.Vector(e.name);for(var d=0,f=g.length;d<f;++d){j[d]=g[d].clone()}c.addFeatures(j,{silent:true});this.layers.push(c)}else{var b=e.clone();try{b.setVisibility(e.getVisibility())}catch(h){}this.layers.push(b)}}},this);this.extent=this.sourceMap.getExtent();GeoExt.PrintMapPanel.superclass.initComponent.call(this)}});Ext.namespace("sdi.plugins");sdi.plugins.SearchCatalog=Ext.extend(gxp.plugins.Tool,{ptype:"sdi_searchcatalog",addActionMenuText:"Search catalog",addActionTip:"Search catalog",addButtonText:"Search catalog",untitledText:"Untitled",doneText:"Done",constructor:function(a){gxp.plugins.AddLayers.superclass.constructor.apply(this,arguments)},addActions:function(){var a={tooltip:this.addActionTip,text:this.addActionText,menuText:this.addActionMenuText,disabled:true,iconCls:"gxp-icon-addlayersfromcatalog"};options=Ext.apply(a,{handler:this.showCatalogFrame,scope:this});var b=gxp.plugins.AddLayers.superclass.addActions.apply(this,[options]);this.target.on("ready",function(){b[0].enable()},this);return b},showCatalogFrame:function(){SqueezeBox.initialize({});SqueezeBox.resize({x:this.initialConfig.iwidth,y:this.initialConfig.iheight});SqueezeBox.setContent("iframe",this.initialConfig.url)}});Ext.preg(sdi.plugins.SearchCatalog.prototype.ptype,sdi.plugins.SearchCatalog);Ext.namespace("sdi.plugins");sdi.plugins.LayerDetailSheet=Ext.extend(gxp.plugins.Tool,{ptype:"sdi_layerdetailsheet",layerDetailMenuText:"Layer details sheet",layerDetailActionTip:"Layer details sheet",addActions:function(){var a;var b=sdi.plugins.LayerDetailSheet.superclass.addActions.apply(this,[{menuText:this.layerDetailMenuText,iconCls:"gxp-icon-getfeatureinfo",disabled:true,tooltip:this.layerDetailActionTip,handler:function(){var d=a;SqueezeBox.initialize({});SqueezeBox.resize({x:this.initialConfig.iwidth,y:this.initialConfig.iheight});SqueezeBox.setContent("iframe",d.json.href)},scope:this}]);var c=b[0];this.target.on("layerselectionchange",function(d){a=d;c.setDisabled(!d||!d.json||!d.json.href)},this);return b}});Ext.preg(sdi.plugins.LayerDetailSheet.prototype.ptype,sdi.plugins.LayerDetailSheet);Ext.namespace("sdi.plugins");sdi.plugins.LayerDownload=Ext.extend(gxp.plugins.Tool,{ptype:"sdi_layerdownload",layerDownloadMenuText:"Download",layerDownloadActionTip:"Download",addActions:function(){var a;var c=sdi.plugins.LayerDownload.superclass.addActions.apply(this,[{menuText:this.layerDownloadMenuText,iconCls:"gxp-icon-filebrowse",disabled:true,tooltip:this.layerDownloadActionTip,handler:function(){var d=a;SqueezeBox.initialize({});SqueezeBox.resize({x:this.initialConfig.iwidth,y:this.initialConfig.iheight});SqueezeBox.setContent("iframe",d.json.download)},scope:this}]);var b=c[0];this.target.on("layerselectionchange",function(d){a=d;b.setDisabled(!d||!d.json||!d.json.download)},this);return c}});Ext.preg(sdi.plugins.LayerDownload.prototype.ptype,sdi.plugins.LayerDownload);Ext.namespace("sdi.plugins");sdi.plugins.LayerOrder=Ext.extend(gxp.plugins.Tool,{ptype:"sdi_layerorder",layerOrderMenuText:"Order",layerOrderActionTip:"Order",addActions:function(){var a;var c=sdi.plugins.LayerDownload.superclass.addActions.apply(this,[{menuText:this.layerOrderMenuText,iconCls:"gxp-icon-addnote",disabled:true,tooltip:this.layerOrderActionTip,handler:function(){var d=a;SqueezeBox.initialize({});SqueezeBox.resize({x:this.initialConfig.iwidth,y:this.initialConfig.iheight});SqueezeBox.setContent("iframe",d.json.order)},scope:this}]);var b=c[0];this.target.on("layerselectionchange",function(d){a=d;b.setDisabled(!d||!d.json||!d.json.order)},this);return c}});Ext.preg(sdi.plugins.LayerOrder.prototype.ptype,sdi.plugins.LayerOrder);Ext.namespace("sdi.gxp.plugins");sdi.gxp.plugins.OLSource=Ext.extend(gxp.plugins.LayerSource,{ptype:"sdi_gxp_olsource",createLayerRecord:function(b){var f;var a=window;var c=b.type.split(".");for(var e=0,k=c.length;e<k;++e){a=a[c[e]];if(!a){break}}if(a&&a.prototype&&a.prototype.initialize){var h=function(){a.prototype.initialize.apply(this,b.args)};h.prototype=a.prototype;var g=new h();if("visibility" in b){g.visibility=b.visibility}var j=GeoExt.data.LayerRecord.create([{name:"name",type:"string"},{name:"source",type:"string"},{name:"group",type:"string"},{name:"fixed",type:"boolean"},{name:"selected",type:"boolean"},{name:"type",type:"string"},{name:"args"}]);var d={layer:g,title:g.name,name:b.name||g.name,source:b.source,group:b.group,fixed:("fixed" in b)?b.fixed:false,selected:("selected" in b)?b.selected:false,type:b.type,args:b.args,properties:("properties" in b)?b.properties:undefined};f=new j(d,g.id);f.json=b}else{throw new Error("Cannot construct OpenLayers layer from given type: "+b.type)}return f},getConfigForRecord:function(a){var b=sdi.gxp.plugins.OLSource.superclass.getConfigForRecord.apply(this,arguments);var c=a.getLayer();return Ext.apply(b,{type:a.get("type"),args:a.get("args")})}});Ext.preg(sdi.gxp.plugins.OLSource.prototype.ptype,sdi.gxp.plugins.OLSource);