<?xml version="1.0" ?>

<project default="plg_easysdi_monitor" basedir="../../../">
    
    <property name="monitor.plugin.name" value="plg_easysdi_monitor"/>
    <property name="plg.monitor.src.out.dir" value="${root.out.dir}/${monitor.plugin.name}/src"/>
    <property name="plg.monitor.package.out.dir" value="${root.out.dir}/${monitor.plugin.name}/target"/>
    <property name="joomla.monitor.plugin.path" value="content/easysdimonitor"/>
    
    <available file="${joomla.plugin.path}/${joomla.monitor.plugin.path}" type="dir" property="monitor.plg.exist"/>
    
    <target name="package" depends="write-xml, plg_zip" description="Main target"/>
    <target name="sync-package" depends="plg_copy, write-xml, plg_zip" description="Main target" if="${monitor.plg.exist}"/>
    <target name="sync" depends="plg_copy, write-xml" description="Main target" />
    
    <target name="plg_copy" >
        
        <echo>Copy plugin file for ${monitor.plugin.name}</echo>
       
        <copy todir="${plg.monitor.src.out.dir}" overwrite="true">
            <fileset dir="${joomla.plugin.path}/${joomla.monitor.plugin.path}" erroronmissingdir="false"/>
        </copy>
        <copy todir="${plg.monitor.src.out.dir}/language" overwrite="true">
            <fileset dir="${joomla.administrator.language.dir}" includes="**/*_${monitor.plugin.name}*" erroronmissingdir="false"/>
        </copy>
    </target>
    
    <target name="write-xml">
        <echoxml file="${plg.monitor.src.out.dir}/sdimonitor.xml">
            <extension version="3.0" type="plugin" group="content" method="upgrade">       
                <name>EasySDI Monitor Plugin</name>
                <creationDate>10 January 2011</creationDate>
                <releaseDate>${xml.releaseDate}</releaseDate>
                <author>asitvd.ch</author>
                <authorEmail></authorEmail>
                <authorUrl>http://www.asitvd.ch</authorUrl>
                <copyright>${xml.copyright}</copyright>
                <license>${xml.license}</license>
                <version>${version}</version>
                <description><![CDATA[OGC EasySDI Monitor Plugin, display service's status in an article<br />]]></description>
                <!-- Main File Copy Section -->
                <files>
                    <filename plugin="easysdimonitor">sdimonitor.php</filename>
                    <filename plugin="easysdimonitor">sdimonitor.xml</filename>
                </files>
                <params>
                    <!--
                    <param name="display_map_name" type="list" default="1" label="Display Map Name" description="Display Map Name above the map">
                            <option value="0">No</option>
                            <option value="1">Yes</option>
                    </param>
                    -->
                </params>
            </extension>
        </echoxml>
    </target>
    
    <target name="plg_zip">
        
        <echo>Zip plugin package</echo>
        <jar destfile="${plg.monitor.package.out.dir}/${monitor.plugin.name}.zip">
            <fileset dir="${plg.monitor.src.out.dir}"/>
        </jar>
    </target>
    
</project>