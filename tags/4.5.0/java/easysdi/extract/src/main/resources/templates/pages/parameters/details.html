<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout/master">
    <head>
        <title th:inline="text">
            [[#{application.name}]]&nbsp;&ndash; [[#{parameters.page.title}]]
        </title>
    </head>
    <body>
        <div id="wrapper">
            <div id="page-wrapper" layout:fragment="content">
                <form id="parametersForm" method="POST" action="#" th:object='${parameters}' class="form"
                      th:action="@{/parameters}">
                    <div class="alert alert-dismissible alert-danger" th:if="${#fields.hasErrors('*')}">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"
                                data-toggle="tooltip" th:attr="aria-label=#{message.close}" th:title="#{message.close}"
                                title="{Close}">
                            <span aria-hidden="true">&times;</span>
                        </button>
                        <h4 th:text="#{errors.panel.title}">{Error}</h4>
                        <ul>
                            <li th:each="error : ${#fields.errors('*')}" th:text="${error}"></li>
                        </ul>
                    </div>
                    <div>
                        <div class="pull-right">
                            <button id="parametersCancelButton" class="btn btn-extract-white" th:text="#{buttons.cancel}"
                                    type="button">
                                {Cancel}
                            </button>
                            <button id="parametersSaveButton" class="btn btn-extract-filled" th:text="#{buttons.save}"
                                    type="button">
                                {Save}
                            </button>
                        </div>
                        <h1 class="page-header" th:text="#{parameters.body.title}">{Configuration de l'application}</h1>
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <!-- Panel containing orchestration parameters -->
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <span th:text="#{parameters.panels.orchestration.title}">{Orchestration}</span>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('basePath')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.basepath.label}"
                                                       class="control-label">
                                                    {Chemin de stockage}
                                                </label>
                                                <span class="mandatory" th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="text" class="form-control" th:field="*{basePath}"
                                                       data-toggle="tooltip"
                                                       th:title="${#fields.hasErrors('basePath')} ? ${#fields.errors('basePath')[0]}"
                                                       value="{basePath}" maxlength="255" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('schedulerFrequency')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.orchestrationfrequency.label}"
                                                       class="control-label">
                                                    {Fréquence de mise Ã  jour de l'orchestrateur en secondes}
                                                </label>
                                                <span class="mandatory" data-toggle="tooltip"
                                                      th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="number" class="form-control" data-toggle="tooltip"
                                                       th:title="${#fields.hasErrors('schedulerFrequency')} ? ${#fields.errors('schedulerFrequency')[0]}"
                                                       th:field="*{schedulerFrequency}" value="3600" step="1" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('dashboardFrequency')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.dashboardfrequency.label}"
                                                       class="control-label">
                                                    {Dashboard update frequency}
                                                </label>
                                                <span class="mandatory" data-toggle="tooltip"
                                                      th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="number" class="form-control" data-toggle="tooltip"
                                                       th:title="${#fields.hasErrors('dashboardFrequency')}
                                                       ? ${#fields.errors('dashboardFrequency')[0]}"
                                                       th:field="*{dashboardFrequency}" value="20" step="1" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Panel containing smtp parameters -->
                        <div class="col-lg-6">
                            <div class="panel panel-default">
                                <div class="panel-heading">
                                    <span th:text="#{parameters.panels.serveursmtp.title}">{Serveur SMTP}</span>
                                </div>
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label">
                                                <div>
                                                    <label th:text="#{parameters.fields.mailEnabled.label}"
                                                           class="control-label">
                                                        {Enable e-mail notifications}
                                                    </label>
                                                </div>
                                                <div class="btn-group" data-toggle="buttons">
                                                    <label class="btn btn-xs btn-toggle btn-toggle-no"
                                                           th:classappend="*{mailEnabled} ? '' : 'active'">
                                                        <input type="radio" th:field="*{mailEnabled}" value="0" />
                                                        &nbsp;<span th:text="#{toggle.no}">{No}</span>
                                                    </label>
                                                    <label class="btn btn-xs btn-toggle btn-toggle-yes"
                                                           th:classappend="*{mailEnabled} ? 'active' : ''">
                                                        <input type="radio" th:field="*{mailEnabled}" value="1" />
                                                        &nbsp;<span th:text="#{toggle.yes}">{Yes}</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpServer')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.smtpserveur.label}"
                                                       class="control-label">
                                                    {Serveur SMTP}
                                                </label>
                                                <span class="mandatory" th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="text" class="form-control" th:field="*{smtpServer}"
                                                       th:title="${#fields.hasErrors('smtpServer')} ? ${#fields.errors('smtpServer')[0]}"
                                                       value="{smtpServer}" maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label">
                                                <div>
                                                    <label th:text="#{parameters.fields.smtpssl.label}"
                                                           class="control-label">{SSL}</label>
                                                </div>
                                                <div class="btn-group" data-toggle="buttons">
                                                    <label th:each="sslTypeItem : ${T(org.easysdi.extract.email.EmailSettings.SslType).values()}"
                                                           class="btn btn-xs btn-toggle btn-toggle-yes"
                                                           th:classappend="*{sslType} == ${sslTypeItem} ? 'active' : ''">
                                                        <input type="radio" th:field="*{sslType}"
                                                               th:value="${sslTypeItem}" />&nbsp;
                                                        <span th:text="${#messages.msg('sslType.' + sslTypeItem)}">
                                                            {None}
                                                        </span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpPort')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.smtpport.label}"
                                                       class="control-label">
                                                    {Port SMTP}
                                                </label>
                                                <span class="mandatory" data-toggle="tooltip"
                                                      th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="text" class="form-control" th:field="*{smtpPort}"
                                                       th:title="${#fields.hasErrors('smtpPort')} ? ${#fields.errors('smtpPort')[0]}"
                                                       value="{smtpPort}" maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpUser')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.smtpuser.label}"
                                                       class="control-label">
                                                    {Utilisateur SMTP}
                                                </label>
                                                <input type="text" class="form-control" th:field="*{smtpUser}"
                                                       th:title="${#fields.hasErrors('smtpUser')}
                                                       ? ${#fields.errors('smtpUser')[0]}" autocomplete="off"
                                                       th:value="*{smtpUser}" maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpPassword')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.smtppassword.label}"
                                                       class="control-label">
                                                    {Mot de passe SMTP}
                                                </label>
                                                <input type="password" id="smtpPassword" name="smtpPassword"
                                                       class="form-control" th:value="*{smtpPassword}"
                                                       th:title="${#fields.hasErrors('smtpPassword')}
                                                       ? ${#fields.errors('smtpPassword')[0]}" autocomplete="off"
                                                       maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpFromName')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.mailfromname.label}"
                                                       class="control-label">
                                                    {Nom de l'Ã©metteur}
                                                </label>
                                                <span class="mandatory" data-toggle="tooltip"
                                                      th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="text" class="form-control" th:field="*{smtpFromName}"
                                                       th:title="${#fields.hasErrors('smtpFromName')} ? ${#fields.errors('smtpFromName')[0]}"
                                                       value="{smtpFromName}" maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div class="form-group form-group-with-label"
                                                 th:classappend="${#fields.hasErrors('smtpFromMail')} ? 'has-error'">
                                                <label th:text="#{parameters.fields.mail.label}"
                                                       class="control-label">
                                                    {Email de l'Ã©metteur}
                                                </label>
                                                <span class="mandatory" data-toggle="tooltip"
                                                      th:title="#{field.mandatory.tooltip}"></span>
                                                <input type="text" class="form-control" th:field="*{smtpFromMail}"
                                                       th:title="${#fields.hasErrors('smtpFromMail')} ? ${#fields.errors('smtpFromMail')[0]}"
                                                       value="{smtpFromMail}" maxlength="255" data-toggle="tooltip" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </form>

            </div>
        </div>
        <th:block layout:fragment="customScripts">
            <script type="text/javascript" src="../../static/js/parameters.js" th:src="@{/js/parameters.js}"></script>
            <script type="text/javascript" th:inline="javascript">
                /*<![CDATA[*/
                $(function() {

                    $('#parametersCancelButton').on('click', function() {
                        location.replace("parameters");
                    });

                    $('#parametersSaveButton').on('click', submitParametersData);
                });
                /*]]>*/
            </script>
        </th:block>
    </body>
</html>