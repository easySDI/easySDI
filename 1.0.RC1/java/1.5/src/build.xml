<?xml version="1.0" ?>
<project default="createwar" basedir=".">
	
  <property name="projet.src.dir" value="src"/>
  <property name="projet.conf.dir" value="conf"/>
  <property name="projet.work.dir" value="work"/>
  <property name="projet.out.dir" value="out"/>
  <property name="projet.lib.dir" value="lib"/>
  <property name="projet.tomcat.lib.dir" value="C:\Program Files\Apache Software Foundation\Tomcat 5.5\common\lib"/>
  <property name="projet.gt2-2.4.1.lib.dir" value="D:\DEPTH\Projets\projets\eclipse\workspace\gt2-2.4.1\"/>
	
   <path id="projet.classpath">
	    <fileset dir="${projet.lib.dir}">
	      <include name="*.jar"/>
	    </fileset>
    	<fileset dir="${projet.tomcat.lib.dir}">
	      <include name="*.jar"/>
	    </fileset>   	   
   	<fileset dir="${projet.gt2-2.4.1.lib.dir}">
   	   	   		      <include name="*.jar"/>
   	   	   		    </fileset>
   	
   </path>
	
<target name="syncJar" depends="create-structure,copy-resources,compilation,compression,Sync-jar" description="Main target">
	    
  </target>

  <target name="createwar" depends="create-structure,copy-resources,compilation,compression,deleteResources,war" description="Main target">
    
  </target>

  <target name="create-structure">    
  	<echo>Creating the working directory structure</echo>
  	<mkdir dir="${projet.out.dir}" />
  	<mkdir dir="${projet.work.dir}" />
  	<mkdir dir="${projet.work.dir}/conf" />
  	<mkdir dir="${projet.work.dir}/WEB-INF" />
  	<mkdir dir="${projet.work.dir}/WEB-INF/classes" />
  	<mkdir dir="${projet.work.dir}/WEB-INF/lib" />
  </target>  
	
	<target name="compression" description="Compression" >
	    <jar jarfile="${projet.work.dir}/WEB-INF/lib/easysdi.jar" basedir="${projet.work.dir}/WEB-INF/classes"  />			
	</target>

	 <target name="Sync-jar">    
			<echo>Copy the resources into the working directory</echo>
	  		<copy todir="C:/Program Files/Apache Software Foundation/Tomcat 5.5/webapps/proxy/WEB-INF/lib" >
	  	      <fileset dir="${projet.work.dir}/WEB-INF/lib" >
	  	        <include name="easysdi.jar"/>
	  	        
	  	      </fileset>
	  	    </copy>
	  </target>
	
  <target name="copy-resources">    
		<echo>Copy the resources into the working directory</echo>
  		<copy todir="${projet.work.dir}/WEB-INF/lib" >
  	      <fileset dir="${projet.lib.dir}" >
  	        <include name="**/*.jar"/>
  	        <include name="**/*.zip"/>
  	      </fileset>
  	    </copy>
  	
  		<copy todir="${projet.work.dir}/WEB-INF/" >
  	  	      <fileset dir="${projet.conf.dir}" >
  	  	        <include name="web.xml"/>  	  	        
  	  	      </fileset>
  	  	</copy>
  		
  		<copy todir="${projet.work.dir}/conf/" >
  	  	  	      <fileset dir="${projet.conf.dir}" >
  	  	  	        <include name="config.xml"/>  	  	        
  	  	  	  		<include name="NewPolicy.xml"/>  	  	  	      	
  	  	  	      </fileset>
  	  	  	</copy>  	
  </target>
	
  <target name="compilation" description="Compilation" >  	
    <javac debug="on" srcdir="${projet.src.dir}" destdir="${projet.work.dir}/WEB-INF/classes" >
    	<classpath refid="projet.classpath"/>
    </javac>
  	
  </target>
  
	<target name="deleteResources" description="generate the war" >
		
	<delete includeEmptyDirs="true">			
					      <fileset dir="${projet.work.dir}/WEB-INF/classes" />
					</delete>
	</target>
	<target name="war" description="generate the war" >
		<tstamp/>
		<echo>Building the war file</echo>
			
	    <war warfile="${projet.out.dir}/proxy.${DSTAMP}.${TSTAMP}.war" basedir="${projet.work.dir}" />
	</target>
	
	
		
	
	
</project>